import{_ as o,r as p,o as i,c as l,e as a,w as u,d as s,a as n,b as e}from"./app-b63b8632.js";const r="/notes/assets/image-20231114152756160-ebe47335.png",d="/notes/assets/image-20231114152907992-371599ed.png",k="/notes/assets/block-graph-IRExamples-runBinarySearchIterativelyTryCatch-3-91213f227f0d525b2f4b2dd20d65799d-97255241.svg",v="/notes/assets/graph-IRExamples-runBinarySearchIterativelyTryCatch-3-b1b5ea61a4a8aad2ac98e69e4abd8d45-bff53448.svg",m={},h=e(`<p>https://jacodb.org/documentation/installation/</p><p>æœ‰äº›ä¾‹å­å·²ç»ä¸ç¬¦åˆæœ€æ–°ç‰ˆæœ¬ã€‚</p><h1 id="ä¸€-å®‰è£…" tabindex="-1"><a class="header-anchor" href="#ä¸€-å®‰è£…" aria-hidden="true">#</a> ä¸€ å®‰è£…</h1><p>â€‹ é¡¹ç›®ä¸­æ·»åŠ JacoDBã€‚</p><h2 id="gradle" tabindex="-1"><a class="header-anchor" href="#gradle" aria-hidden="true">#</a> Gradle</h2><p>â€‹ åœ¨build.gradle.ktsæ–‡ä»¶çš„dependenciesèŠ‚ç‚¹æ·»åŠ ä»¥ä¸‹å†…å®¹</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>implementation(group = &quot;org.jacodb&quot;, name = &quot;jacodb-api&quot;, version = jacodbVersion)
implementation(group = &quot;org.jacodb&quot;, name = &quot;jacodb-core&quot;, version = jacodbVersion)
implementation(group = &quot;org.jacodb&quot;, name = &quot;jacodb-analysis&quot;, version = jacodbVersion)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="maven" tabindex="-1"><a class="header-anchor" href="#maven" aria-hidden="true">#</a> Maven</h2><p>â€‹ åœ¨pom.xmlçš„dependenciesèŠ‚ç‚¹æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.jacodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jacodb-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.jacodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jacodb-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.jacodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jacodb-analysis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="äºŒ-åŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#äºŒ-åŸºæœ¬ä½¿ç”¨" aria-hidden="true">#</a> äºŒ åŸºæœ¬ä½¿ç”¨</h1><p>â€‹ JacoDB APIçš„ä¸¤ä¸ªçº§åˆ«ï¼š</p><p>â€‹ ğŸ¸ä¸€ä¸ªæ˜¯æä¾›ä»£è¡¨æ–‡ä»¶ç³»ç»Ÿçº§åˆ«çš„ä¿¡æ¯ï¼Œä¾‹å¦‚bytecodeå’Œclassesä¿¡æ¯ã€‚</p><p>â€‹ ğŸ¸å¦ä¸€ä¸ªæä¾›è¿è¡Œæ—¶ä¿¡æ¯ï¼Œä¾‹å¦‚typesã€‚</p><p>â€‹ bytecodeå’Œclassesä¿¡æ¯æ¥è‡ª.class æ–‡ä»¶ï¼šåŒ…å«æ–¹æ³•ã€å­—æ®µç­‰çš„ç±»ã€‚</p><p>â€‹ typesè¡¨ç¤ºå¯ä»¥æ˜¯å¯ç©ºçš„ã€å¸¦æœ‰å‚æ•°çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼š</p><p>â€‹ ç±»å›¾ï¼š</p><p><img src="`+r+'" alt="image-20231114152756160"></p><p>â€‹ ç±»å‹å›¾ï¼š</p><p><img src="'+d+`" alt="image-20231114152907992"></p><p>â€‹ è¿™ä¸¤ä¸ªå±‚æ¬¡éƒ½ä¸ JcClasspath ç›¸å…³è”ã€‚æ‚¨æ— æ³•ä¿®æ”¹ä»çº¯å­—èŠ‚ç ä¸­æ£€ç´¢çš„ç±»ã€‚typeså¯èƒ½é€šè¿‡æ³›å‹æ›¿æ¢æ‰‹åŠ¨æ„å»ºã€‚</p><p>â€‹ JcClasspath æ˜¯classeså’Œtypesçš„å…¥å£ã€‚</p><p>â€‹ JcClassOrInterface ä»£è¡¨ç€ä¸€ä¸ªç±»æ–‡ä»¶ã€‚æ•°ç»„æˆ–è€…åŸå§‹ç±»å‹æ²¡æœ‰JcClassOrInterfaceã€‚</p><p>â€‹ JcType ä»£è¡¨æ¥è‡ª JVM è¿è¡Œæ—¶çš„ç±»å‹ã€‚</p><p>â€‹ JcClassType#methodsåŒ…æ‹¬ï¼š</p><p>â€‹ å°è£…ç±»çš„public/protected/privateæ–¹æ³•ã€‚</p><p>â€‹ åœ¨ç¼–è¯‘æ—¶å¯è§çš„æ‰€æœ‰ç¥–å…ˆæ–¹æ³•ã€‚</p><p>â€‹ ä»…æ¥è‡ªå£°æ˜ç±»çš„æ„é€ æ–¹æ³•ã€‚</p><p>â€‹ JcClassType#fieldsåŒ…æ‹¬ï¼š</p><p>â€‹ å°è£…ç±»çš„public/protected/privateå­—æ®µã€‚</p><p>â€‹ åœ¨ç¼–è¯‘æ—¶å¯è§çš„æ‰€æœ‰ç¥–å…ˆå­—æ®µã€‚</p><h3 id="è·å–å·²å£°æ˜çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#è·å–å·²å£°æ˜çš„æ–¹æ³•" aria-hidden="true">#</a> è·å–å·²å£°æ˜çš„æ–¹æ³•</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MethodNode</span> <span class="token function">findNormalDistribution</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">File</span> commonsMath32 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;commons-math3-3.2.jar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> commonsMath36 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;commons-math3-3.6.1.jar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> buildDir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;my-project/build/classes/java/main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JcDatabase</span> database <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">useProcessJavaRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/compilation-db/&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// persist data</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Let&#39;s load these three bytecode locations</span>
        database<span class="token punctuation">.</span><span class="token function">asyncLoad</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>commonsMath32<span class="token punctuation">,</span> commonsMath36<span class="token punctuation">,</span> buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// This method just refreshes the libraries inside the database. If there are any changes in libs then </span>
        <span class="token comment">// the database updates data with the new results.</span>
        database<span class="token punctuation">.</span><span class="token function">asyncLoad</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Let&#39;s assume that we want to get bytecode info only for \`commons-math3\` version 3.2.</span>
        <span class="token class-name">JcClassOrInterface</span> jcClass <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>commonsMath32<span class="token punctuation">,</span> buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findClassOrNull</span><span class="token punctuation">(</span><span class="token string">&quot;org.apache.commons.math3.distribution.NormalDistribution&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jcClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jcClass<span class="token punctuation">.</span><span class="token function">getAnnotations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">JcClasses</span><span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span>jcClass<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// At this point the database read the method bytecode and return the result.</span>
        <span class="token keyword">return</span> jcClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asmNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å¦‚æœå¾…å¤„ç†çš„ JAR æ–‡ä»¶è¢«æ›´æ”¹æˆ–ç§»é™¤ï¼Œ<code>body</code> æ–¹æ³•å°†è¿”å› nullã€‚å¦‚æœç±»ç¯å¢ƒä¸å®Œæ•´ï¼ˆå³ï¼Œç±»è·¯å¾„ä¸­æ‰¾ä¸åˆ°æ–¹æ³•çš„è¶…ç±»ã€æ¥å£ã€è¿”å›ç±»å‹æˆ–å‚æ•°ï¼‰ï¼Œåˆ™ API åœ¨è¿è¡Œæ—¶ä¼šæŠ›å‡º <code>NoClassInClasspathException</code>ã€‚</p><h3 id="ç›‘å¬æ–‡ä»¶ç³»ç»Ÿæ›´æ–°" tabindex="-1"><a class="header-anchor" href="#ç›‘å¬æ–‡ä»¶ç³»ç»Ÿæ›´æ–°" aria-hidden="true">#</a> ç›‘å¬æ–‡ä»¶ç³»ç»Ÿæ›´æ–°</h3><p>â€‹ æ•°æ®åº“å¯ä»¥åœ¨åå°ç›‘è§†æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ï¼Œå¹¶æ˜¾å¼åˆ·æ–° JAR æ–‡ä»¶ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">watchFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
<span class="token class-name">JcDatabase</span> database <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">watchFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">useProcessJavaRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">loadByteCode</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>lib1<span class="token punctuation">,</span> buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// A user rebuilds the buildDir folder.</span>
    <span class="token comment">// The database re-reads the rebuilt directory in the background.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·å–typeä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#è·å–typeä¿¡æ¯" aria-hidden="true">#</a> è·å–typeä¿¡æ¯</h3><p>â€‹ typesåŒ…æ‹¬ï¼š</p><p>â€‹ åŸºæœ¬ç±»å‹ï¼Œ</p><p>â€‹ ç±»ï¼Œ</p><p>â€‹ æ•°ç»„ï¼Œ</p><p>â€‹ æœ‰ç•Œå’Œæ— ç•Œé€šé…ç¬¦</p><p>â€‹ typesçº§åˆ«è¡¨ç¤ºæ ¹æ®ç»™å®šæ³›å‹ç±»å‹ä¸­çš„å‚æ•°æ›¿ä»£æ‰€å‘ˆç°çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">A</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">T</span> x <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">typesSubstitution</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">JcClassType</span> b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JcClassType</span><span class="token punctuation">)</span>classpath<span class="token punctuation">.</span><span class="token function">findTypeOrNull</span><span class="token punctuation">(</span><span class="token string">&quot;org.jacodb.examples.JavaReadMeExamples.B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">JcType</span> xType <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>it <span class="token operator">-&gt;</span> <span class="token string">&quot;x&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFieldType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">JcClassType</span> stringType <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JcClassType</span><span class="token punctuation">)</span> classpath<span class="token punctuation">.</span><span class="token function">findTypeOrNull</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>xType<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>stringType<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will print &quot;true&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¤šçº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#å¤šçº¿ç¨‹" aria-hidden="true">#</a> å¤šçº¿ç¨‹</h3><p>â€‹ <code>JcClassOrInterface</code>ã€<code>JcMethod</code> å’Œ <code>JcClasspath</code> çš„å®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨ä¸”ä¸å¯å˜çš„ã€‚</p><p>â€‹ <code>JcClasspath</code> è¡¨ç¤ºç±»çš„ä¸€ä¸ªç‹¬ç«‹å¿«ç…§ï¼Œè‡ªåˆ›å»ºä»¥æ¥æ— æ³•ä¿®æ”¹ã€‚åˆ é™¤æˆ–ä¿®æ”¹åº“æ–‡ä»¶ä¸ä¼šå½±å“ <code>JcClasspath</code> å®ä¾‹çš„ç»“æ„ã€‚<code>JcClasspath#close</code> æ–¹æ³•é‡Šæ”¾æ‰€æœ‰å¿«ç…§å¹¶æ¸…ç†æŒä¹…åŒ–çš„æ•°æ®ï¼Œå¦‚æœæŸäº›åº“å·²è¿‡æ—¶ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">JcDatabase</span> database <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">watchFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">useProcessJavaRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">loadByteCode</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>lib1<span class="token punctuation">,</span> buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">JcClasspath</span> cp <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        database<span class="token punctuation">.</span><span class="token function">asyncRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// does not affect cp classes</span>

        <span class="token class-name">JcClasspath</span> cp1 <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will use new version of compiled results in buildDir</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å¦‚æœå¯¹ <code>JcClasspath</code> å®ä¾‹çš„è¯·æ±‚åŒ…å«å°šæœªç´¢å¼•çš„åº“ï¼Œåˆ™ä¼šè§¦å‘ç´¢å¼•è¿‡ç¨‹ï¼Œå¹¶è¿”å› <code>JcClasspath</code> é›†åˆçš„æ–°å®ä¾‹ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">autoProcessing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">JcDatabase</span> database <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">loadByteCode</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>lib1<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;...&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token class-name">JcClasspath</span> cp <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">singletonList</span><span class="token punctuation">(</span>buildDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// database will automatically process buildDir</span>
        
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ JacoDB æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœåœ¨å¦ä¸€ä¸ªçº¿ç¨‹åŠ è½½ JAR æ–‡ä»¶æ—¶è¯·æ±‚ <code>JcClasspath</code> å®ä¾‹ï¼Œ<code>JcClasspath</code> å¯ä»¥è¡¨ç¤ºæ­£åœ¨åŠ è½½çš„ JAR æ–‡ä»¶çš„ä¸€è‡´çŠ¶æ€ã€‚åœ¨ <code>JcClasspath</code> ä¸­æ˜¾ç¤ºçš„æ˜¯å®Œå…¨åŠ è½½çš„ JAR æ–‡ä»¶ã€‚è¯·æ³¨æ„ï¼šä¸èƒ½ä¿è¯æäº¤ç”¨äºåŠ è½½çš„æ‰€æœ‰ JAR æ–‡ä»¶å®é™…ä¸Šéƒ½ä¼šè¢«åŠ è½½ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Example</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        val db <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> db<span class="token punctuation">.</span><span class="token function">asyncLoad</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>lib1<span class="token punctuation">,</span> lib2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// maybe created when lib2 or both are not loaded into database</span>
            <span class="token comment">// but buildDir will be loaded anyway</span>
            <span class="token keyword">var</span> cp <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span>buildDir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="bytecodeåŠ è½½" tabindex="-1"><a class="header-anchor" href="#bytecodeåŠ è½½" aria-hidden="true">#</a> BytecodeåŠ è½½</h3><p>â€‹ å­—èŠ‚ç åŠ è½½åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼š</p><p>â€‹ ä» JAR æ–‡ä»¶æˆ–æ„å»ºç›®å½•ä¸­æ£€ç´¢æœ‰å…³ç±»åçš„ä¿¡æ¯ï¼Œ</p><p>â€‹ ä» JAR æ–‡ä»¶æˆ–æ„å»ºç›®å½•ä¸­è¯»å–ç±»çš„å­—èŠ‚ç å¹¶è¿›è¡Œå¤„ç†ï¼ˆæŒä¹…åŒ–æ•°æ®ï¼Œè®¾ç½® <code>JcFeature</code> å®ç°ç­‰ï¼‰ã€‚</p><p>â€‹ åœ¨æ‰§è¡Œç¬¬ä¸€æ­¥åï¼ŒJacoDB æˆ– JcClasspath å®ä¾‹å°†ç«‹å³è¿”å›ã€‚æ‚¨åœ¨ç¬¬äºŒæ­¥æœŸé—´æ£€ç´¢ç±»çš„æœ€ç»ˆè¡¨ç¤ºã€‚åœ¨è¿™ä¸¤ä¸ªæ­¥éª¤ä¹‹é—´çš„æŸä¸ªæ—¶åˆ»ï¼Œ<code>.class</code> æ–‡ä»¶å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œç±»çš„è¡¨ç¤ºå°†ç›¸åº”åœ°å—åˆ°å½±å“ã€‚</p><h1 id="ä¸‰-æ•°æ®åº“ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#ä¸‰-æ•°æ®åº“ç‰¹æ€§" aria-hidden="true">#</a> ä¸‰ æ•°æ®åº“ç‰¹æ€§</h1><p>â€‹ <code>Feature</code> æ˜¯ä¸€ä¸ªå…è®¸åŸºäºå­—èŠ‚ç å­˜å‚¨å’ŒæŸ¥è¯¢é™„åŠ ä¿¡æ¯çš„æ¥å£ã€‚<code>Feature</code> éœ€è¦åœ¨åˆ›å»º <code>JacoDB</code> å®ä¾‹æ—¶è®¾ç½®ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token class-name">JacoDb</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">useProcessJRE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/compilation-db/\${System.currentTimeMillis()}&quot;</span><span class="token punctuation">)</span> <span class="token comment">// persist data</span>
    <span class="token punctuation">.</span><span class="token function">installFeatures</span><span class="token punctuation">(</span><span class="token class-name">Usages</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">,</span> <span class="token class-name">InMemoryHierarchy</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="inmemoryhierarchy" tabindex="-1"><a class="header-anchor" href="#inmemoryhierarchy" aria-hidden="true">#</a> <code>InMemoryHierarchy</code></h2><p>â€‹ é»˜è®¤æƒ…å†µä¸‹ï¼ŒJacoDB å°†ç±»å±‚æ¬¡ç»“æ„çš„ä¿¡æ¯å­˜å‚¨åœ¨ SQL æ•°æ®åº“ä¸­ï¼ˆ<code>ClassHierarchies</code> è¡¨ï¼ŒåŒ…å«åˆ—ï¼š<code>class_id</code>ã€<code>super_id</code>ã€<code>is_interface</code>ï¼‰ã€‚è¿™å…è®¸æˆ‘ä»¬ä½¿ç”¨é€’å½’ SQL æŸ¥è¯¢æ£€ç´¢ç‰¹å®šç±»çš„å±‚æ¬¡ç»“æ„ã€‚é€’å½’æŸ¥è¯¢ç›¸å½“å¸¸è§ä½†ä¹Ÿç›¸å½“æ…¢ã€‚</p><p>â€‹ <code>InMemoryHierarchy</code> è§£å†³äº†å†…ç½®è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½é—®é¢˜ã€‚å®ƒå¼•å…¥äº†ä¸€ä¸ªå¿«é€Ÿæœç´¢çš„å†…å­˜ç¼“å­˜ã€‚</p><p>â€‹ å†…å­˜å¼€é”€ä¸º O(ç±»çš„æ•°é‡)ã€‚å¯¹äºçº¦ 50K ä¸ªç±»çš„é¡¹ç›®ï¼ˆåŒ…æ‹¬è¿è¡Œæ—¶ï¼‰ï¼Œè¿™æ ·ä¸€ä¸ªç¼“å­˜çš„å†…å­˜æ¶ˆè€—çº¦ä¸º ~6.5 Mb å †å†…å­˜ã€‚</p><h2 id="usages" tabindex="-1"><a class="header-anchor" href="#usages" aria-hidden="true">#</a> <code>Usages</code></h2><p>â€‹ æ‚¨å¯ä»¥æ‰¾åˆ°ä½¿ç”¨æ–¹æ³•å’Œå­—æ®µçš„åœ°æ–¹ã€‚ä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œè¯·ä½¿ç”¨<code>InMemoryHierarchy</code>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token class-name">JacoDb</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">useProcessJRE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;/tmp/compilation-db/\${System.currentTimeMillis()}&quot;</span><span class="token punctuation">)</span> <span class="token comment">// persist data</span>
    <span class="token punctuation">.</span><span class="token function">installFeatures</span><span class="token punctuation">(</span><span class="token class-name">Usages</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">,</span> <span class="token class-name">InMemoryHierarchy</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> method <span class="token operator">=</span> run<span class="token punctuation">;</span> <span class="token comment">// java.lang.Runnable#run method</span>
<span class="token keyword">var</span> field <span class="token operator">=</span> field<span class="token punctuation">;</span> <span class="token comment">// java.lang.String#value field</span>
<span class="token keyword">var</span> cp <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span>allClasspath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cp<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// sequence of methods which calls method</span>
cp<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> <span class="token class-name">FieldUsageMode</span><span class="token punctuation">.</span><span class="token constant">READ</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// sequence of fields which reads field value</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ Usages ç´¢å¼•å™¨éå†æ‰€æœ‰æŒ‡ä»¤ï¼Œæ”¶é›†å…³äºæ–¹æ³•è°ƒç”¨æˆ–å­—æ®µè®¿é—®çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ä¸€ä¸ªè¡¨ä¸­ï¼š</p><table><thead><tr><th>åˆ—å</th><th>åˆ—æè¿°</th></tr></thead><tbody><tr><td><code>callee_class_symbol_id</code></td><td>è¢«è°ƒç”¨ç±»åçš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td><code>callee_name_symbol_id</code></td><td>æ–¹æ³•/å­—æ®µåçš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td><code>callee_desc_hash</code></td><td>å­—æ®µä½¿ç”¨ä¸º nullï¼›æ–¹æ³•çš„å­—èŠ‚ç çš„ Sip å“ˆå¸Œï¼Œæ–¹æ³•çš„æè¿°</td></tr><tr><td><code>opcode</code></td><td>æŒ‡ä»¤æ“ä½œç </td></tr><tr><td><code>caller_class_symbols_id</code></td><td>è°ƒç”¨è€…ç±»åçš„å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td><code>caller_method_offsets</code></td><td>æ­¤ç”¨æ³•çš„æ–¹æ³•ç¼–å·</td></tr><tr><td><code>location_id</code></td><td>ä½ç½®æ ‡è¯†ç¬¦</td></tr></tbody></table><h1 id="å››-ç±»è·¯å¾„ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#å››-ç±»è·¯å¾„ç‰¹æ€§" aria-hidden="true">#</a> å›› ç±»è·¯å¾„ç‰¹æ€§</h1><h2 id="classpath-features" tabindex="-1"><a class="header-anchor" href="#classpath-features" aria-hidden="true">#</a> Classpath features</h2><p>â€‹ ç‰¹æ€§ç”¨äºåŸºäº <code>JcClasspath</code> å­—èŠ‚ç æ„å»ºè¡¨ç¤ºã€‚åœ¨åˆ›å»ºç±»è·¯å¾„æ—¶ï¼Œåº”è¯¥ä¼ é€’è¿™äº›ç‰¹æ€§ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">JcClasspath</span> cp <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span>files<span class="token punctuation">,</span>
    <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AppendMainMethodToAllClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jcclasspathfeature" tabindex="-1"><a class="header-anchor" href="#jcclasspathfeature" aria-hidden="true">#</a> <code>JcClasspathFeature</code></h3><p>â€‹ è¿™ä¸ªç±»æ˜¯æ‰€æœ‰ç‰¹æ€§çš„åŸºç±»ã€‚å®ƒæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p><p>â€‹ <code>on(event)</code> å…è®¸æ¥æ”¶æ¥è‡ªå…¶ä»–ç‰¹æ€§çš„äº‹ä»¶ï¼›</p><p>â€‹ <code>event(result, input)</code> ä¸ºå…¶ä»–ç‰¹æ€§ç”Ÿæˆäº‹ä»¶ã€‚</p><p>â€‹ åŸºæœ¬åœºæ™¯æ˜¯ç¼“å­˜ï¼šå½“æ‰©å±•è·å–æœ‰å…³ä»£ç ç»“æ„çš„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å°†æ­¤ä¿¡æ¯ç¼“å­˜ä»¥ä¾›å°†æ¥ä½¿ç”¨ã€‚</p><h3 id="jcclasspathextfeature" tabindex="-1"><a class="header-anchor" href="#jcclasspathextfeature" aria-hidden="true">#</a> <code>JcClasspathExtFeature</code></h3><p>â€‹ å¯ç”¨äºæ¨¡æ‹Ÿæˆ–ç¼“å­˜ï¼š</p><ul><li><p><code>tryFindClass(classpath, name): Optional&lt;JcClassOrInterface&gt;?</code></p></li><li><p><code>tryFindType(classpath, name): Optional&lt;JcType&gt;?</code> è¿”å›å€¼åº”ç¬¦åˆä»¥ä¸‹é€»è¾‘ï¼š</p></li><li><p>å¯¹äºæ‰¾åˆ°çš„ç±»æˆ–ç±»å‹ï¼Œè¿”å›éç©ºçš„ <code>Optional</code>ï¼›</p></li><li><p>å¯¹äºåœ¨ç±»è·¯å¾„ä¸­ä¸å­˜åœ¨çš„ç±»æˆ–ç±»å‹ï¼Œè¿”å›ç©ºçš„ <code>Optional</code>ï¼›</p></li><li><p>å½“æˆ‘ä»¬ä¸çŸ¥é“ç±»æˆ–ç±»å‹æ˜¯å¦å­˜åœ¨æ—¶ï¼Œè¿”å› <code>null</code>ã€‚</p></li></ul><h3 id="jcclassextfeature" tabindex="-1"><a class="header-anchor" href="#jcclassextfeature" aria-hidden="true">#</a> <code>JcClassExtFeature</code></h3><p>å¯ç”¨äºå¯¹ç±»è¿›è¡Œä¿®è¡¥ï¼Œæ·»åŠ æ–°å­—æ®µæˆ–æ–¹æ³•ï¼š</p><ul><li><code>fieldsOf(clazz)</code> è¿”å›ç‰¹å®šç±»çš„é™„åŠ å­—æ®µåˆ—è¡¨ï¼›é»˜è®¤ä¸º <code>null</code>ã€‚</li><li><code>methodsOf(clazz)</code> è¿”å›ç‰¹å®šç±»çš„é™„åŠ æ–¹æ³•åˆ—è¡¨ï¼›é»˜è®¤ä¸º <code>null</code>ã€‚</li><li><code>extensionValuesOf(clazz)</code> è¿”å›ç‰¹å®šç±»çš„é™„åŠ ä¿¡æ¯çš„æ˜ å°„ã€‚</li></ul><p><code>extensionValuesOf</code> å¯ä»¥æš´éœ²æœ‰å…³ç±»çš„ç‰¹å®šä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œæ¥è‡ª Kotlin æˆ– Scala ç¼–è¯‘å™¨ã€‚</p><h3 id="jcinstextfeature" tabindex="-1"><a class="header-anchor" href="#jcinstextfeature" aria-hidden="true">#</a> <code>JcInstExtFeature</code></h3><ul><li><code>transformRawInstList(method: JcMethod, list)</code> è½¬æ¢åŸå§‹æŒ‡ä»¤åˆ—è¡¨ã€‚</li><li><code>transformInstList(method, list)</code> è½¬æ¢æŒ‡ä»¤åˆ—è¡¨ â€” åŸå§‹æŒ‡ä»¤ä¿æŒä¸å˜ã€‚</li></ul><h2 id="unknownclass" tabindex="-1"><a class="header-anchor" href="#unknownclass" aria-hidden="true">#</a> UnknownClass</h2><p>â€‹ å¯ç”¨äºä¼˜é›…åœ°å¤„ç†ä¸€äº›ç±»æœªä¿ç•™åœ¨ç±»è·¯å¾„ä¸­çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>

    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token keyword">extends</span> <span class="token class-name">Bar</span> <span class="token punctuation">{</span>

    <span class="token class-name">Bar</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ç±» <code>Foo</code> ä½†ä¸åŒ…å« <code>Bar</code> çš„ç±»è·¯å¾„ã€‚ç±»è·¯å¾„çš„é»˜è®¤è¡Œä¸ºæ˜¯åœ¨å°è¯•è®¿é—®ä¸å­˜åœ¨çš„ç±»æ—¶å¤±è´¥ã€‚ä¾‹å¦‚ï¼Œè§£ææ–¹æ³•æŒ‡ä»¤å°†å¤±è´¥ï¼Œè¯»å–ç±»å±‚æ¬¡ç»“æ„å°†å¤±è´¥ï¼Œè§£ææ–¹æ³•å°†å¤±è´¥ã€‚</p><p>â€‹ <code>UnknownClasses</code> ç‰¹æ€§ä¿®å¤äº†è¿™ç§è¡Œä¸ºã€‚æ‰€æœ‰æŒ‡å‘æ— å¤„çš„å¼•ç”¨å°†è§£æä¸º <code>JcClassOrInterface</code> å®ä¾‹çš„ç‰¹æ®Šå®ç°ã€‚è¿™æ ·çš„å®ä¾‹å°†å…·æœ‰ç©ºçš„ <code>JcClassOrInterface.declaredFields</code> å’Œ <code>JcClassOrInterface.declaredMethods</code>ï¼Œä½†é€šè¿‡ <code>JcClassOrInterface.lookup</code> æ¥å£å®Œæˆçš„æ‰€æœ‰è§£æå°†è¿”å›æ¨¡æ‹Ÿå®ä¾‹ã€‚</p><h1 id="äº”-æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#äº”-æŒ‡ä»¤" aria-hidden="true">#</a> äº” æŒ‡ä»¤</h1><h2 id="åŸå§‹æŒ‡ä»¤åˆ—è¡¨-api" tabindex="-1"><a class="header-anchor" href="#åŸå§‹æŒ‡ä»¤åˆ—è¡¨-api" aria-hidden="true">#</a> åŸå§‹æŒ‡ä»¤åˆ—è¡¨ API</h2><p>â€‹ <code>JcRawInstList</code> è¡¨ç¤ºä¸‰åœ°å€ Java å­—èŠ‚ç æŒ‡ä»¤çš„åŸå§‹åˆ—è¡¨è¡¨ç¤ºã€‚ &quot;åŸå§‹&quot; æ„å‘³ç€æ­¤è¡¨ç¤ºä¸åæ˜ ç¨‹åºçš„ç±»å‹å’Œæ§åˆ¶æµä¿¡æ¯ã€‚æ­¤è¡¨ç¤ºæ˜¯ JVM å­—èŠ‚ç æŒ‡ä»¤ä¸ä¸‰åœ°å€æŒ‡ä»¤åˆ—è¡¨çš„ä¸€å¯¹ä¸€åŒ¹é…ã€‚</p><p>â€‹ è¿™ä¸ªè¡¨ç¤ºçš„åŸºç±»æ˜¯ <code>JcRawInstList</code>ã€‚å®ƒç”Ÿæˆä¸€ä¸ªç±»ä¼¼åˆ—è¡¨çš„æŒ‡ä»¤é›†åˆï¼Œå› æ­¤æ‚¨å¯ä»¥ä¿®æ”¹æ­¤åˆ—è¡¨ï¼Œè¿­ä»£æŒ‡ä»¤æˆ–é€šè¿‡ç´¢å¼•è®¿é—®å®ƒä»¬ã€‚</p><h2 id="ä¸‰åœ°å€æŒ‡ä»¤" tabindex="-1"><a class="header-anchor" href="#ä¸‰åœ°å€æŒ‡ä»¤" aria-hidden="true">#</a> ä¸‰åœ°å€æŒ‡ä»¤</h2><p><code>JcRawInst</code> æ˜¯åŸå§‹æŒ‡ä»¤çš„åŸºç¡€æ¥å£ã€‚æ‰€æœ‰æŒ‡ä»¤éƒ½ç”±å¯¹è±¡æ ‡è¯†ï¼Œä¸èƒ½ä½¿ç”¨ equals è¿›è¡Œæ¯”è¾ƒã€‚</p><p>ä»¥ä¸‹æ˜¯ <code>JcRawInst</code> å®ç°çš„åˆ—è¡¨ï¼š</p><ul><li><code>JcAssignInst</code> â€” èµ‹å€¼æŒ‡ä»¤ã€‚æŒ‡ä»¤çš„å·¦ä¾§åªèƒ½æ˜¯ <code>JcRawValue</code>ï¼Œå³ä¾§å¯ä»¥æ˜¯ä»»ä½•è¡¨è¾¾å¼ï¼ˆ<code>JcRawExpr</code>ï¼‰ã€‚</li><li><code>JcRawEnterMonitorInst</code>ã€<code>JcRawExitMonitorInst</code> â€” ç›‘è§†å™¨æŒ‡ä»¤ã€‚ç›´æ¥å¯¹åº”å®ƒä»¬ç°æœ‰çš„æ¨¡æ‹Ÿã€‚ç›‘è§†å™¨å±æ€§åªèƒ½æ˜¯ <code>JcRawSimpleValue</code>ã€‚</li><li><code>JcRawCallInst</code> â€” è°ƒç”¨æŒ‡ä»¤ã€‚è¡¨ç¤ºä¸å°†å…¶è¿”å›å˜é‡ä¿å­˜åˆ°ä»»ä½•æœ¬åœ°å˜é‡çš„æ–¹æ³•ã€‚è¿”å›å€¼çš„æ–¹æ³•è°ƒç”¨é€šè¿‡ <code>JcRawAssignInst</code> è¡¨ç¤ºã€‚</li><li><code>JcRawLabelInst</code> â€” æ ‡ç­¾æŒ‡ä»¤ã€‚ç”¨äºæ ‡è®°ä»£ç ä¸­çš„ä¸€äº›ç¨‹åºç‚¹ã€‚ä¸»è¦ç”¨äºåˆ†æ”¯æŒ‡ä»¤ä¸­ã€‚æ ‡ç­¾é€šè¿‡åç§°æ ‡è¯†ï¼Œå¯¹æ ‡ç­¾çš„æ‰€æœ‰å¼•ç”¨é€šè¿‡ <code>JcRawLabelRef</code> ç±»è¡¨ç¤ºã€‚</li><li><code>JcRawReturnInst</code> â€” è¿”å›æŒ‡ä»¤ã€‚å½“æ–¹æ³•ä¸è¿”å›ä»»ä½•å†…å®¹æ—¶ï¼Œ<code>returnValue</code> å±æ€§ä¸º <code>null</code>ã€‚</li><li><code>JcRawThrowInst</code> â€” æŠ›å‡ºæŒ‡ä»¤ã€‚</li><li><code>JcRawCatchInst</code> â€” æ•è·æŒ‡ä»¤ã€‚è¡¨ç¤ºä»£ç ä¸­ try...catch å—çš„æ¡ç›®ã€‚ä¸ç›´æ¥æ˜ å°„åˆ°å­—èŠ‚ç æŒ‡ä»¤ï¼Œä½†è¡¨ç¤ºæ–¹æ³•çš„ <code>TryCatchBlock</code>ã€‚å­˜å‚¨ä¸æ•è·çš„å¯æŠ›å‡ºå¼‚å¸¸å¯¹åº”çš„å€¼ï¼Œä»¥åŠå®ƒä» <code>startInclusive</code> åˆ° <code>endExclusive</code> çš„æŒ‡ä»¤èŒƒå›´ã€‚</li><li><code>JcRawGotoInst</code> â€” è·³è½¬æŒ‡ä»¤ã€‚</li><li><code>JcRawIfInst</code> â€” æ¡ä»¶è·³è½¬æŒ‡ä»¤ã€‚æŒ‡ä»¤çš„æ¡ä»¶å¿…é¡»æ˜¯ <code>JcRawConditionExpr</code>ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ›´é«˜çº§åˆ«çš„ç¼–ç¨‹è¯­è¨€ä¸­ä½¿ç”¨çš„å¹¶éæ‰€æœ‰æ¡ä»¶è¡¨è¾¾å¼éƒ½å¯ä»¥è½»æ¾è¡¨è¾¾ä¸º JVM å­—èŠ‚ç ã€‚</li><li><code>JcRawSwitchInst</code> â€” å¼€å…³æŒ‡ä»¤ã€‚<code>LookupSwitch</code> å’Œ <code>TableSwitch</code> å­—èŠ‚ç æŒ‡ä»¤çš„ç»„åˆè¡¨ç¤ºã€‚</li><li><code>JcRawLineNumberInst</code>â€”æ ‡è¯†åœ¨æºä»£ç ä¸­çš„ä½ç½®</li><li><code>JcRawAssignInst</code></li></ul><h2 id="åŸå§‹è¡¨è¾¾å¼" tabindex="-1"><a class="header-anchor" href="#åŸå§‹è¡¨è¾¾å¼" aria-hidden="true">#</a> åŸå§‹è¡¨è¾¾å¼</h2><p>â€‹ <code>JcRawExpr</code> æ˜¯æ‰€æœ‰å¯ä»¥åœ¨ JVM å­—èŠ‚ç ä¸­è¡¨ç¤ºçš„è¡¨è¾¾å¼ç±»å‹å’Œå€¼ç±»å‹çš„åŸºç¡€æ¥å£ã€‚<code>JcRawExpr</code> å°†å…¶ç±»å‹å­˜å‚¨ä¸º <code>TypeName</code> å¯¹è±¡ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¡¨ç¤ºä¸ºå­—ç¬¦ä¸²çš„ Java ç±»å‹åç§°ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ˜¯ &quot;raw&quot;ï¼‰ã€‚rawï¼šåŸå§‹çš„</p><p>ä»¥ä¸‹æ˜¯ <code>JcRawExpr</code> å®ç°çš„åˆ—è¡¨ï¼š</p><ul><li><code>JcRawBinaryExpr</code> â€” å…è®¸å®ç°æ‰€æœ‰ç®—æœ¯è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ <code>JcRawAdd</code>ã€<code>JcRawMul</code> ç­‰ï¼‰ã€æ¡ä»¶è¡¨è¾¾å¼ï¼ˆ<code>JcRawEq</code>ã€<code>JcRawGt</code> ç­‰ï¼‰ã€é€»è¾‘è¡¨è¾¾å¼ï¼ˆ<code>JcRawAnd</code>ã€<code>JcRawOr</code>ã€<code>JcRawXor</code>ï¼‰çš„äºŒå…ƒè¡¨è¾¾å¼ã€‚</li><li><code>JcRawConditionExpr</code> â€” æ¡ä»¶è¡¨è¾¾å¼ã€‚å¯ç”¨ä½œ <code>JcRawIfInst</code> ä¸­çš„æ¡ä»¶ã€‚</li><li><code>JcRawLengthExpr</code> â€” æ•°ç»„é•¿åº¦è¡¨è¾¾å¼ã€‚</li><li><code>JcRawNegExpr</code> â€” å–åè¡¨è¾¾å¼ã€‚</li><li><code>JcRawCastExpr</code> â€” å¼ºåˆ¶è½¬æ¢è¡¨è¾¾å¼ã€‚å¯ç”¨äºè½¬æ¢å¼•ç”¨ç±»å‹å’ŒåŸå§‹ç±»å‹ã€‚</li><li><code>JcRawNewExpr</code> â€” æ–°å»ºè¡¨è¾¾å¼ã€‚åˆ›å»ºå•ä¸ªå¯¹è±¡ã€‚</li><li><code>JcRawNewArrayExpr</code> â€” æ–°å»ºæ•°ç»„è¡¨è¾¾å¼ã€‚åˆ›å»ºç»™å®šç±»å‹çš„ï¼ˆå¤šç»´ï¼‰æ•°ç»„ã€‚</li><li><code>JcRawInstanceOfExpr</code> â€” instanceof æ£€æŸ¥ã€‚</li><li><code>JcRawCallExpr</code> â€” æ–¹æ³•è°ƒç”¨è¡¨è¾¾å¼ã€‚</li><li><code>JcRawDynamicCallExpr</code> â€” invokedynamic æŒ‡ä»¤è¡¨ç¤ºã€‚ä¿ç•™æ‰€æœ‰ä¿¡æ¯ã€‚</li><li><code>JcRawVirtualCallExpr</code></li><li><code>JcRawInterfaceCallExpr</code></li><li><code>JcRawStaticCallExpr</code></li><li><code>JcRawSpecialCallExpr</code></li><li><code>JcRawValue</code> â€” å•ä¸ªå€¼çš„è¡¨ç¤ºã€‚</li><li><code>JcRawSimpleValue</code> â€” æ²¡æœ‰ä»»ä½•å­å€¼çš„ç®€å•å€¼çš„è¡¨ç¤ºã€‚</li><li><code>JcRawThis</code></li><li><code>JcRawArgument</code></li><li><code>JcRawLocal</code></li><li><code>JcRawConstant</code></li><li><code>JcRawComplexValue</code> â€” å…·æœ‰å­å€¼çš„å¤æ‚å€¼ã€‚</li><li><code>JcRawFieldRef</code> â€” å­—æ®µå¼•ç”¨ã€‚å¯ç”¨ä½œå­—æ®µè¯»å–è®¿é—®ï¼ˆä¾‹å¦‚ <code>a = x.y</code>ï¼‰å’Œå­—æ®µå­˜å‚¨è®¿é—®ï¼ˆä¾‹å¦‚ <code>x.y = a</code>ï¼‰ã€‚</li><li><code>JcRawArrayAccess</code> â€” æ•°ç»„å…ƒç´ å¼•ç”¨ã€‚å¯ç”¨ä½œæ•°ç»„è¯»å–è®¿é—®ï¼ˆä¾‹å¦‚ <code>a = x[y]</code>ï¼‰å’Œæ•°ç»„å­˜å‚¨è®¿é—®ï¼ˆä¾‹å¦‚ <code>x[y] = a</code>ï¼‰ã€‚</li></ul><p>è¦è·å¾—æ–¹æ³•çš„ä¸‰åœ°å€æŒ‡ä»¤åˆ—è¡¨è¡¨ç¤ºï¼Œéœ€è¦è°ƒç”¨ <code>JcMethod::instructionList</code>ã€‚æŒ‡ä»¤åˆ—è¡¨æ„å»ºéœ€è¦ <code>JcClasspath</code>ï¼Œå› ä¸ºæŸäº›é˜¶æ®µä½¿ç”¨å­ç±»å‹ä¿¡æ¯ã€‚</p><h2 id="æ„å»ºæŒ‡ä»¤åˆ—è¡¨-å®ç°ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#æ„å»ºæŒ‡ä»¤åˆ—è¡¨-å®ç°ç»†èŠ‚" aria-hidden="true">#</a> æ„å»ºæŒ‡ä»¤åˆ—è¡¨ï¼šå®ç°ç»†èŠ‚</h2><p>â€‹ åŸå§‹æŒ‡ä»¤åˆ—è¡¨æ„å»ºå™¨ç”¨äºä»å­—èŠ‚ç è¡¨ç¤ºï¼ˆå³ä» MethodNodeï¼‰æ„å»º JcRawInstListã€‚è¦æ„å»ºæŒ‡ä»¤åˆ—è¡¨è¡¨ç¤ºï¼ŒMethodNode åº”åŒ…å«å¸§ä¿¡æ¯ï¼ˆå³ FrameNode å®ä¾‹ï¼‰ï¼Œå¹¶ä¸”ä¸åº”åŒ…å« JSRï¼ˆè·³è½¬å­ä¾‹ç¨‹ï¼‰æŒ‡ä»¤ã€‚å› æ­¤ï¼Œæ¯æ¬¡åˆ›å»º ClassNode æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨ ClassNode.computeFrames() æ‰©å±•å‡½æ•°ï¼Œè¯¥å‡½æ•°è®¡ç®—æ¯ä¸ªæ–¹æ³•çš„å¸§ä¿¡æ¯ã€‚computeFrames å‡½æ•°ä½¿ç”¨ ASM åŠŸèƒ½æ¥è®¡ç®—å¸§ï¼šå®ƒä½¿ç”¨ ClassWriter å°† ClassNode è½¬æ¢å›å­—èŠ‚ç ï¼ˆå®é™…ä¸Šåœ¨è½¬æ¢æœŸé—´æ‰§è¡Œå¸§è®¡ç®—ï¼‰ï¼Œç„¶åä½¿ç”¨ ClassReader å†æ¬¡è¯»å–è¯¥å­—èŠ‚ç ã€‚è¿™ä¸æ˜¯æœ€æœ‰æ•ˆçš„æ–¹å¼ï¼Œä½†æ˜¯æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼šæ‰‹åŠ¨è®¡ç®—å¸§æ˜¯ç›¸å½“å›°éš¾çš„ã€‚å¦ä¸€ä»¶äº‹æ˜¯å†…è” JSR æŒ‡ä»¤ã€‚æˆ‘ä»¬é€šè¿‡è°ƒç”¨ MethodNode.jsrInlined æ‰©å±•æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¯¥æ‰©å±•è¿”å›ä¸€ä¸ªæ–°çš„ MethodNode å®ä¾‹ã€‚å®ƒä½¿ç”¨ ASM çš„ JSRInlinerAdapter å®ç”¨ç¨‹åºæ¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å†…è” JRS æŒ‡ä»¤çš„æ–°æ–¹æ³•èŠ‚ç‚¹ã€‚</p><p>â€‹ RawInstListBuilder å°† JVM å­—èŠ‚ç æŒ‡ä»¤åˆ—è¡¨è½¬æ¢ä¸ºä¸‰åœ°å€æŒ‡ä»¤åˆ—è¡¨ã€‚å¤§å¤šæ•°è½¬æ¢è¿‡ç¨‹éƒ½å¾ˆç®€å•ï¼šå­—èŠ‚ç æŒ‡ä»¤æ˜ å°„åˆ°ä¸‰åœ°å€è¡¨è¾¾å¼å’ŒæŒ‡ä»¤ã€‚æœ€å¤æ‚çš„éƒ¨åˆ†æ˜¯å¸§åˆå¹¶ã€‚JVM å¸§æè¿°äº†è™šæ‹Ÿæœºåœ¨æ¯ä¸ªæŒ‡ä»¤æ—¶çš„çŠ¶æ€ï¼Œå³å£°æ˜çš„å±€éƒ¨å˜é‡å’Œå †æ ˆçŠ¶æ€ã€‚å½“ä¸€æ¡æŒ‡ä»¤æœ‰å¤šä¸ªå‰ä»»æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†å¤šä¸ªä¼ å…¥å¸§åˆå¹¶ä¸ºä¸€ä¸ªã€‚æœ‰æ—¶ JVM åœ¨æŒ‡ä»¤ä¹‹å‰æ·»åŠ ä¸€ä¸ªç‰¹æ®Šçš„å¸§èŠ‚ç‚¹ï¼Œä»¥æè¿°åœ¨åˆå¹¶åå¸§åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚</p><p>â€‹ åœ¨å¸§åˆå¹¶è¿‡ç¨‹ä¸­æœ‰å››ç§å¯èƒ½çš„æƒ…å†µã€‚</p><p>â€‹ ï¼ˆ1ï¼‰åªæœ‰ä¸€ä¸ªä¼ å…¥å¸§ï¼Œå¹¶ä¸”åœ¨è½¬æ¢å‰å‡ ä¸ªé˜¶æ®µå·²ç»å®Œå…¨å®šä¹‰ï¼ˆå³æˆ‘ä»¬å·²ç»æ”¶é›†äº†æ‰€æœ‰çš„å¸§ä¿¡æ¯ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€åˆ‡éƒ½ç›¸å½“ç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¤åˆ¶å¸§ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¸ºå±€éƒ¨å˜é‡çš„ç±»å‹ä¿¡æ¯è¿›è¡Œç»†åŒ–ã€‚è€ƒè™‘ä»¥ä¸‹å­—èŠ‚ç ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>NEW java/lang/ArrayList
ASTORE 0
...
FRAME FULL [ java/lang/List ]
...
NEW java/lang/LinkedList
ASTORE 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ åœ¨è½¬æ¢å‰ä¸¤æ¡æŒ‡ä»¤æ—¶ï¼Œæˆ‘ä»¬ä¸ºå•å…ƒ 0 åˆ›å»ºäº†ä¸€ä¸ªå±€éƒ¨å˜é‡ %0ï¼Œå…¶ç±»å‹ä¸º java.lang.ArrayListã€‚ä½†æ˜¯ï¼Œåœ¨è½¬æ¢å¸§ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ° JVM å°†å•å…ƒ 0 çš„ç±»å‹è§†ä¸º java.lang.Listï¼Œç„¶åä½¿ç”¨å•å…ƒ 0 å­˜å‚¨ Java List çš„å…¶ä»–å®ç°ã€‚æˆ‘ä»¬å¯ä»¥å°† %0 çš„ç±»å‹ç»†åŒ–ä¸º java.lang.Listï¼Œç„¶åå°†æ‰€æœ‰ %0 çš„å‡ºç°æ›¿æ¢ä¸ºæ–°ç‰ˆæœ¬ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ RawInstListBuilder çš„ localTypeRefinement å±æ€§å’Œ ExprMapper å®ç”¨ç¨‹åºç±»æ‰§è¡Œçš„ã€‚</p><p>ï¼ˆ2ï¼‰åªæœ‰ä¸€ä¸ªä¼ å…¥å¸§ï¼Œå°šæœªå®šä¹‰ã€‚è¿™æ˜¯ä¸€ç§ç½•è§çš„æƒ…å†µï¼Œä½†åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯èƒ½ä¼šå‘ç”Ÿï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GOTO L2
L1
FRAME FULL [ java/lang/List ]
...
GOTO L3
L2
...
GOTO L1
L3
RETURN
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å¸§ä¿¡æ¯åˆ›å»ºä¸€ä¸ªå…·æœ‰å®šä¹‰ç±»å‹çš„æ–°å±€éƒ¨å˜é‡ï¼Œå¹¶è®°å¾—åœ¨å‰ä»»ä¸­æ·»åŠ ä¸€ä¸ªèµ‹å€¼ï¼Œè¯¥èµ‹å€¼å°†ä½¿ç”¨æ­£ç¡®çš„å€¼åˆå§‹åŒ–æ–°å˜é‡ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ laterAssignments å’Œ laterStackAssignments æ˜ å°„ä»¥åŠ buildRequiredAssignments å‡½æ•°åœ¨æœ€åæ‰§è¡Œçš„ã€‚å¯¹äºå †æ ˆå˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œè¯¥è¿‡ç¨‹ç±»ä¼¼ã€‚</p><p>ï¼ˆ3ï¼‰å­˜åœ¨å¤šä¸ªå‰ä»»å¸§ï¼Œæ‰€æœ‰è¿™äº›å‰ä»»å¸§éƒ½å·²å®šä¹‰ï¼ˆä¾‹å¦‚ï¼Œåœ¨ if...else å—ä¹‹ååˆå¹¶æ—¶ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å½“å‰å¸§ä¸­åˆ›å»ºä¸€ä¸ªå…·æœ‰å®šä¹‰ç±»å‹çš„æ–°å±€éƒ¨å˜é‡ï¼Œå¹¶åœ¨å‰ä»»å—ä¸­æ·»åŠ å¿…è¦çš„èµ‹å€¼ã€‚</p><p>ï¼ˆ4ï¼‰å­˜åœ¨å¤šä¸ªå‰ä»»å¸§ï¼Œå…¶ä¸­ä¸æ˜¯æ‰€æœ‰å¸§éƒ½å·²å®šä¹‰ï¼ˆä¾‹å¦‚ï¼Œåœ¨å¾ªç¯æ ‡é¢˜ä¸­åˆå¹¶æ—¶ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨å½“å‰å¸§ä¸­åˆ›å»ºä¸€ä¸ªå…·æœ‰å®šä¹‰ç±»å‹çš„æ–°å±€éƒ¨å˜é‡ï¼Œå°†å¿…è¦çš„èµ‹å€¼æ·»åŠ åˆ°å‰ä»»å—ä¸­ï¼Œå¹¶è®°å¾—åœ¨æœ€åå‘æœªå®šä¹‰çš„å‰ä»»å—æ·»åŠ æ‰€éœ€çš„èµ‹å€¼ã€‚</p><p>â€‹ RawInstListBuilder è¿˜ç®€åŒ–äº†ç”Ÿæˆçš„æŒ‡ä»¤åˆ—è¡¨ã€‚è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºåˆ—è¡¨æ„å»ºè¿‡ç¨‹è‡ªç„¶å¼•å…¥äº†å¾ˆå¤šå†—ä½™ã€‚</p><p>â€‹ ä¸»è¦çš„ç®€åŒ–é˜¶æ®µåŒ…æ‹¬ï¼š</p><p>â€‹ 1åˆ é™¤åŸºæœ¬å—å†…é‡å¤çš„èµ‹å€¼ã€‚</p><p>â€‹ 2åˆ é™¤æœªä½¿ç”¨å˜é‡çš„å£°æ˜ã€‚</p><p>â€‹ 3åˆ é™¤æœªä½¿ç”¨å˜é‡çš„ç›¸äº’ä¾èµ–å£°æ˜ï¼ˆä¾‹å¦‚ a = b å’Œ b = aï¼‰ã€‚</p><p>â€‹ 4ç®€å•çš„å•å…ƒä¼ æ’­ã€‚</p><p>â€‹ 5ä½¿ç”¨ JcClasspath è¿›è¡Œç±»å‹è§„èŒƒåŒ–ã€‚</p><h2 id="visitor-api" tabindex="-1"><a class="header-anchor" href="#visitor-api" aria-hidden="true">#</a> Visitor API</h2><p>chatGPTæè¿°</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Visitor API æ˜¯ JacoDB æä¾›çš„ä¸€ç»„ APIï¼Œç”¨äºéå†å’Œåˆ†æ JVM å­—èŠ‚ç ã€‚è¯¥ API å…è®¸ä½ åˆ›å»ºè®¿é—®è€…ï¼ˆVisitorï¼‰ï¼Œå¹¶åœ¨è®¿é—® JVM å­—èŠ‚ç æ—¶æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚ä»¥ä¸‹æ˜¯è¯¥ API çš„ä¸€äº›å…³é”®æ¦‚å¿µå’Œç±»ï¼š
JcVisitorï¼š
	è¿™æ˜¯ Visitor API çš„ä¸»è¦æ¥å£ã€‚
	æä¾›äº†è®¸å¤š visit æ–¹æ³•ï¼Œç”¨äºå¤„ç†ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œå¦‚ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ã€‚
	ä½ å¯ä»¥å®ç°æ­¤æ¥å£å¹¶é‡å†™ç›¸å…³çš„ visit æ–¹æ³•ï¼Œä»¥åœ¨è®¿é—®å­—èŠ‚ç å…ƒç´ æ—¶æ‰§è¡Œè‡ªå®šä¹‰çš„é€»è¾‘ã€‚
JcNodeï¼š
	JcNode æ˜¯æ‰€æœ‰å­—èŠ‚ç å…ƒç´ çš„é€šç”¨çˆ¶ç±»ã€‚
	è¡¨ç¤ºå­—èŠ‚ç ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥æ˜¯ç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ã€‚
JcClassNodeï¼š
	è¡¨ç¤ºç±»èŠ‚ç‚¹ï¼Œç»§æ‰¿è‡ª JcNodeã€‚
	åŒ…å«æœ‰å…³ç±»çš„ä¿¡æ¯ï¼Œå¦‚ç±»åã€çˆ¶ç±»ã€æ¥å£ç­‰ã€‚
JcMethodNodeï¼š
	è¡¨ç¤ºæ–¹æ³•èŠ‚ç‚¹ï¼Œç»§æ‰¿è‡ª JcNodeã€‚
	åŒ…å«æœ‰å…³æ–¹æ³•çš„ä¿¡æ¯ï¼Œå¦‚æ–¹æ³•åã€å‚æ•°ã€è¿”å›ç±»å‹ç­‰ã€‚
JcFieldNodeï¼š
	è¡¨ç¤ºå­—æ®µèŠ‚ç‚¹ï¼Œç»§æ‰¿è‡ª JcNodeã€‚
	åŒ…å«æœ‰å…³å­—æ®µçš„ä¿¡æ¯ï¼Œå¦‚å­—æ®µåã€ç±»å‹ç­‰ã€‚
é€šè¿‡å®ç° JcVisitor æ¥å£ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªéå†å­—èŠ‚ç çš„è‡ªå®šä¹‰è®¿é—®è€…ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚è¿™ä½¿å¾— JacoDB æˆä¸ºä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºåˆ†æå’Œå¤„ç† Java å­—èŠ‚ç ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ è¿™é‡Œæœ‰ä¸€ä¸ªç”¨äºéå†å’Œä¿®æ”¹ <code>JcRawInstList</code> çš„è®¿é—®è€… APIã€‚è®¿é—®è€…å…·æœ‰æ ‡å‡†æ¥å£ - å®ƒä»¬å¯ä»¥é€šè¿‡åœ¨æŒ‡ä»¤å’Œè¡¨è¾¾å¼ä¸Šä½¿ç”¨ <code>accept</code> æ–¹æ³•æ¥è°ƒç”¨ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>val a = jcRawInst.accept(MyInstVisitor())
val b = jcRawExpr.accept(MyExprVisitor())
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬è¿˜æä¾›äº†ä¸€äº›ç±»ä¼¼&quot;å‡½æ•°å¼&quot;çš„æ‰©å±•ï¼Œç”¨äºå°†è®¿é—®è€…åº”ç”¨äº <code>JcRawInstList</code>ï¼š</p><ul><li><code>filter(visitor: JcRawInstVisitor&lt;Boolean&gt;): JcRawInstList</code></li><li><code>filterNot(visitor: JcRawInstVisitor&lt;Boolean&gt;): JcRawInstList</code></li><li><code>map(visitor: JcRawInstVisitor&lt;JcRawInst&gt;): JcRawInstList</code></li><li><code>mapNotNull(visitor: JcRawInstVisitor&lt;JcRawInst?&gt;): JcRawInstList</code></li><li><code>flatMap(visitor: JcRawInstVisitor&lt;Collection&lt;JcRawInst&gt;&gt;): JcRawInstList</code></li><li><code>apply(visitor: JcRawInstVisitor&lt;Unit&gt;): JcRawInstList</code></li><li><code>applyAndGet(visitor: T, getter: (T) -&gt; R): R</code></li><li><code>collect(visitor: JcRawInstVisitor&lt;T&gt;): Collection&lt;T&gt;</code></li></ul><p>â€‹ <code>jcdb-core</code> åŒ…å«ä¸€äº›ç”¨äºå¤„ç†æŒ‡ä»¤åˆ—è¡¨çš„å®ç”¨è®¿é—®è€…ï¼š</p><p>â€‹ <code>ExprMapper(val mapping: Map&lt;JcRawExpr, JcRawExpr&gt;)</code> â€” éå†æŒ‡ä»¤åˆ—è¡¨ï¼Œå¹¶å°†æ‰€æœ‰å‡ºç°åœ¨æ˜ å°„ä¸­çš„è¡¨è¾¾å¼æ›¿æ¢ä¸ºç›¸åº”çš„å±æ€§ã€‚</p><p>â€‹ <code>FullExprSetCollector()</code> â€” æ”¶é›†åœ¨ç»™å®šå¯¹è±¡ï¼ˆæŒ‡ä»¤åˆ—è¡¨ã€å•ä¸ªæŒ‡ä»¤æˆ–è¡¨è¾¾å¼ï¼‰ä¸­å‡ºç°çš„æ‰€æœ‰è¡¨è¾¾å¼ã€‚</p><p>â€‹ <code>InstructionFilter(val predicate: (JcRawInst) -&gt; Boolean)</code> â€” é€šè¿‡ç»™å®šçš„è°“è¯å¯¹æŒ‡ä»¤è¿›è¡Œè¿‡æ»¤ã€‚</p><p>â€‹ JcRawInstListå¯ä»¥ä½¿ç”¨MethodNodeBuilder.build()æ–¹æ³•è½¬æ¢å›ASM MethodNodeã€‚è½¬æ¢è¿‡ç¨‹éå¸¸ç›´æ¥ï¼Œä¸éœ€è¦é¢å¤–çš„æ³¨é‡Šã€‚</p><h2 id="ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­" aria-hidden="true">#</a> ä¾‹å­</h2><p>try...catchçš„äºŒåˆ†æœç´¢å®ç°çš„å—å›¾</p><p><img src="`+k+'" alt="Block graph"></p><p>try...catchçš„äºŒåˆ†æœç´¢å®ç°çš„æ§åˆ¶æµå›¾:</p><p><img src="'+v+`" alt="Block graph"></p><h1 id="å…­-å›¾" tabindex="-1"><a class="header-anchor" href="#å…­-å›¾" aria-hidden="true">#</a> å…­ å›¾</h1><h2 id="æ§åˆ¶æµå›¾api" tabindex="-1"><a class="header-anchor" href="#æ§åˆ¶æµå›¾api" aria-hidden="true">#</a> æ§åˆ¶æµå›¾API</h2><p>â€‹ æ–¹æ³•çš„æ§åˆ¶æµå›¾è¡¨ç¤ºä¸ºä¸€ä¸ªJcGraphå¯¹è±¡ã€‚è¦åˆ›å»ºæ–¹æ³•çš„JcGraphï¼Œå¯ä»¥è°ƒç”¨ä¸‰åœ°å€æŒ‡ä»¤åˆ—è¡¨çš„<code>graph</code>å‡½æ•°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>fun <span class="token function">createGraph</span><span class="token punctuation">(</span>classpath<span class="token operator">:</span> <span class="token class-name">JcClasspath</span><span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token class-name">JcMethod</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">JcGraph</span> <span class="token punctuation">{</span>
    val instructionList <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">instructionList</span><span class="token punctuation">(</span>classpath<span class="token punctuation">)</span>
    <span class="token keyword">return</span> instructionList<span class="token punctuation">.</span><span class="token function">graph</span><span class="token punctuation">(</span>classpath<span class="token punctuation">,</span> method<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="jcgraph" tabindex="-1"><a class="header-anchor" href="#jcgraph" aria-hidden="true">#</a> <code>JcGraph</code></h2><p>â€‹ JcGraphçš„ä¸­é—´è¡¨ç¤ºä½¿ç”¨äº†å·²è§£æçš„ç±»å‹ä¿¡æ¯ï¼ˆå³JcTypeå±‚æ¬¡ç»“æ„ï¼‰å’Œç±»è·¯å¾„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªç±»è·¯å¾„å®ä¾‹ã€‚ä¸JcRawInstListç±»ä¼¼ï¼ŒJcGraphå­˜å‚¨äº†æ–¹æ³•æŒ‡ä»¤çš„åˆ—è¡¨ã€‚ç„¶è€Œï¼Œå®ƒè¿˜å°è¯•è§£ææ–¹æ³•ä¸­çš„æ‰€æœ‰æ‰§è¡Œè·¯å¾„ã€‚JcGraphæ“ä½œJcInstç±»å±‚æ¬¡ç»“æ„ï¼ˆåœ¨è®¸å¤šæƒ…å†µä¸‹ç±»ä¼¼äºJcRawInstï¼‰ï¼Œå¹¶æä¾›ä»¥ä¸‹APIï¼š</p><ul><li><code>entry: JcInst</code> â€” è·å–æ–¹æ³•çš„å…¥å£ç‚¹ï¼šåªèƒ½æœ‰ä¸€ä¸ªå…¥å£ç‚¹ã€‚</li><li><code>exits: List&lt;JcInst&gt;</code> â€” è·å–æ–¹æ³•çš„æ‰€æœ‰â€œæ­£å¸¸â€é€€å‡ºç‚¹ï¼Œå³æ‰€æœ‰è¿”å›å’ŒæŠ›å‡ºæŒ‡ä»¤ã€‚</li><li><code>throwExits: Map&lt;JcType, List&lt;JcInst&gt;&gt;</code> â€” æ–¹æ³•çš„æ‰€æœ‰æ½œåœ¨å¼‚å¸¸é€€å‡ºç‚¹ã€‚</li><li><code>ref(inst: JcInst): JcInstRef</code> â€” è·å–æŒ‡ä»¤çš„JcInstRefã€‚å®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„åŒ…è£…å™¨ï¼Œå…è®¸åœ¨éœ€è¦æ—¶å¼•ç”¨æŒ‡ä»¤ã€‚</li><li><code>inst(ref: JcInstRef): JcInst</code> â€” å°†JcInstRefè½¬æ¢ä¸ºJcInstã€‚</li><li><code>previous(inst: JcInst): JcInst</code> â€” è·å–åˆ—è¡¨ä¸­çš„å‰ä¸€æ¡æŒ‡ä»¤ã€‚</li><li><code>next(inst: JcInst): JcInst</code> â€” è·å–åˆ—è¡¨ä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</li><li><code>successors(inst: JcInst): Set&lt;JcInst&gt;</code> â€” è·å–CFGä¸­æŒ‡ä»¤çš„æ‰€æœ‰åç»§ã€‚ä¸åŒ…æ‹¬ä»»ä½•å¼‚å¸¸æ§åˆ¶æµã€‚</li><li><code>predecessors(inst: JcInst): Set&lt;JcInst&gt;</code> â€” è·å–CFGä¸­æŒ‡ä»¤çš„æ‰€æœ‰å‰é©±ã€‚ä¸åŒ…æ‹¬ä»»ä½•å¼‚å¸¸æ§åˆ¶æµã€‚</li><li><code>throwers(inst: JcInst): Set&lt;JcInst&gt;</code> â€” è·å–å¯èƒ½æŠ›å‡ºè¢«<code>inst</code>æ•è·çš„å¼‚å¸¸çš„æ‰€æœ‰æŒ‡ä»¤ã€‚è¡¨ç¤ºæ–¹æ³•çš„å¼‚å¸¸æ§åˆ¶æµã€‚å¯¹æ‰€æœ‰æŒ‡ä»¤è¿”å›ä¸€ä¸ªç©ºé›†ï¼Œé™¤äº†<code>JcCatchInst</code>ã€‚</li><li><code>catchers(inst: JcInst): Set&lt;JcCatchInst&gt;</code> â€” è·å–å¯èƒ½æ•è·<code>inst</code>æŠ›å‡ºçš„å¼‚å¸¸çš„æ‰€æœ‰æŒ‡ä»¤ã€‚è¡¨ç¤ºæ–¹æ³•çš„å¼‚å¸¸æ§åˆ¶æµã€‚</li><li><code>exceptionExits(inst: JcInst): Set&lt;JcClassType&gt;</code> â€” è·å–æŒ‡ä»¤å¯èƒ½æŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ç±»å‹ï¼Œæ–¹æ³•ä¸ä¼šæ•è·ã€‚</li><li><code>blockGraph(): JcBlockGraph</code> â€” åˆ›å»ºCFGçš„åŸºæœ¬å—è¡¨ç¤ºã€‚</li><li><code>iterator(): Iterator&lt;JcInst&gt;</code> â€” åœ¨å›¾çš„æŒ‡ä»¤ä¸Šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ã€‚</li></ul><h2 id="jcblockgraph" tabindex="-1"><a class="header-anchor" href="#jcblockgraph" aria-hidden="true">#</a> <code>JcBlockGraph</code></h2><p>JcBlockGraphæ˜¯ç”¨äºCFGçš„åŸºæœ¬å—APIã€‚å®ƒæ“ä½œJcBasicBlockå®ä¾‹â€”â€”æ¯ä¸ªåŸºæœ¬å—åªè¡¨ç¤ºä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œå…·æœ‰ä»¥ä¸‹å±æ€§ï¼š</p><ul><li>åŸºæœ¬å—çš„æŒ‡ä»¤åœ¨æ­£å¸¸æ‰§è¡Œæ—¶ï¼ˆå³æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸æ—¶ï¼‰æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ã€‚</li><li>åŸºæœ¬å—çš„æ‰€æœ‰æŒ‡ä»¤å…·æœ‰ç›¸åŒçš„å¼‚å¸¸å¤„ç†ç¨‹åºï¼Œå³å¯¹äºåŸºæœ¬å—çš„æ¯ä¸ªæŒ‡ä»¤è°ƒç”¨<code>jcGraph.catchers(inst)</code>å°†è¿”å›ç›¸åŒçš„ç»“æœã€‚</li></ul><p>JcBlockGraphæä¾›ä»¥ä¸‹APIï¼š</p><ul><li><code>entry: JcBasicBlock</code> â€” æ–¹æ³•çš„å…¥å£ã€‚åªèƒ½æœ‰ä¸€ä¸ªå…¥å£ã€‚</li><li><code>exits: List&lt;JcBasicBlock&gt;</code> â€” æ–¹æ³•çš„å‡ºå£ã€‚</li><li><code>instructions(block: JcBasicBlock): List&lt;JcInst&gt;</code> â€” è·å–åŸºæœ¬å—çš„æŒ‡ä»¤ã€‚</li><li><code>predecessors(block: JcBasicBlock): Set&lt;JcBasicBlock&gt;</code> â€” è·å–CFGä¸­åŸºæœ¬å—çš„æ‰€æœ‰å‰é©±ã€‚ä¸åŒ…æ‹¬ä»»ä½•å¼‚å¸¸æ§åˆ¶æµã€‚</li><li><code>successors(block: JcBasicBlock): Set&lt;JcBasicBlock&gt;</code> â€” è·å–CFGä¸­åŸºæœ¬å—çš„æ‰€æœ‰åç»§ã€‚ä¸åŒ…æ‹¬ä»»ä½•å¼‚å¸¸æ§åˆ¶æµã€‚</li><li><code>throwers(block: JcBasicBlock): Set&lt;JcBasicBlock&gt;</code> â€” è·å–å¯èƒ½æŠ›å‡ºè¢«<code>block</code>æ•è·çš„å¼‚å¸¸çš„æ‰€æœ‰åŸºæœ¬å—ã€‚è¡¨ç¤ºæ–¹æ³•çš„å¼‚å¸¸æ§åˆ¶æµã€‚å¯¹äºæ‰€æœ‰å—ï¼Œè¿”å›ä¸€ä¸ªç©ºé›†ï¼Œé™¤äº†ä»¥<code>JcCatchInst</code>å¼€å§‹çš„å—ã€‚</li><li><code>catchers(block: JcBasicBlock): Set&lt;JcBasicBlock&gt;</code> â€” è·å–å¯èƒ½æ•è·<code>block</code>æŠ›å‡ºçš„å¼‚å¸¸çš„æ‰€æœ‰åŸºæœ¬å—ã€‚è¡¨ç¤ºæ–¹æ³•çš„å¼‚å¸¸æ§åˆ¶æµã€‚</li></ul><p>æˆ‘ä»¬è¿˜æä¾›äº†ç”¨äºå¯è§†åŒ–JcGraphå’ŒJcBlockGraphçš„APIï¼š</p><ul><li><code>JcGraph.view(dotCmd: String, viewerCmd: String, viewCatchConnections: Boolean = false)</code> â€” ä½¿ç”¨DOTç”ŸæˆSVGæ–‡ä»¶ï¼ˆdotCmdéœ€è¦æŒ‡å®šDOTå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼‰ï¼Œå¹¶ä½¿ç”¨viewerCmdç¨‹åºï¼ˆæŒ‡å®šæµè§ˆå™¨å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æŸ¥çœ‹ã€‚viewCatchConnectionsæ ‡å¿—å®šä¹‰æ˜¯å¦åœ¨å›¾ä¸­æ˜¾ç¤ºthrow...catchè¿æ¥ã€‚</li><li><code>JcBlockGraph.view(dotCmd: String, viewerCmd: String)</code> â€” ç±»ä¼¼ï¼Œä½†æ˜¾ç¤ºJcBlockGraphã€‚</li></ul><p>CFG APIåœ¨JcInstæŒ‡ä»¤ä¸Šæ“ä½œã€‚JcInstä¸JcRawInstç›¸ä¼¼ï¼Œä½†æœ‰ä¸€äº›å°çš„å·®å¼‚ã€‚ä¸»è¦åŒºåˆ«åœ¨äºJcInstä½¿ç”¨JcTypeå®ä¾‹æ¥è¡¨ç¤ºç±»å‹ã€‚å¦ä¸€ä¸ªåŒºåˆ«æ˜¯JcInstä¸éœ€è¦æ ‡ç­¾æ¥è¡¨ç¤ºæŒ‡ä»¤ä¹‹é—´çš„è¿æ¥ï¼ˆå› ä¸ºå®ƒä»¬å­˜å‚¨åœ¨JcGraphä¸­ï¼‰ã€‚åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼ŒJcInstå±‚æ¬¡ç»“æ„ï¼ˆåŒ…æ‹¬JcExprå’ŒJcValueï¼‰ä¸JcRawInstå±‚æ¬¡ç»“æ„ï¼ˆåŒ…æ‹¬JcRawExprå’ŒJcRawValueï¼‰åŸºæœ¬ç›¸åŒã€‚</p><p>å€¼å¾—æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯ï¼ŒJcGraphè¡¨ç¤ºä¸€ä¸ªä¸å¯å˜ç»“æ„ï¼Œå¹¶ä¸”ä¸æä¾›ä¿®æ”¹å®ƒçš„APIã€‚è¿™æ˜¯æœ‰æ„ä¸ºä¹‹çš„ï¼Œå› ä¸ºä¿®æ”¹CFGéœ€è¦ç”¨æˆ·äº†è§£å›¾ä¸­çš„æ‰€æœ‰è¿æ¥ã€‚ç”¨æˆ·åœ¨æ›´æ”¹CFGæ—¶åº”æ­£ç¡®ç®¡ç†è¿™äº›è¿æ¥ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·å§‹ç»ˆå¯ä»¥åˆ›å»ºå¸¦æœ‰æ‰€æœ‰å¿…è¦ä¿®æ”¹çš„æ–°å‰¯æœ¬çš„JcGraphã€‚</p><h2 id="ä¾‹å­-1" tabindex="-1"><a class="header-anchor" href="#ä¾‹å­-1" aria-hidden="true">#</a> ä¾‹å­</h2><p>â€‹ åœ¨<code>StringConcatSimplifier</code>ç±»ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°å¯¹CFGçš„ä¿®æ”¹ç¤ºä¾‹ï¼šå®ƒåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„JcGraphï¼Œå…¶ä¸­æ‰€æœ‰çš„invokedynamicå­—ç¬¦ä¸²è¿æ¥æŒ‡ä»¤éƒ½è¢«æ›¿æ¢ä¸ºç®€å•çš„String.concatæ–¹æ³•è°ƒç”¨ã€‚</p><p>â€‹ <code> ReachingDefinitionsAnalysis</code>ç±»æ˜¯ä½¿ç”¨åŸºæœ¬å—APIçš„ç¤ºä¾‹ã€‚å®ƒä½¿ç”¨ç®€å•çš„å·¥ä½œåˆ—è¡¨ç®—æ³•æ‰§è¡ŒåŸºæœ¬å—çš„æ ‡å‡†åˆ°è¾¾å®šä¹‰åˆ†æã€‚</p><h2 id="visitor-api-1" tabindex="-1"><a class="header-anchor" href="#visitor-api-1" aria-hidden="true">#</a> Visitor API</h2><p>â€‹ è‡³äºä¸‰åœ°å€æŒ‡ä»¤åˆ—è¡¨ï¼Œæˆ‘ä»¬ä¸ºéå†å’Œä¿®æ”¹JcGraphæä¾›äº†è®¿é—®è€…APIã€‚è®¿é—®è€…å…·æœ‰æ ‡å‡†æ¥å£ - å¯ä»¥é€šè¿‡æŒ‡ä»¤å’Œè¡¨è¾¾å¼ä¸Šçš„acceptæ–¹æ³•è°ƒç”¨å®ƒä»¬ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>val a = jcInst.accept(MyInstVisitor())
val b = jcExpr.accept(MyExprVisitor())
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ æˆ‘ä»¬è¿˜æä¾›äº†ç±»ä¼¼&quot;å‡½æ•°å¼&quot;çš„æ‰©å±•ï¼Œç”¨äºå°†è®¿é—®è€…åº”ç”¨äºJcGraphï¼š</p><ul><li>filter(visitor: JcInstVisitor&lt;Boolean&gt;): JcGraph</li><li>filterNot(visitor: JcInstVisitor&lt;Boolean&gt;): JcGraph</li><li>map(visitor: JcInstVisitor&lt;JcInst&gt;): JcGraph</li><li>mapNotNull(visitor: JcInstVisitor&lt;JcInst?&gt;): JcGraph</li><li>flatMap(visitor: JcInstVisitor&lt;Collection&lt;JcInst&gt;&gt;): JcGraph</li><li>apply(visitor: JcInstVisitor&lt;Unit&gt;): JcGraph</li><li>applyAndGet(visitor: T, getter: (T) -&gt; R): R</li><li>collect(visitor: JcInstVisitor&lt;T&gt;): Collection&lt;T&gt;</li></ul><h1 id="ä¸ƒ-é™æ€æ•°æ®æµåˆ†æ" tabindex="-1"><a class="header-anchor" href="#ä¸ƒ-é™æ€æ•°æ®æµåˆ†æ" aria-hidden="true">#</a> ä¸ƒ é™æ€æ•°æ®æµåˆ†æ</h1><h2 id="æ•°æ®æµåˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æµåˆ†æ" aria-hidden="true">#</a> æ•°æ®æµåˆ†æ</h2><p>â€‹ ä½¿ç”¨ jacodb-analysis æ¨¡å—ï¼Œå¯ä»¥åŸºäºä¸‰åœ°å€ç ä¸­é—´è¡¨ç¤ºæ‰§è¡Œé™æ€æ•°æ®æµåˆ†æã€‚å®ƒå®ç°äº† Repsã€Horwitz å’Œ Sagivï¼ˆ1995ï¼‰è®ºæ–‡ä¸­æè¿°çš„ IFDS æ±‚è§£å™¨ã€‚IFDS æ˜¯æŒ‡ç±»åˆ«ä¸º interproceduralï¼ˆè¿‡ç¨‹é—´ï¼‰ã€finiteï¼ˆæœ‰é™ï¼‰ã€distributiveï¼ˆå¯åˆ†é…çš„ï¼‰ã€subsetï¼ˆå­é›†ï¼‰ é—®é¢˜çš„é¦–å­—æ¯ç¼©å†™ã€‚</p><p>â€‹ jacodb-analysis æ¨¡å—ä¸ºæ‚¨æä¾›äº†å¤šä¸ªç°æˆçš„åˆ†æå·¥å…·ï¼ŒåŒæ—¶è¿˜æä¾›äº† API ç”¨äºæ„å»ºæ‚¨è‡ªå·±çš„åˆ†æå·¥å…·ã€‚</p><p>â€‹ <strong>å½“å‰çš„å®ç°å°†ä»£ç åˆ†å‰²ä¸ºå•å…ƒï¼Œä»¥ä¾¿ IFDS æ¡†æ¶å¯ä»¥å¹¶å‘åœ°åˆ†æå®ƒä»¬ã€‚ä¿¡æ¯é€šè¿‡æ‘˜è¦åœ¨å•å…ƒä¹‹é—´å…±äº«ï¼Œä½†æ¯ä¸ªå•å…ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç‹¬ç«‹æ§åˆ¶çš„ã€‚è¿™ä½¿å¾—å®ç°å…·æœ‰é«˜åº¦å¯æ‰©å±•æ€§ä¸”ä»ç„¶ç²¾ç¡®ã€‚</strong></p><h2 id="åŸºæœ¬ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ç”¨æ³•" aria-hidden="true">#</a> åŸºæœ¬ç”¨æ³•</h2><p>â€‹ æ‚¨å¯ä»¥ç›´æ¥ä»æ‚¨çš„ä»£ç ä¸­è¿›è¡Œåˆ†æï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç•Œé¢æ‰§è¡Œã€‚</p><h3 id="ä»£ç ä¸­è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¸­è°ƒç”¨" aria-hidden="true">#</a> ä»£ç ä¸­è°ƒç”¨</h3><p>åˆ†æçš„å…¥å£ç‚¹æ˜¯ AnalysisMain ä¸­å£°æ˜çš„ runAnalysis æ–¹æ³•ã€‚è¯¥æ–¹æ³•æ¥å—ä»¥ä¸‹å‚æ•°ï¼š</p><ul><li><code>graph</code> â€” ç”¨äºåˆ†æçš„åº”ç”¨ç¨‹åºå›¾ï¼Œå³åŸå§‹è®ºæ–‡ä¸­æ‰€ç§°çš„è¶…å›¾ã€‚è¦è·å–æ­¤å›¾ï¼Œåº”è°ƒç”¨ ApplicationGraphFactory ä¸­çš„ newApplicationGraphForAnalysis æ–¹æ³•ã€‚</li><li><code>unitResolver</code> â€” å°†æ–¹æ³•åˆ†ç»„åˆ°å•å…ƒçš„å¯¹è±¡ã€‚äº†è§£æœ‰å…³å•å…ƒè§£æå™¨çš„æ›´å¤šä¿¡æ¯ã€‚</li><li><code>ifdsUnitRunner</code> â€” ç”¨äºåˆ†ææ¯ä¸ªå•å…ƒçš„è¿è¡Œå®ä¾‹ã€‚è¿™æ˜¯å®šä¹‰å…·ä½“åˆ†æçš„éƒ¨åˆ†ã€‚ç°æˆçš„è¿è¡Œå®ä¾‹ä½äº RunnersLibrary ä¸­ã€‚</li><li><code>methods</code> â€” è¦åˆ†æçš„æ–¹æ³•åˆ—è¡¨ã€‚</li><li><code>timeoutMillis</code> â€” å¯é€‰çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œè¦æ£€æµ‹ç»™å®š <code>analyzedClass</code> æ–¹æ³•ä¸­æœªä½¿ç”¨çš„å˜é‡ï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹ä»£ç ï¼ˆå‡è®¾ <code>classpath</code> æ˜¯ <code>JcClasspath</code> çš„ä¸€ä¸ªå®ä¾‹ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JcMethod</span><span class="token punctuation">&gt;</span></span> methodsToAnalyze <span class="token operator">=</span> analyzedClass<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">JcApplicationGraph</span> applicationGraph <span class="token operator">=</span> <span class="token class-name">ApplicationGraphFactory</span>
        <span class="token punctuation">.</span><span class="token function">asyncNewApplicationGraphForAnalysis</span><span class="token punctuation">(</span>classpath<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">UnitResolver</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> resolver <span class="token operator">=</span> <span class="token class-name">UnitResolversLibrary</span><span class="token punctuation">.</span><span class="token function">getMethodUnitResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">IfdsUnitRunner</span> runner <span class="token operator">=</span> <span class="token class-name">RunnersLibrary</span><span class="token punctuation">.</span><span class="token function">getUnusedVariableRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token class-name">AnalysisMain</span><span class="token punctuation">.</span><span class="token function">runAnalysis</span><span class="token punctuation">(</span>
        applicationGraph<span class="token punctuation">,</span>
        resolver<span class="token punctuation">,</span>
        runner<span class="token punctuation">,</span>
        methodsToAnalyze<span class="token punctuation">,</span>
        <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,178),b=e(`<h3 id="å‘½ä»¤è¡Œç•Œé¢æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#å‘½ä»¤è¡Œç•Œé¢æ–¹å¼" aria-hidden="true">#</a> å‘½ä»¤è¡Œç•Œé¢æ–¹å¼</h3><p>â€‹ è¦æ‰§è¡Œåˆ†æï¼Œå¯ä»¥ä½¿ç”¨ jacodb-cli æ¨¡å—çš„å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰ã€‚è¯·æŒ‡å®šä»¥ä¸‹å‚æ•°ï¼š</p><p>â€‹ --analysisConf, -a â€” åŒ…å«ä»¥ JSON æ ¼å¼æä¾›çš„åˆ†æé…ç½®çš„æ–‡ä»¶è·¯å¾„ï¼ˆè¯¦ç»†æè¿°è§ä¸‹æ–‡ï¼‰ã€‚</p><p>â€‹ --start, -s â€” æŒ‡å®šåˆ†æå¼€å§‹çš„ç±»ã€‚</p><p>â€‹ --classpath, -cp â€” JacoDB åˆ†ææ‰€éœ€çš„ç±»è·¯å¾„ã€‚ [å¯é€‰]</p><p>â€‹ --dbLocation, -l â€” å­˜å‚¨å­—èŠ‚ç æ•°æ®çš„ SQLite æ•°æ®åº“çš„ä½ç½®ã€‚å¦‚æœæœªæŒ‡å®šï¼Œå°†ä¸ä¼šå°†æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ [å¯é€‰]</p><p>â€‹ --output, -o â€” ç”¨äºå­˜å‚¨åˆ†ææŠ¥å‘Šçš„æ–‡ä»¶ã€‚é»˜è®¤ä¸º report.jsonã€‚</p><p>â€‹ åˆ†æé…ç½®æ–‡ä»¶åº”å£°æ˜ä¸€ä¸ª analyses å¯¹è±¡ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜¯åˆ†æçš„åç§°ï¼Œæ¯ä¸ªå€¼æ˜¯ä¸€ä¸ªå…·æœ‰è‡ªå®šä¹‰è®¾ç½®çš„å¯¹è±¡ã€‚å¯¹äºæŒ‡å®šçš„åˆ†æï¼ŒrunAnalysis ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨è®¾ç½®ä¸­ï¼Œæ‚¨åªèƒ½æŒ‡å®š unit resolverï¼Œå®ƒé»˜è®¤ä¸º MethodUnitResolverã€‚</p><p>â€‹ ä¸€ä¸ªé…ç½®æ–‡ä»¶çš„ç¤ºä¾‹ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;analyses&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;NPE&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;Unused&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;UnitResolver&quot;</span><span class="token operator">:</span> <span class="token string">&quot;class&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;SQL&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å•å…ƒè§£æå™¨" tabindex="-1"><a class="header-anchor" href="#å•å…ƒè§£æå™¨" aria-hidden="true">#</a> å•å…ƒè§£æå™¨</h2><p>â€‹ UnitResolver æ˜¯ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œå…·æœ‰å°† JcMethod æ˜ å°„åˆ°è‡ªå®šä¹‰çš„ UnitType é¢†åŸŸçš„ resolve å‡½æ•°ã€‚å®ƒå°†æ‰€æœ‰æ–¹æ³•åˆ†ä¸ºå¯ä»¥å¹¶å‘åˆ†æçš„ç»„æˆ–å•å…ƒã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ›´å¤§çš„å•å…ƒæ„å‘³ç€æ›´ç²¾ç¡®ä½†ä¹Ÿæ›´è€—è´¹èµ„æºçš„åˆ†æï¼Œå› æ­¤ UnitResolver å…è®¸æ‚¨æ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚æ‚¨å¯ä»¥åˆ›å»ºè‡ªå·±çš„ UnitResolverï¼Œä½†é€šå¸¸å¯ä»¥ä½¿ç”¨ UnitResolversLibrary ç±»ä¸­é¢„å®šä¹‰çš„è§£æå™¨ï¼Œä¾‹å¦‚ methodUnitResolver å’Œ singletonUnitResolverã€‚ä»¥ä¸‹æ˜¯é¢„å®šä¹‰è§£æå™¨çš„åˆ—è¡¨ï¼š</p><ul><li><code>methodUnitResolver</code> â€” æ¯ä¸ªå•å…ƒåŒ…å«ç¡®åˆ‡ä¸€ä¸ªæ–¹æ³•ã€‚æ­¤è§£æå™¨æä¾›æœ€å¿«ä½†ä¹Ÿæœ€ä¸ç²¾ç¡®çš„åˆ†æã€‚å¦‚æœæ‚¨è¦åˆ†æå¤§é‡ä»£ç ï¼Œå¦‚å¤§å‹é¡¹ç›®æˆ–åº“ï¼Œè¯·ä½¿ç”¨æ­¤è§£æå™¨ã€‚</li><li><code>classUnitResolver</code> â€” æ¯ä¸ªå•å…ƒå¯¹åº”ä¸€ä¸ªç±»ï¼šä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•å±äºä¸€ä¸ªå•å…ƒã€‚</li><li><code>packageUnitResolver</code> â€” ä¸å‰ä¸€ä¸ªç›¸åŒï¼Œä½†æ¯ä¸ªå•å…ƒå¯¹åº”å®ƒæ‰€å£°æ˜çš„åŒ…ã€‚</li><li><code>singletonUnitResolver</code> â€” æ‰€æœ‰ç°æœ‰æ–¹æ³•éƒ½å±äºåŒä¸€ä¸ªå•å…ƒã€‚ä½¿ç”¨æ­¤è§£æå™¨æä¾›æœ€ç²¾ç¡®ä½†ä¹Ÿæœ€è€—è´¹èµ„æºçš„åˆ†æã€‚å¦‚æœæ‚¨è¦åˆ†æå°‘é‡ä»£ç ï¼Œå¦‚ä¸€ä¸ªç±»æˆ–ä¸€ä¸ªå°é¡¹ç›®ï¼Œè¯·ä½¿ç”¨æ­¤è§£æå™¨ã€‚</li></ul><h2 id="application-graph" tabindex="-1"><a class="header-anchor" href="#application-graph" aria-hidden="true">#</a> Application graph</h2><p>â€‹ åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ JcApplicationGraph å®ä¾‹æä¾›æºä»£ç ä¿¡æ¯ã€‚è¯¥æ¥å£å°†ç¨‹åºçš„<strong>æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰<strong>ä¸</strong>è°ƒç”¨å›¾</strong>ç»“åˆåœ¨ä¸€èµ·ï¼Œä»è€Œæä¾›æ‰€è°“çš„è¶…å›¾ã€‚åˆ›å»ºè¯¥å®ä¾‹çš„æœ€ç®€å•æ–¹å¼æ˜¯ä» ApplicationGraphFactory ä¸­è°ƒç”¨ newApplicationGraphForAnalysisã€‚</p><p>â€‹ å®ƒæœ‰ä¸€ä¸ª <code>bannedPackagePrefixes</code> å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ã€‚å¦‚æœæŸä¸ªæ–¹æ³•å£°æ˜åœ¨ä¸€ä¸ªåŒ…ä¸­ï¼Œå…¶åç§°ä»¥è¿™äº›å­—ç¬¦ä¸²ä¹‹ä¸€å¼€å¤´ï¼Œè¯¥æ–¹æ³•ä¸ä¼šåŒ…å«åœ¨åº”ç”¨ç¨‹åºå›¾ä¸­ï¼Œå› æ­¤ä¹Ÿä¸ä¼šè¢«åˆ†æã€‚å¦‚æœä¼ é€’ nullï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„ <code>defaultBannedPackagePrefixes</code> å€¼ï¼Œè¯¥å€¼ä¼šé˜»æ­¢åˆ†æå¤§å¤šæ•° Java å’Œ Kotlin æ ‡å‡†åº“æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å…è®¸é¢å¤–ç¦ç”¨è‡ªå®šä¹‰åŒ…çš„ä»£ç ç¤ºä¾‹ï¼ˆå‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªä½œä¸º JcClasspath å®ä¾‹åŒ–çš„ç±»è·¯å¾„ï¼‰ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> bannedPackages <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bannedPackages<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">ApplicationGraphFactory</span><span class="token punctuation">.</span><span class="token function">getDefaultBannedPackagePrefixes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bannedPackages<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;my.package.that.wont.be.analyzed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">JcApplicationGraph</span> customGraph <span class="token operator">=</span> <span class="token class-name">ApplicationGraphFactory</span>
    <span class="token punctuation">.</span><span class="token function">asyncNewApplicationGraphForAnalysis</span><span class="token punctuation">(</span>classpath<span class="token punctuation">,</span> bannedPackages<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   
<span class="token comment">// Launch some analysis using customGraph...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="runners-library" tabindex="-1"><a class="header-anchor" href="#runners-library" aria-hidden="true">#</a> <code>Runners</code> library</h2><p>â€‹ ä»¥ä¸‹æ˜¯ä½äº RunnersLibrary ä¸­å®ç°çš„è¿è¡Œå®ä¾‹çš„åˆ—è¡¨ï¼š</p><ol><li><strong>NpeRunner</strong> â€” æŸ¥æ‰¾å¯èƒ½å¯¼è‡´ NullPointerException çš„ä½ç½®ã€‚</li><li><strong>UnusedVariableRunner</strong> â€” æŸ¥æ‰¾å£°æ˜æœªä½¿ç”¨å˜é‡çš„æ‰€æœ‰è¯­å¥ã€‚</li><li><strong>TaintRunner</strong> â€” æä¾›é€šç”¨çš„æ±¡ç‚¹åˆ†æã€‚è¦æ„å»ºå®ƒï¼Œæ‚¨éœ€è¦æä¾› sourceMethodsï¼ˆäº§ç”Ÿæ±¡ç‚¹çš„æ–¹æ³•ï¼‰ï¼ŒsinkMethodsï¼ˆä¸åº”å°†å—æ±¡æŸ“çš„å€¼ä½œä¸ºå‚æ•°æˆ–æ¥æ”¶è€…çš„æ–¹æ³•ï¼‰å’Œ sanitizeMethodsï¼ˆå°†å—æ±¡æŸ“çš„å€¼è½¬æ¢ä¸ºæœªå—æ±¡æŸ“çš„æ–¹æ³•ï¼‰ã€‚å¦‚æœæºå’Œæ±‡ä¹‹é—´å­˜åœ¨è¿½è¸ªï¼ˆæœªç»è¿‡æ¶ˆæ¯’æ–¹æ³•ï¼‰ï¼Œåˆ™æŠ¥å‘Šä¸ºæ¼æ´ã€‚</li><li><strong>SqlInjectionRunner</strong> â€” æ‰§è¡Œå…·ä½“çš„æ±¡ç‚¹åˆ†æï¼ŒæŸ¥æ‰¾å¯èƒ½å‘ç”Ÿ SQL æ³¨å…¥çš„ä½ç½®ã€‚</li></ol><h2 id="writing-custom-runners" tabindex="-1"><a class="header-anchor" href="#writing-custom-runners" aria-hidden="true">#</a> Writing custom runners</h2><p>â€‹ æŒ‡å®šè‡ªå·±çš„åˆ†ææ¯”ä½¿ç”¨é¢„å®šä¹‰çš„åˆ†ææ›´ä¸ºå¤æ‚ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæ‚¨åº”è¯¥ç†Ÿæ‚‰æ•°æ®æµåˆ†æã€IFDS æ¡†æ¶å’Œæµå‡½æ•°ã€‚</p><h3 id="one-pass-runner" tabindex="-1"><a class="header-anchor" href="#one-pass-runner" aria-hidden="true">#</a> One-pass runner</h3><p>â€‹ è¦å®ç°ä¸€ä¸ªç®€å•çš„å•éåˆ†æå™¨ï¼Œè¯·ä½¿ç”¨ IfdsBaseUnitRunnerã€‚ä¸ºäº†å®ä¾‹åŒ–å®ƒï¼Œæ‚¨éœ€è¦ä¸€ä¸ª AnalyzerFactory å®ä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡ JcApplicationGraph åˆ›å»º Analyzer çš„å¯¹è±¡ã€‚Analyzer æ¥å£åŒ…å«å¿…é¡»å®ç°çš„ä»¥ä¸‹æ–¹æ³•ï¼ˆè¯·æ³¨æ„ï¼Œæ­¤æ¥å£æ˜¯å®éªŒæ€§çš„ï¼Œå¯èƒ½ä¼šåœ¨ä¸ä¹…çš„å°†æ¥è¿›è¡Œæ›´æ”¹ï¼‰ï¼š</p><ol><li><code>getFlowFunctions()</code> â€” åº”è¯¥è¿”å›ä¸€ä¸ªæè¿°å››ç§æµå‡½æ•°çš„ FlowFunctionsSpace å¯¹è±¡ï¼Œå¦‚åŸå§‹è®ºæ–‡ä¸­å®šä¹‰çš„é‚£æ ·ã€‚</li><li><code>List&lt;SummaryFact&gt; getSummaryFacts(IfdsEdge edge)</code> â€” æ¯æ¬¡æ‰¾åˆ°æ–°çš„è·¯å¾„è¾¹ç¼˜æ—¶ï¼ŒIfdsBaseUnitRunner å°†è°ƒç”¨æ­¤æ–¹æ³•ã€‚è¯¥æ–¹æ³•åº”è¿”å›ç”±æ­¤è¾¹ç¼˜äº§ç”Ÿçš„æ‰€æœ‰ SummaryFact å…ƒç´ ã€‚å¦‚æœæ£€æµ‹åˆ°æŸäº›æ¼æ´ï¼Œåˆ™åº”å°†å…¶ä½œä¸º VulnerabilityLocation è¿”å›ã€‚å½“åˆ†æå®Œæˆæ—¶ï¼Œå°†è§£ææ­¤ä½ç½®çš„ TraceGraphï¼Œå¹¶å°† VulnerabilityInstance æ·»åŠ åˆ°ç»“æœä¸­ã€‚è¿™æ˜¯è¿”å›æ‘˜è¦äº‹å®çš„é¦–é€‰æ–¹æ³•ã€‚</li><li><code>List&lt;SummaryFact&gt; getSummaryFacts(IfdsResults ifdsResults)</code> â€” ä¸ä¸Šè¿°æ–¹æ³•ç›¸åŒï¼Œä½†æ­¤æ–¹æ³•ä»…ç”± IfdsBaseUnitRunner åœ¨äº‹å®ä¼ æ’­å®Œæˆï¼ˆæ­£å¸¸æˆ–ç”±äºå–æ¶ˆè€Œå®Œæˆï¼‰æ—¶è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒä¸åº”è¿”å›å·²ç”±å‰ä¸€æ–¹æ³•è¿”å›çš„äº‹å®ã€‚</li><li><code>getSaveSummaryEdgesAndCrossUnitCalls()</code> â€” å½“ä¸º true æ—¶ï¼Œå°†è‡ªåŠ¨å°†æ‘˜è¦è¾¹å’Œ CrossUnitCalleeFact å…ƒç´ æ·»åŠ åˆ°æ‘˜è¦ä¸­ã€‚è¿™å¯¹äºå‰å‘åˆ†æä»¥æé«˜ç²¾åº¦å’Œè¿˜åŸè·Ÿè¸ªæ˜¯å¿…è¦çš„ï¼Œä½†å¯¹äºåå‘åˆ†æé€šå¸¸å¯ä»¥å°†å…¶è®¾ç½®ä¸º falseã€‚</li></ol><h3 id="composite-runners" tabindex="-1"><a class="header-anchor" href="#composite-runners" aria-hidden="true">#</a> Composite runners</h3><p>â€‹ ä¸ºäº†è·å¾—æ›´é«˜çš„ç²¾åº¦ï¼Œé€šå¸¸æ‰§è¡ŒåŒå‘åˆ†æã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä¸Šè¿°è¯´æ˜åˆ›å»ºåå‘å’Œå‰å‘è¿è¡Œå™¨ï¼Œå¹¶ä½¿ç”¨ç°æœ‰çš„å¤åˆè¿è¡Œå™¨ä¹‹ä¸€å°†å®ƒä»¬è¿æ¥èµ·æ¥ï¼š</p><ol><li><strong>SequentialBidiIfdsUnitRunner</strong> â€” æ¥å—ä¸¤ä¸ªè¿è¡Œå™¨ï¼Œå³å‰å‘å’Œåå‘è¿è¡Œå™¨ï¼Œå¹¶æŒ‰é¡ºåºè¿è¡Œå®ƒä»¬ï¼šé¦–å…ˆåœ¨åè½¬çš„å›¾ä¸Šè¿è¡Œåå‘åˆ†æï¼Œç„¶ååœ¨æ­£å¸¸çš„å›¾ä¸Šè¿è¡Œå‰å‘åˆ†æã€‚</li><li><strong>ParallelBidiIfdsUnitRunner</strong> â€” ä¸å‰ä¸€ä¸ªç›¸åŒï¼Œä½†åŒæ—¶å¯åŠ¨ä¸¤ä¸ªè¿è¡Œå™¨ã€‚</li></ol><h1 id="å…«-è¿ç§»" tabindex="-1"><a class="header-anchor" href="#å…«-è¿ç§»" aria-hidden="true">#</a> å…« è¿ç§»</h1><h2 id="å¦‚ä½•ä»sootè¿ç§»è¿‡æ¥" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•ä»sootè¿ç§»è¿‡æ¥" aria-hidden="true">#</a> å¦‚ä½•ä»sootè¿ç§»è¿‡æ¥</h2><h3 id="æœ¯è¯­" tabindex="-1"><a class="header-anchor" href="#æœ¯è¯­" aria-hidden="true">#</a> æœ¯è¯­</h3>`,31),g=n("thead",null,[n("tr",null,[n("th",null,"Term"),n("th",null,"Soot"),n("th",null,"JacoDB")])],-1),f={href:"https://jacodb.org/documentation/migration/#create-storage",target:"_blank",rel:"noopener noreferrer"},y=n("td",null,"-",-1),x=n("td",null,"JacoDB",-1),J={href:"https://jacodb.org/documentation/migration/#create-storage",target:"_blank",rel:"noopener noreferrer"},w=n("td",null,"Scene",-1),_=n("td",null,"JcClasspath",-1),j={href:"https://jacodb.org/documentation/migration/#find-class",target:"_blank",rel:"noopener noreferrer"},I=n("td",null,"SootClass",-1),S=n("td",null,"JcClassOrInterface",-1),B=n("tr",null,[n("td",null,"class method"),n("td",null,"SootMethod"),n("td",null,"JcMethod")],-1),C=n("tr",null,[n("td",null,"class field"),n("td",null,"SootField"),n("td",null,"JcField")],-1),R=n("tr",null,[n("td",null,"type (with generic substitution)"),n("td",null,"-"),n("td",null,"JcJvmType")],-1),A={href:"https://jacodb.org/documentation/migration/#get-3-address-bytecode-representation",target:"_blank",rel:"noopener noreferrer"},E=n("td",null,"JimpleBody",-1),L=n("td",null,"JcRawInstList",-1),q={href:"https://jacodb.org/documentation/migration/#get-control-flow-graph",target:"_blank",rel:"noopener noreferrer"},T=n("td",null,"ClassicCompleteUnitGraph",-1),O=n("td",null,"JcGraph",-1),M={href:"https://jacodb.org/documentation/migration/#get-hierarchy",target:"_blank",rel:"noopener noreferrer"},D=n("td",null,"Hierarchy",-1),U=n("td",null,"HierarchyExt",-1),G={href:"https://jacodb.org/documentation/migration/#get-call-graphusages",target:"_blank",rel:"noopener noreferrer"},F=n("td",null,"CallGraph",-1),P=n("td",null,"UsagesExt",-1),N=e(`<p>Inst = Instruction = æŒ‡ä»¤</p><h3 id="å»ºè®®" tabindex="-1"><a class="header-anchor" href="#å»ºè®®" aria-hidden="true">#</a> å»ºè®®</h3><ul><li>è®°å¾—å…³é—­èµ„æºï¼šJcClasspathã€JacoDBã€‚åˆ›å»ºç±»è·¯å¾„æ˜¯ä¸€ä¸ªæ¶‰åŠ I/O æ“ä½œçš„ç¹é‡è¿‡ç¨‹ã€‚æ‰€æœ‰ä¼ é€’ç»™ç±»è·¯å¾„çš„ JAR æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹éƒ½ä¼šè¢«æ£€æŸ¥ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥ï¼š <ul><li>å®ƒä»¬æ˜¯å¦å·²ç»è¢«å¤„ç†è¿‡ï¼Œ</li><li>å®ƒä»¬æ˜¯å¦è‡ªä¸Šæ¬¡å¤„ç†ä»¥æ¥å‘ç”Ÿäº†å˜åŒ–ï¼Œ</li><li>å®ƒä»¬æ˜¯å¦æ­£åœ¨è¢«å¤„ç†ï¼Œå› ä¸ºå®ƒä»¬ä¹‹å‰å°šæœªè¢«å¤„ç†ã€‚å› æ­¤ï¼Œä»£ç åº”è¯¥å°½é‡é‡å¤ä½¿ç”¨ç±»è·¯å¾„å®ä¾‹ã€‚ä¹‹åï¼Œæˆ‘ä»¬å»ºè®®è°ƒç”¨ close æ–¹æ³•ï¼Œå› ä¸º JacoDB èƒ½å¤Ÿåˆ é™¤å·²å¤„ç†çš„èµ„æºï¼Œè¿™äº›èµ„æºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä¼¼ä¹å·²ç»è¿‡æ—¶ã€‚</li></ul></li><li>å¦‚æœä»£ç å¯èƒ½è°ƒç”¨ç±»å±‚æ¬¡ç»“æ„ï¼Œè¯·æœ€å¥½è®¾ç½® InMemoryHierarchy åŠŸèƒ½ã€‚</li><li>å¦‚æœä»£ç åº“è¶³å¤Ÿåºå¤§æˆ–è€…åœ¨è¿›ç¨‹é‡æ–°å¯åŠ¨æ—¶å­˜æ´»æ˜¯å¯èƒ½çš„è¯ï¼Œå¯ä»¥åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨æŒä¹…åŒ–æ•°æ®ã€‚</li><li>ä»…å®‰è£…å¯¹äºæ­¤æ•°æ®åº“è€Œè¨€æ˜¯å¿…éœ€çš„é‚£äº›åŠŸèƒ½ã€‚</li></ul><h3 id="operations" tabindex="-1"><a class="header-anchor" href="#operations" aria-hidden="true">#</a> Operations</h3><h4 id="create-storage" tabindex="-1"><a class="header-anchor" href="#create-storage" aria-hidden="true">#</a> Create storage</h4><p>SOOT</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// points to specific runtime version</span>
<span class="token class-name">G</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">initJdk</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">G<span class="token punctuation">.</span>JreInfo</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> version<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Options</span> options <span class="token operator">=</span> <span class="token class-name">Options</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
options<span class="token punctuation">.</span><span class="token function">set_soot_classpath</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Scene</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadNecessaryClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PackManager</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">runPacks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>jacodb(java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// points to specific runtime version</span>
    <span class="token punctuation">.</span><span class="token function">useJavaRuntime</span><span class="token punctuation">(</span>runtimeFolder<span class="token punctuation">)</span>
    <span class="token comment">// jars to process</span>
    <span class="token punctuation">.</span><span class="token function">loadByteCode</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>jar1<span class="token punctuation">,</span> jar2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// persist all information to improve performance between restarts</span>
    <span class="token punctuation">.</span><span class="token function">persistent</span><span class="token punctuation">(</span><span class="token string">&quot;/home/user/jcdb.db&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> classpath <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">asyncClasspath</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span>jar1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>jacodb(kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> db <span class="token operator">=</span> jacodb <span class="token punctuation">{</span>
    <span class="token comment">// points to specific runtime version</span>
    <span class="token function">useJavaRuntime</span><span class="token punctuation">(</span>runtimeFolder<span class="token punctuation">)</span>
    <span class="token comment">// jars to process</span>
    <span class="token function">loadByteCode</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span>jar1<span class="token punctuation">,</span> jar2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// persist all information to improve performance between restarts</span>
    <span class="token function">persistent</span><span class="token punctuation">(</span>location <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;/home/user/jcdb.db&quot;</span></span><span class="token punctuation">,</span> clearOnStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">val</span> classpath <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">classpath</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span>jar1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="find-class" tabindex="-1"><a class="header-anchor" href="#find-class" aria-hidden="true">#</a> Find class</h4><p>Soot</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">SootClass</span> clazz <span class="token operator">=</span> <span class="token class-name">Scene</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSootClass</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>JacoDB(Java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> clazz <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">findClassOrNull</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>JacoDB(Kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> clazz <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">findClassOrNull</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;java.lang.String&quot;</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="get-3-address-bytecode-representation" tabindex="-1"><a class="header-anchor" href="#get-3-address-bytecode-representation" aria-hidden="true">#</a> Get 3-address bytecode representation</h4><p>Soot</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">SootClass</span> clazz <span class="token operator">=</span> <span class="token class-name">Scene</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSootClass</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
clazz<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">&quot;length&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Lists</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">retrieveActiveBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>JacoDB(java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> clazz <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">findClassOrNull</span><span class="token punctuation">(</span><span class="token string">&quot;java.lang.String&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">JcClasses</span><span class="token punctuation">.</span><span class="token function">findDeclaredMethodOrNull</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> <span class="token string">&quot;length&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInstructionList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ <span style="color:red;">å®é™…ä½¿ç”¨æ²¡æœ‰â€œgetInstructionListâ€è¿™ä¸ªæ–¹æ³•ï¼Œæœ‰å‡½æ•°â€œgetInstListâ€æ–¹æ³•ã€‚</span></p><p>JacoDB(Kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> clazz <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">findClass</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;java.lang.String&quot;</span></span><span class="token punctuation">)</span>
classpath<span class="token punctuation">.</span><span class="token function">findMethodOrNull</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;length&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>instructionList
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="get-control-flow-graph" tabindex="-1"><a class="header-anchor" href="#get-control-flow-graph" aria-hidden="true">#</a> Get control flow graph</h4><p>Soot</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">new</span> <span class="token class-name">ClassicCompleteUnitGraph</span><span class="token punctuation">(</span>sootMethod<span class="token punctuation">.</span><span class="token function">getActiveBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>JacoDB(Java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> cfg <span class="token operator">=</span> jcMethod<span class="token punctuation">.</span><span class="token function">flowGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>JacoDB(Kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> cfg <span class="token operator">=</span> jcMethod<span class="token punctuation">.</span><span class="token function">flowGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="get-hierarchy" tabindex="-1"><a class="header-anchor" href="#get-hierarchy" aria-hidden="true">#</a> Get hierarchy</h4><p>Soot</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Hierarchy</span> h <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hierarchy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
h<span class="token punctuation">.</span><span class="token function">getDirectSubclassesOf</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
h<span class="token punctuation">.</span><span class="token function">getDirectSubinterfacesOf</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JacoDB(Java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">(</span><span class="token class-name">InMemoryHierarchy</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
val ext <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">asyncHierarchy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ext<span class="token punctuation">.</span><span class="token function">findSubClasses</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> allHierarchy <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findOverrides</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JacoDB(Kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> db <span class="token operator">=</span> jacodb <span class="token punctuation">{</span>
    <span class="token comment">// highly recommend to install this extension</span>
    <span class="token function">install</span><span class="token punctuation">(</span>InMemoryHierarchy<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">val</span> ext <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">hierarchyExt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findSubClasses</span><span class="token punctuation">(</span>clazz<span class="token punctuation">,</span> allHierarchy <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findOverrides</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="get-callgraph-usages" tabindex="-1"><a class="header-anchor" href="#get-callgraph-usages" aria-hidden="true">#</a> Get <code>CallGraph</code>/<code>Usages</code></h4><p>Soot</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">CallGraph</span> cg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CallGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cg<span class="token punctuation">.</span><span class="token function">edgesInto</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">;</span>
cg<span class="token punctuation">.</span><span class="token function">edgesOutOf</span><span class="token punctuation">(</span>edge<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JacoDB(Java)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token class-name">JacoDB</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JcSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// highly recommend to install InMemoryHierarchy extension</span>
    <span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">(</span><span class="token class-name">InMemoryHierarchy</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">,</span> <span class="token class-name">Usages</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ext <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">asyncUsages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> <span class="token class-name">FieldUsageMode</span><span class="token punctuation">.</span><span class="token constant">READ</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> <span class="token class-name">FieldUsageMode</span><span class="token punctuation">.</span><span class="token constant">WRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JacoDB(Kotlin)</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> db <span class="token operator">=</span> jacodb <span class="token punctuation">{</span>
    <span class="token comment">// highly recommend to install InMemoryHierarchy extension</span>
    <span class="token function">install</span><span class="token punctuation">(</span>Usages<span class="token punctuation">,</span> InMemoryHierarchy<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">val</span> ext <span class="token operator">=</span> classpath<span class="token punctuation">.</span><span class="token function">usagesExt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> FieldUsageMode<span class="token punctuation">.</span>READ<span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>field<span class="token punctuation">,</span> FieldUsageMode<span class="token punctuation">.</span>WRITE<span class="token punctuation">)</span>
ext<span class="token punctuation">.</span><span class="token function">findUsages</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="ä¹-api" tabindex="-1"><a class="header-anchor" href="#ä¹-api" aria-hidden="true">#</a> ä¹ API</h1><p>https://jacodb.org/docs/index.html</p><h1 id="å-ç”¨æ³•ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#å-ç”¨æ³•ç¤ºä¾‹" aria-hidden="true">#</a> å ç”¨æ³•ç¤ºä¾‹</h1><h2 id="ç±»å‹æ±‚è§£" tabindex="-1"><a class="header-anchor" href="#ç±»å‹æ±‚è§£" aria-hidden="true">#</a> ç±»å‹æ±‚è§£</h2><h3 id="æµ‹è¯•ç±»å‹æ±‚è§£å™¨" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•ç±»å‹æ±‚è§£å™¨" aria-hidden="true">#</a> æµ‹è¯•ç±»å‹æ±‚è§£å™¨</h3><p>é¡¹ç›®ä»“åº“çš„é“¾æ¥å°†ç¨åæ·»åŠ ï¼Œå› ä¸ºé¡¹ç›®æœ¬èº«å°šæœªå®£å¸ƒã€‚</p><h3 id="ç”¨ä¾‹" tabindex="-1"><a class="header-anchor" href="#ç”¨ä¾‹" aria-hidden="true">#</a> ç”¨ä¾‹</h3><p>â€‹ ä¸€ç§åŸºäºç¬¦å·æ‰§è¡Œçš„å¤šç”¨é€”å·¥å…·å°†è§£å†³ç±»å‹çº¦æŸä½œä¸ºå…¶æ ¸å¿ƒç®—æ³•çš„ä¸€éƒ¨åˆ†ã€‚é€šå¸¸ï¼Œè¿™ä¸ªä»»åŠ¡éœ€è¦SMTæ±‚è§£ï¼Œè€Œè¿™æ˜¯ç›¸å½“è€—æ—¶çš„ã€‚ä¸ºäº†ä½¿å·¥å…·æ›´å¿«è¿è¡Œï¼Œåº”è¯¥å®ç°ä¸€ä¸ªç‹¬ç«‹çš„TypeSolverï¼Œå¯¹äºè¿™ä¸ªä»»åŠ¡ä¸æ¶‰åŠSMTæ±‚è§£ã€‚</p><p>â€‹ ä¸ºäº†æµ‹è¯•TypeSolverï¼Œåº”è¯¥æä¾›å…³äºç±»ã€å®ƒä»¬çš„çˆ¶ç±»ã€å®ç°çš„æ¥å£ã€ç±»å‹å‚æ•°å’Œæ–¹æ³•çš„ä¿¡æ¯ï¼Œä»¥ä¾¿TypeSolverèƒ½å¤Ÿæ‰¾åˆ°é€‚å½“çš„ç±»å‹ã€‚</p><p>â€‹ ä½¿ç”¨ JacoDBï¼Œæ‚¨å¯ä»¥è½»æ¾è·å–è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="å®ç°" tabindex="-1"><a class="header-anchor" href="#å®ç°" aria-hidden="true">#</a> å®ç°</h3><p>TODO</p><h2 id="è¿‘ä¼¼" tabindex="-1"><a class="header-anchor" href="#è¿‘ä¼¼" aria-hidden="true">#</a> è¿‘ä¼¼</h2><h3 id="å®ç°è¿‘ä¼¼" tabindex="-1"><a class="header-anchor" href="#å®ç°è¿‘ä¼¼" aria-hidden="true">#</a> å®ç°è¿‘ä¼¼</h3><p>â€‹ é¡¹ç›®ä»“åº“çš„é“¾æ¥å°†ç¨åæ·»åŠ ï¼Œå› ä¸ºè¯¥é¡¹ç›®å°šæœªå®£å¸ƒã€‚</p><h3 id="ç”¨ä¾‹-1" tabindex="-1"><a class="header-anchor" href="#ç”¨ä¾‹-1" aria-hidden="true">#</a> ç”¨ä¾‹</h3><p>â€‹ å®é™…ä»£ç ä¸­çš„è®¸å¤šè¿‡ç¨‹éƒ½ç»è¿‡äº†ä¼˜åŒ–ï¼šè¿™äº›ä¼˜åŒ–åœ¨å®é™…æ‰§è¡Œæ—¶æœ‰åŠ©äºæ€§èƒ½ï¼Œä½†ä¼šå¦¨ç¢ç¨‹åºåˆ†æã€‚è¿‘ä¼¼æ–¹æ³•ç”¨â€œæ¨¡æ‹Ÿâ€æ›¿ä»£å®é™…çš„æ–¹æ³•å®ç°ï¼Œè¿™äº›æ¨¡æ‹Ÿè¿”å›æ‰€éœ€çš„å€¼åŒæ—¶ä¸ºæˆ‘ä»¬æä¾›æ‰€éœ€ç±»å‹çš„å®ç°ã€‚</p><p>â€‹ ä¾‹å¦‚ï¼Œå¯¹äºåŸºäºç¬¦å·æ‰§è¡Œçš„å¤šç”¨é€”å·¥å…·ï¼Œé‡è¦çš„æ˜¯è¿‘ä¼¼æŸäº›æ–¹æ³•ï¼š</p><ul><li>è¿‘ä¼¼æœ‰åŠ©äºç®€åŒ–æ–¹æ³•å®ç°ï¼Œè¿™äº›å®ç°å¯¹äºåŸºäºç¬¦å·æ‰§è¡Œçš„åˆ†ææ¥è¯´è¿‡äºå¤æ‚ã€‚</li><li>æ ‡å‡†åº“ä¸­çš„æœ¬åœ°æ–¹æ³•æœ‰æ—¶å¯èƒ½æ ¹æœ¬æ²¡æœ‰å®ç°ã€‚è¿‘ä¼¼æ–¹æ³•å…è®¸æˆ‘ä»¬ä¸ºè¿™ç±»æ–¹æ³•â€œç¼–å†™æºä»£ç â€ã€‚</li></ul><h3 id="å®ç°-1" tabindex="-1"><a class="header-anchor" href="#å®ç°-1" aria-hidden="true">#</a> å®ç°</h3><p>TODO</p><h2 id="ç¬¦å·æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#ç¬¦å·æ‰§è¡Œ" aria-hidden="true">#</a> ç¬¦å·æ‰§è¡Œ</h2><h3 id="åˆ›å»ºä¸€ä¸ªç”¨äº-jvm-å­—èŠ‚ç çš„ç¬¦å·åˆ†æå™¨" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºä¸€ä¸ªç”¨äº-jvm-å­—èŠ‚ç çš„ç¬¦å·åˆ†æå™¨" aria-hidden="true">#</a> åˆ›å»ºä¸€ä¸ªç”¨äº JVM å­—èŠ‚ç çš„ç¬¦å·åˆ†æå™¨</h3><p>é¡¹ç›®ä»“åº“çš„é“¾æ¥å°†ç¨åæ·»åŠ ï¼Œå› ä¸ºè¯¥é¡¹ç›®å°šæœªå®£å¸ƒã€‚</p><h3 id="ç”¨ä¾‹-2" tabindex="-1"><a class="header-anchor" href="#ç”¨ä¾‹-2" aria-hidden="true">#</a> ç”¨ä¾‹</h3><p>â€‹ è¦å¼€å‘ä¸€ä¸ªç”¨äº JVM å­—èŠ‚ç çš„ç¬¦å·åˆ†æå™¨ï¼Œéœ€è¦è·å–ç¨‹åºä¸­æ¯ä¸ªæ–¹æ³•çš„ä¸‰åœ°å€ç ä¸­é—´è¡¨ç¤ºï¼ˆ3-address code IRï¼‰ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ JacoDB å’Œ KSMT åº“å®ç°çš„æ–¹æ³•ï¼š</p><h3 id="å®ç°-2" tabindex="-1"><a class="header-anchor" href="#å®ç°-2" aria-hidden="true">#</a> å®ç°</h3><p>â€‹ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è·å–æ–¹æ³•çš„ä¸‰åœ°å€ç ä¸­é—´è¡¨ç¤ºï¼ˆ3-address code IRï¼‰ã€‚JacoDBå…·æœ‰ç±»ä¼¼äº Jimple çš„è‡ªå·±çš„ä¸‰åœ°å€ç ä¸­é—´è¡¨ç¤ºã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>val jcClass = TODO(&quot;obtain target class somehow&quot;)
val method = jcClass.declaredMethods.first { it.name == TODO(&quot;Target method name&quot;) }
val instList = method.instList // 3-address IR
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¬¦å·çŠ¶æ€ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>data class State(
    val path: List&lt;JcInst&gt;, // Execution path
    val memory: Map&lt;String, KExpr&lt;out KSort&gt;&gt;, // Symbolic memory
    val pathCondition: List&lt;KExpr&lt;KBoolSort&gt;&gt;, // Path condition
)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ è¦è§£é‡Šç¬¦å·çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦è·å–è·¯å¾„ä¸­çš„æœ€åä¸€æ¡æŒ‡ä»¤ï¼Œå¹¶æ ¹æ®å…¶ç±»å‹è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>fun interpret(state: State): Collection&lt;State&gt; {
    // 0. Get the last instruction in the path
    val inst = state.path.last()
    // 1. Process the last instruction symbolically
    return when (inst) {
        is JcAssignInst -&gt; interpretAssignInst(state, inst) // Assign instruction, i.e. n = i + 42;
        is JcIfInst -&gt; interpretIfStmt(state, inst) // Branching instruction, i.e. if (n == 101)
        else -&gt; TODO(&quot;Process other instructions as well&quot;)
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ ä¾‹å¦‚ï¼Œè¦å¤„ç†èµ‹å€¼è¯­å¥ï¼Œæˆ‘ä»¬éœ€è¦è§£æèµ‹å€¼æŒ‡ä»¤çš„å³æ“ä½œæ•°ï¼ˆç¬¦å·è¡¨è¾¾å¼ï¼‰å’Œèµ‹å€¼æ“ä½œçš„å·¦æ“ä½œæ•°ï¼ˆå†…å­˜ä½ç½®ï¼‰ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>private fun interpretAssignInst(state: State, inst: JcAssignInst): Collection&lt;State&gt; {
    // 0. We need to resolve symbolic expression from [inst.rhv]
    val expr = resolveExpr(state, inst.rhv)

    // 1. We need to write the [expr] to the symbolic memory
    val nextState = when (val lhv = inst.lhv) {
        is JcLocalVar -&gt; {
            // find the next instruction
            val nextInst = inst.location.method.instList[inst.location.lineNumber + 1]
            state.copy(
                // update the symbolic memory with the new write
                memory = state.memory + (lhv.name to expr),
                // update the execution path
                path = state.path + nextInst
            )
        }

        else -&gt; TODO(&quot;Process other JcValues as well&quot;)
    }
    return listOf(nextState)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ è§£æ JcExpr æ˜¯ç›´æˆªäº†å½“çš„ã€‚æˆ‘ä»¬æ ¹æ®è¡¨è¾¾å¼ç±»å‹åŒ¹é…ï¼Œå¹¶ä½¿ç”¨ KSMT æ„å»ºå‡½æ•°ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>private fun resolveExpr(state: State, expr: JcExpr): KExpr&lt;out KSort&gt; =
    when (expr) {
        is JcAddExpr -&gt; {
            // resolve the left operand recursively
            val leftOperand = resolveExpr(state, expr.lhv) as KExpr&lt;KBvSort&gt;
            // resolve the right operand recursively
            val rightOperand = resolveExpr(state, expr.rhv) as KExpr&lt;KBvSort&gt;
            // make a symbolic add expression with KSMT builder functions
            leftOperand.ctx.mkBvAddExpr(leftOperand, rightOperand)
        }

        // resolve an int constant
        is JcInt -&gt; ctx.mkBv(expr.value, 32U)

        is JcEqExpr -&gt; {
            // resolve the left operand recursively
            val leftOperand = resolveExpr(state, expr.lhv)
            // resolve the right operand recursively
            val rightOperand = resolveExpr(state, expr.rhv)
            // make a symbolic eq expression with KSMT builder functions
            when (leftOperand.sort) {
                // both operands of the boolean sort
                is KBoolSort -&gt; leftOperand.ctx.mkEq(
                    leftOperand as KExpr&lt;KBoolSort&gt;,
                    rightOperand as KExpr&lt;KBoolSort&gt;
                )
                // both operands of the bv sort
                is KBoolSort -&gt; leftOperand.ctx.mkEq(
                    leftOperand as KExpr&lt;KBvSort&gt;,
                    rightOperand as KExpr&lt;KBvSort&gt;
                )

                else -&gt; TODO(&quot;Process other sorts as well&quot;)
            }
        }

        is JcLocalVar -&gt; state.memory.getValue(expr.name) // get the variable from the current symbolic memory
        else -&gt; TODO(&quot;Process other JcExprs as well&quot;)
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ è¦å¤„ç†åˆ†æ”¯æŒ‡ä»¤ï¼Œæˆ‘ä»¬éœ€è¦è§£æä¸€ä¸ªç¬¦å·æ¡ä»¶å¹¶ä½¿ç”¨æ±‚è§£å™¨æ£€æŸ¥æ¡ä»¶å’Œ!æ¡ä»¶ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>private fun interpretIfStmt(state: State, inst: JcIfInst): Collection&lt;State&gt; {
    val nextStates = mutableListOf&lt;State&gt;()

    // 0. We need to resolve symbolic condition, which should be of the boolean sort
    val expr = resolveExpr(state, inst.condition) as KExpr&lt;KBoolSort&gt;

    // 1. Resolve the positive branch
    val positivePathCondition = state.pathCondition + expr
    // 1.0. Check for satisfiability
    if (solver.check(positivePathCondition)) {
        // 1.1. Find the positive instruction
        val positiveInst = inst.location.method.instList[inst.trueBranch.index]
        // 1.2. Add the instruction to the path
        val positivePath = state.path + positiveInst
        // 1.3. Add the positive state to the result list
        val positiveState = state.copy(path = positivePath, pathCondition = positivePathCondition)
        nextStates += positiveState
    }

    // 2. Resolve the negative branch
    val negativePathCondition = state.pathCondition + expr.run { ctx.mkNot(this) }
    // 1.0. Check for satisfiability
    if (solver.check(negativePathCondition)) {
        // 2.1. Find the negative instruction
        val negativeInst = inst.location.method.instList[inst.falseBranch.index]
        // 2.2. Add the instruction to the path
        val negativePath = state.path + negativeInst
        // 2.3. Add the negative state to the result list
        val negativeState = state.copy(path = negativePath, pathCondition = negativePathCondition)
        nextStates += negativeState
    }

    // 3. Return the result states
    return nextStates
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®Œæ•´ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>example</span>

<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>ksmt<span class="token punctuation">.</span></span><span class="token class-name">KContext</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>ksmt<span class="token punctuation">.</span>expr<span class="token punctuation">.</span></span><span class="token class-name">KExpr</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>ksmt<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">KBoolSort</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>ksmt<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">KBvSort</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>ksmt<span class="token punctuation">.</span>sort<span class="token punctuation">.</span></span><span class="token class-name">KSort</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">JcMethod</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcAddExpr</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcAssignInst</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcEqExpr</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcExpr</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcIfInst</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcInst</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcInt</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>jacodb<span class="token punctuation">.</span>api<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">JcLocalVar</span>

<span class="token doc-comment comment">/**
 * A data class, representing symbolic state.
 *
 * Let&#39;s assume we use KSMT for storing symbolic expressions.
 */</span>
data <span class="token keyword">class</span> <span class="token class-name">State</span><span class="token punctuation">(</span>
    val path<span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JcInst</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token comment">// Execution path</span>
    val memory<span class="token operator">:</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">KExpr</span><span class="token punctuation">&lt;</span>out <span class="token class-name">KSort</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token comment">// Symbolic memory</span>
    val pathCondition<span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KExpr</span><span class="token punctuation">&lt;</span><span class="token class-name">KBoolSort</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token comment">// Path condition</span>
<span class="token punctuation">)</span>

<span class="token doc-comment comment">/**
 * A solver interface
 */</span>
<span class="token keyword">interface</span> <span class="token class-name">Solver</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * <span class="token keyword">@return</span> true, if [pathCondition] is satisfiable, and false otherwise.
     */</span>
    fun <span class="token function">check</span><span class="token punctuation">(</span>pathCondition<span class="token operator">:</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KExpr</span><span class="token punctuation">&lt;</span><span class="token class-name">KBoolSort</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Boolean</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Analyzer</span><span class="token punctuation">(</span>
    ctx<span class="token operator">:</span> <span class="token class-name">KContext</span><span class="token punctuation">,</span>
    solver<span class="token operator">:</span> <span class="token class-name">Solver</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 0.1. Initialize an interpreter</span>
    <span class="token keyword">private</span> val interpreter <span class="token operator">=</span> <span class="token class-name">Interpreter</span><span class="token punctuation">(</span>solver<span class="token punctuation">,</span> ctx<span class="token punctuation">)</span>

    fun <span class="token function">analyze</span><span class="token punctuation">(</span>method<span class="token operator">:</span> <span class="token class-name">JcMethod</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 1.0. Find the first instruction</span>
        val inst <span class="token operator">=</span> method<span class="token punctuation">.</span>instList<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 1.1. Initialize an initial symbolic state</span>
        val initialState <span class="token operator">=</span> <span class="token class-name">State</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span>inst<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">emptyMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 1.2. Add the initial state to the BFS-order queue</span>
        val queue <span class="token operator">=</span> <span class="token class-name">ArrayDeque</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 2.0. Pop the next state from the queue</span>
            val state <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 2.1 Interpret the state symbolically and obtain next states</span>
            val nextStates <span class="token operator">=</span> interpreter<span class="token punctuation">.</span><span class="token function">interpret</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
            queue<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>nextStates<span class="token punctuation">)</span>
            <span class="token comment">// 2.2. here you can check **interesting** states and do something with them</span>
            <span class="token comment">// your own code</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * An example interpreter.
 */</span>
<span class="token keyword">class</span> <span class="token class-name">Interpreter</span><span class="token punctuation">(</span>
    val solver<span class="token operator">:</span> <span class="token class-name">Solver</span><span class="token punctuation">,</span>
    val ctx<span class="token operator">:</span> <span class="token class-name">KContext</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Takes a [state] and returns the next states.
     */</span>
    fun <span class="token function">interpret</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token class-name">State</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">State</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token comment">// 0. Get the last instruction in the path</span>
        val inst <span class="token operator">=</span> state<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 1. Process the last instruction symbolically</span>
        <span class="token keyword">return</span> when <span class="token punctuation">(</span>inst<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            is <span class="token class-name">JcAssignInst</span> <span class="token operator">-&gt;</span> <span class="token function">interpretAssignInst</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> inst<span class="token punctuation">)</span> <span class="token comment">// Assign instruction, i.e. n = i + 42;</span>
            is <span class="token class-name">JcIfInst</span> <span class="token operator">-&gt;</span> <span class="token function">interpretIfStmt</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> inst<span class="token punctuation">)</span> <span class="token comment">// Branching instruction, i.e. if (n == 101)</span>
            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;Process other instructions as well&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> fun <span class="token function">interpretAssignInst</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token class-name">State</span><span class="token punctuation">,</span> inst<span class="token operator">:</span> <span class="token class-name">JcAssignInst</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">State</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        <span class="token comment">// 0. We need to resolve symbolic expression from [inst.rhv]</span>
        val expr <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> inst<span class="token punctuation">.</span>rhv<span class="token punctuation">)</span>

        <span class="token comment">// 1. We need to write the [expr] to the symbolic memory</span>
        val nextState <span class="token operator">=</span> when <span class="token punctuation">(</span>val lhv <span class="token operator">=</span> inst<span class="token punctuation">.</span>lhv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            is <span class="token class-name">JcLocalVar</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// find the next instruction</span>
                val nextInst <span class="token operator">=</span> inst<span class="token punctuation">.</span>location<span class="token punctuation">.</span>method<span class="token punctuation">.</span>instList<span class="token punctuation">[</span>inst<span class="token punctuation">.</span>location<span class="token punctuation">.</span>lineNumber <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
                state<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>
                    <span class="token comment">// update the symbolic memory with the new write</span>
                    memory <span class="token operator">=</span> state<span class="token punctuation">.</span>memory <span class="token operator">+</span> <span class="token punctuation">(</span>lhv<span class="token punctuation">.</span>name <span class="token keyword">to</span> <span class="token namespace">expr</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token comment">// update the execution path</span>
                    path <span class="token operator">=</span> state<span class="token punctuation">.</span>path <span class="token operator">+</span> nextInst
                <span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;Process other JcValues as well&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">listOf</span><span class="token punctuation">(</span>nextState<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> fun <span class="token function">interpretIfStmt</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token class-name">State</span><span class="token punctuation">,</span> inst<span class="token operator">:</span> <span class="token class-name">JcIfInst</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">State</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
        val nextStates <span class="token operator">=</span> mutableListOf<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">State</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// 0. We need to resolve symbolic condition, which should be of the boolean sort</span>
        val expr <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> inst<span class="token punctuation">.</span>condition<span class="token punctuation">)</span> as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBoolSort</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">// 1. Resolve the positive branch</span>
        val positivePathCondition <span class="token operator">=</span> state<span class="token punctuation">.</span>pathCondition <span class="token operator">+</span> expr
        <span class="token comment">// 1.0. Check for satisfiability</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>solver<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>positivePathCondition<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 1.1. Find the positive instruction</span>
            val positiveInst <span class="token operator">=</span> inst<span class="token punctuation">.</span>location<span class="token punctuation">.</span>method<span class="token punctuation">.</span>instList<span class="token punctuation">[</span>inst<span class="token punctuation">.</span>trueBranch<span class="token punctuation">.</span>index<span class="token punctuation">]</span>
            <span class="token comment">// 1.2. Add the instruction to the path</span>
            val positivePath <span class="token operator">=</span> state<span class="token punctuation">.</span>path <span class="token operator">+</span> positiveInst
            <span class="token comment">// 1.3. Add the positive state to the result list</span>
            val positiveState <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>path <span class="token operator">=</span> positivePath<span class="token punctuation">,</span> pathCondition <span class="token operator">=</span> positivePathCondition<span class="token punctuation">)</span>
            nextStates <span class="token operator">+=</span> positiveState
        <span class="token punctuation">}</span>

        <span class="token comment">// 2. Resolve the negative branch</span>
        val negativePathCondition <span class="token operator">=</span> state<span class="token punctuation">.</span>pathCondition <span class="token operator">+</span> expr<span class="token punctuation">.</span>run <span class="token punctuation">{</span> ctx<span class="token punctuation">.</span><span class="token function">mkNot</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
        <span class="token comment">// 1.0. Check for satisfiability</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>solver<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>negativePathCondition<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 2.1. Find the negative instruction</span>
            val negativeInst <span class="token operator">=</span> inst<span class="token punctuation">.</span>location<span class="token punctuation">.</span>method<span class="token punctuation">.</span>instList<span class="token punctuation">[</span>inst<span class="token punctuation">.</span>falseBranch<span class="token punctuation">.</span>index<span class="token punctuation">]</span>
            <span class="token comment">// 2.2. Add the instruction to the path</span>
            val negativePath <span class="token operator">=</span> state<span class="token punctuation">.</span>path <span class="token operator">+</span> negativeInst
            <span class="token comment">// 2.3. Add the negative state to the result list</span>
            val negativeState <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>path <span class="token operator">=</span> negativePath<span class="token punctuation">,</span> pathCondition <span class="token operator">=</span> negativePathCondition<span class="token punctuation">)</span>
            nextStates <span class="token operator">+=</span> negativeState
        <span class="token punctuation">}</span>

        <span class="token comment">// 3. Return the result states</span>
        <span class="token keyword">return</span> nextStates
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Resolves an [expr] inside of a [state] into symbolic representation [KExpr] of some sort.
     */</span>
    <span class="token keyword">private</span> fun <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token class-name">State</span><span class="token punctuation">,</span> expr<span class="token operator">:</span> <span class="token class-name">JcExpr</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span>out <span class="token class-name">KSort</span><span class="token punctuation">&gt;</span></span> <span class="token operator">=</span>
        when <span class="token punctuation">(</span>expr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            is <span class="token class-name">JcAddExpr</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// resolve the left operand recursively</span>
                val leftOperand <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>lhv<span class="token punctuation">)</span> as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBvSort</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">// resolve the right operand recursively</span>
                val rightOperand <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>rhv<span class="token punctuation">)</span> as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBvSort</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">// make a symbolic add expression with KSMT builder functions</span>
                leftOperand<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">mkBvAddExpr</span><span class="token punctuation">(</span>leftOperand<span class="token punctuation">,</span> rightOperand<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// resolve int constant</span>
            is <span class="token class-name">JcInt</span> <span class="token operator">-&gt;</span> ctx<span class="token punctuation">.</span><span class="token function">mkBv</span><span class="token punctuation">(</span>expr<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">32</span>U<span class="token punctuation">)</span>

            is <span class="token class-name">JcEqExpr</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// resolve the left operand recursively</span>
                val leftOperand <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>lhv<span class="token punctuation">)</span>
                <span class="token comment">// resolve the right operand recursively</span>
                val rightOperand <span class="token operator">=</span> <span class="token function">resolveExpr</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> expr<span class="token punctuation">.</span>rhv<span class="token punctuation">)</span>
                <span class="token comment">// make a symbolic eq expression with KSMT builder functions</span>
                when <span class="token punctuation">(</span>leftOperand<span class="token punctuation">.</span>sort<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// both operands of the boolean sort</span>
                    is <span class="token class-name">KBoolSort</span> <span class="token operator">-&gt;</span> leftOperand<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">mkEq</span><span class="token punctuation">(</span>
                        leftOperand as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBoolSort</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
                        rightOperand as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBoolSort</span><span class="token punctuation">&gt;</span></span>
                    <span class="token punctuation">)</span>
                    <span class="token comment">// both operands of the bv sort</span>
                    is <span class="token class-name">KBoolSort</span> <span class="token operator">-&gt;</span> leftOperand<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">mkEq</span><span class="token punctuation">(</span>
                        leftOperand as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBvSort</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span>
                        rightOperand as <span class="token class-name">KExpr</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">KBvSort</span><span class="token punctuation">&gt;</span></span>
                    <span class="token punctuation">)</span>

                    <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;Process other sorts as well&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            is <span class="token class-name">JcLocalVar</span> <span class="token operator">-&gt;</span> state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>expr<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// get the variable from the current symbolic memory</span>
            <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token string">&quot;Process other JcExprs as well&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="åäºŒ-å…³äº" tabindex="-1"><a class="header-anchor" href="#åäºŒ-å…³äº" aria-hidden="true">#</a> åäºŒ å…³äº</h1><h2 id="å…³äºé¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#å…³äºé¡¹ç›®" aria-hidden="true">#</a> å…³äºé¡¹ç›®</h2><h3 id="ç»´æŠ¤" tabindex="-1"><a class="header-anchor" href="#ç»´æŠ¤" aria-hidden="true">#</a> ç»´æŠ¤</h3><p>â€‹ è¯¥åº“ç”± UnitTestBot ç¤¾åŒºç»´æŠ¤ã€‚</p><h3 id="è´¡çŒ®æŒ‡å¼•" tabindex="-1"><a class="header-anchor" href="#è´¡çŒ®æŒ‡å¼•" aria-hidden="true">#</a> è´¡çŒ®æŒ‡å¼•</h3>`,93),V={href:"https://github.com/UnitTestBot/UTBotJava/blob/main/CONTRIBUTING.md",target:"_blank",rel:"noopener noreferrer"},K=e(`<p>è´¡çŒ®ä»£ç çš„ä¸€èˆ¬æµç¨‹ï¼š</p><ol><li>åˆ›å»ºä½ è‡ªå·±çš„ä»£ç åˆ†æ”¯ï¼ˆforkï¼‰ã€‚</li><li>å°†åˆ†æ”¯åº“å…‹éš†åˆ°æœ¬åœ°æœºå™¨ã€‚</li><li>å®ç°å˜æ›´ã€‚</li><li>æµ‹è¯•ä½ çš„ä»£ç ï¼š <ul><li>åœ¨åˆ›å»ºæ‹‰å–è¯·æ±‚ä¹‹å‰ï¼Œæ‰§è¡Œå¯¹ä½ çš„ä»£ç å˜æ›´è®¤ä¸ºå¿…è¦çš„æµ‹è¯•ã€‚</li><li>å½“å®ç°æ–°åŠŸèƒ½æ—¶ï¼Œæœ€å¥½æ‰¾åˆ°çœŸå®çš„ç”¨æˆ·å¹¶è¯·ä»–ä»¬å°è¯•ä½ çš„åŠŸèƒ½ï¼Œä»¥è¯æ˜ä½ å»ºè®®çš„åŠŸèƒ½çš„å¿…è¦æ€§å’Œè´¨é‡ã€‚</li></ul></li><li>åˆ›å»ºæ‹‰å–è¯·æ±‚ï¼Œä½ å°†åœ¨ GitHub ä¸Šçœ‹åˆ°è‡ªåŠ¨åŒ–æµ‹è¯•æ˜¯å¦é€šè¿‡ã€‚ä½ çš„å®¡æŸ¥è€…å¯èƒ½ä¼šå»ºè®®ä½ è¿›è¡Œæ›´å¤šæµ‹è¯•ã€‚</li><li>è¯·é€‰æ‹© @lehvolk ä½œä¸ºå®¡é˜…è€…ã€‚å¦‚æœæœ‰å¿…è¦ï¼Œä»–ä¼šå°†ä½ çš„æ‹‰å–è¯·æ±‚é‡æ–°åˆ†é…ç»™æ ¸å¿ƒå›¢é˜Ÿçš„å…¶ä»–æˆå‘˜ã€‚æˆ‘ä»¬ä¼šå°½åŠ›è¿›è¡Œå®¡æŸ¥ï¼Œä½†æˆ‘ä»¬å¾ˆéš¾æŒ‡å®šç¡®åˆ‡çš„å®¡æŸ¥æ—¶é—´ã€‚è¯·æ”¾å¿ƒï¼Œæˆ‘ä»¬ä¸€å®šä¼šå›å¤ä½ çš„æ‹‰å–è¯·æ±‚ï¼</li></ol><h2 id="åŸºå‡†æµ‹è¯•" tabindex="-1"><a class="header-anchor" href="#åŸºå‡†æµ‹è¯•" aria-hidden="true">#</a> åŸºå‡†æµ‹è¯•</h2><p>â€‹ åŸºå‡†æµ‹è¯•åœ¨ä¸åŒèŒƒå›´çš„ Java å­—èŠ‚ç ä¸Šè¿è¡Œï¼š</p><ul><li><p><code>runtime</code> â€” ä»…ä½¿ç”¨ Java è¿è¡Œæ—¶ï¼Œæ²¡æœ‰é¢å¤–çš„ä¾èµ–å…³ç³»</p></li><li><p><code>runtime + guava</code> â€” ä½¿ç”¨ä¸€ä¸ª guava çš„ JAR æ–‡ä»¶çš„ Java è¿è¡Œæ—¶</p></li><li><p><code>runtime + project classpath</code> â€” ä½¿ç”¨ JacoDB é¡¹ç›®çš„æ‰€æœ‰å¯è§ä¾èµ–å…³ç³»çš„ Java è¿è¡Œæ—¶</p></li><li><p><code>runtime + Idea community</code> â€” ä½¿ç”¨ IntelliJ IDEA Community é¡¹ç›®çš„æ‰€æœ‰å¯è§ä¾èµ–å…³ç³»çš„ Java è¿è¡Œæ—¶</p><p>JacoDB çš„åŸºå‡†æµ‹è¯•è¿˜åŒ…æ‹¬å·²å®‰è£… Usages åŠŸèƒ½çš„æ–¹æ¡ˆã€‚</p></li></ul><h3 id="ç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒ" aria-hidden="true">#</a> ç¯å¢ƒ</h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>OS</td><td>Windows 10 Pro</td></tr><tr><td>Processor</td><td>11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80 GHz</td></tr><tr><td>RAM</td><td>16 GB</td></tr><tr><td>Storage</td><td>SSD</td></tr></tbody></table><h3 id="jacodb-åŸºå‡†æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#jacodb-åŸºå‡†æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> JacoDB åŸºå‡†æµ‹è¯•ç»“æœ</h3><p>è¿è¡ŒæŒ‡ä»¤ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>./gradlew jcdbBenchmark
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,10),z=n("thead",null,[n("tr",null,[n("th",null,"Benchmark"),n("th",null,"Repeats"),n("th",null,"Avg time per operation")])],-1),H={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L36",target:"_blank",rel:"noopener noreferrer"},W=n("td",null,"5",-1),Q=n("td",null,"1064 ms",-1),X={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L76",target:"_blank",rel:"noopener noreferrer"},$=n("td",null,"5",-1),Y=n("td",null,"1090 ms",-1),Z={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L55",target:"_blank",rel:"noopener noreferrer"},nn=n("td",null,"5",-1),sn=n("td",null,"1551 ms",-1),an={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L97",target:"_blank",rel:"noopener noreferrer"},tn=n("td",null,"5",-1),en=n("td",null,"9054 ms",-1),pn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L45",target:"_blank",rel:"noopener noreferrer"},cn=n("td",null,"5",-1),on=n("td",null,"1790 ms",-1),ln={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L86",target:"_blank",rel:"noopener noreferrer"},un=n("td",null,"5",-1),rn=n("td",null,"2590 ms",-1),dn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L65",target:"_blank",rel:"noopener noreferrer"},kn=n("td",null,"5",-1),vn=n("td",null,"2915 ms",-1),mn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbBenchmarks.kt#L114",target:"_blank",rel:"noopener noreferrer"},hn=n("td",null,"5",-1),bn=n("td",null,"9798 ms",-1),gn=e(`<h3 id="sootåŸºå‡†æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#sootåŸºå‡†æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> SootåŸºå‡†æµ‹è¯•ç»“æœ</h3><p>è¿è¡ŒæŒ‡ä»¤ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>./gradlew sootBenchmark
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,3),fn=n("thead",null,[n("tr",null,[n("th",null,"Benchmark"),n("th",null,"Repeats"),n("th",null,"Avg time per operation")])],-1),yn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L61",target:"_blank",rel:"noopener noreferrer"},xn=n("td",null,"5",-1),Jn=n("td",null,"20985 ms",-1),wn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L66",target:"_blank",rel:"noopener noreferrer"},_n=n("td",null,"5",-1),jn=n("td",null,"23323 ms",-1),In={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L71",target:"_blank",rel:"noopener noreferrer"},Sn=n("td",null,"5",-1),Bn=n("td",null,"24027 ms",-1),Cn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L76",target:"_blank",rel:"noopener noreferrer"},Rn=n("td",null,"5",-1),An=n("td",null,"30286 ms",-1),En=e(`<h3 id="sootupåŸºå‡†æµ‹è¯•ç»“æœ" tabindex="-1"><a class="header-anchor" href="#sootupåŸºå‡†æµ‹è¯•ç»“æœ" aria-hidden="true">#</a> SootUpåŸºå‡†æµ‹è¯•ç»“æœ</h3><h4 id="createindemandviewæ–¹å¼" tabindex="-1"><a class="header-anchor" href="#createindemandviewæ–¹å¼" aria-hidden="true">#</a> <code>createInDemandView</code>æ–¹å¼</h4><p>è¿è¡ŒæŒ‡ä»¤ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>./gradlew sootupBenchmark
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,4),Ln=n("thead",null,[n("tr",null,[n("th",null,"Benchmark"),n("th",null,"Repeats"),n("th",null,"Avg time per operation")])],-1),qn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L39",target:"_blank",rel:"noopener noreferrer"},Tn=n("td",null,"5",-1),On=n("td",null,"0.23 ms",-1),Mn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L44",target:"_blank",rel:"noopener noreferrer"},Dn=n("td",null,"5",-1),Un=n("td",null,"1 ms",-1),Gn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L49",target:"_blank",rel:"noopener noreferrer"},Fn=n("td",null,"5",-1),Pn=n("td",null,"60 ms",-1),Nn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L54",target:"_blank",rel:"noopener noreferrer"},Vn=n("td",null,"5",-1),Kn=n("td",null,"167 ms",-1),zn=n("h4",{id:"createfullviewæ–¹å¼",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#createfullviewæ–¹å¼","aria-hidden":"true"},"#"),s(),n("code",null,"createFullView"),s("æ–¹å¼")],-1),Hn=n("p",null,"å‡ ä¹æ¶ˆè€—äº†å…¨éƒ¨çš„16GB RAMå†…å­˜ï¼ˆåœ¨12GBæ—¶ç”±äºOOMé”™è¯¯è€Œå¤±è´¥ï¼‰ã€‚",-1),Wn=n("thead",null,[n("tr",null,[n("th",null,"Benchmark"),n("th",null,"Repeats"),n("th",null,"Avg time per operation")])],-1),Qn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootBenchmarks.kt#L39",target:"_blank",rel:"noopener noreferrer"},Xn=n("td",null,"5",-1),$n=n("td",null,"0.23 ms",-1),Yn={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L44",target:"_blank",rel:"noopener noreferrer"},Zn=n("td",null,"5",-1),ns=n("td",null,"89 ms",-1),ss={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L49",target:"_blank",rel:"noopener noreferrer"},as=n("td",null,"5",-1),ts=n("td",null,"4247 ms",-1),es={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/SootupBenchmarks.kt#L54",target:"_blank",rel:"noopener noreferrer"},ps=n("td",null,"5",-1),cs=n("td",null,"114 723 ms (fails on 12Gb)",-1),os=e(`<h3 id="å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#å¯¹æ¯”" aria-hidden="true">#</a> å¯¹æ¯”</h3><h4 id="soot" tabindex="-1"><a class="header-anchor" href="#soot" aria-hidden="true">#</a> Soot</h4><p>â€‹ Soot æ¡†æ¶åªæ˜¯è¯»å–æ‰€æœ‰çš„ JAR æ–‡ä»¶å¹¶å°†å­—èŠ‚ç å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚ä¸ Soot ä¸åŒï¼ŒJacoDB ä» JAR æ–‡ä»¶ä¸­è¯»å–å¯ç”¨çš„ .class æ–‡ä»¶å¹¶å¹¶è¡Œæ„å»ºæ–‡ä»¶å¤¹ã€‚å› æ­¤ï¼Œåœ¨å¤„ç†å¤šä¸ª JAR æ–‡ä»¶æ—¶ï¼ˆç”±äºå¹¶è¡Œæ‰§è¡Œï¼‰ï¼Œå®ƒæ›´å¿«ã€‚è¯·æ³¨æ„ï¼ŒJacoDB åœ¨å‡ ä¹æ‰€æœ‰ API å‡†å¤‡å¥½ä¾›ä½¿ç”¨æ—¶æ‰§è¡Œè®¸å¤šåå°ä»»åŠ¡ï¼ˆå±‚æ¬¡ç»“æ„å’Œç”¨æ³•éœ€è¦åå°æ´»åŠ¨å®Œæˆï¼‰ã€‚</p><h4 id="sootup" tabindex="-1"><a class="header-anchor" href="#sootup" aria-hidden="true">#</a> SootUp</h4><p>â€‹ SootUp æ¡†æ¶å¿½ç•¥è¿è¡Œæ—¶åº“ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆâ€œä»…è¿è¡Œæ—¶â€æ¡ä»¶çš„å¯åŠ¨æ—¶é—´å‡ ä¹ç­‰äºé›¶çš„åŸå› ã€‚</p><h4 id="jacodb" tabindex="-1"><a class="header-anchor" href="#jacodb" aria-hidden="true">#</a> JacoDB</h4><p>â€‹ JacoDB åœ¨å‡ ä¹æ‰€æœ‰ API å·²å‡†å¤‡å¥½ä¾›ä½¿ç”¨æ—¶æ‰§è¡Œåå°ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯æ‰§è¡Œä¸å¸¦ Usages åŠŸèƒ½çš„åå°æ´»åŠ¨çš„ç»“æœï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>./gradlew awaitBackgroundBenchmark
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,8),is=n("thead",null,[n("tr",null,[n("th",null,"Benchmark"),n("th",null,"Repeats"),n("th",null,"Avg time per operation")])],-1),ls={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L59",target:"_blank",rel:"noopener noreferrer"},us=n("td",null,"5",-1),rs=n("td",null,"3182 ms",-1),ds={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L72",target:"_blank",rel:"noopener noreferrer"},ks=n("td",null,"5",-1),vs=n("td",null,"14737 ms",-1),ms={href:"https://github.com/UnitTestBot/jacodb/tree/main/jacodb-benchmarks/src/test/kotlin/org/jacodb/testing/performance/JcdbAwaitBackgroundBenchmarks.kt#L86",target:"_blank",rel:"noopener noreferrer"},hs=n("td",null,"2",-1),bs=n("td",null,"137528 ms",-1),gs=n("p",null,"â€‹ å¯¹äº IntelliJ IDEA Community ä»£ç åº“ï¼Œç”Ÿæˆçš„ SQLite æ•°æ®åº“æ–‡ä»¶å¤§å°çº¦ä¸º 3.5 GBã€‚",-1),fs=n("h2",{id:"æµ‹è¯•api",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#æµ‹è¯•api","aria-hidden":"true"},"#"),s(" æµ‹è¯•API")],-1),ys=n("p",null,"https://jacodb.org/swagger-ui/index.html",-1);function xs(Js,ws){const c=p("font"),t=p("ExternalLinkIcon");return i(),l("div",null,[h,a(c,{color:"red"},{default:u(()=>[s("**ç¤ºä¾‹ä»£ç ä¸1.4.2ç‰ˆæœ¬æ¥å£å¯¹ä¸ä¸Š**")]),_:1}),b,n("table",null,[g,n("tbody",null,[n("tr",null,[n("td",null,[n("a",f,[s("bytecode storage"),a(t)])]),y,x]),n("tr",null,[n("td",null,[n("a",J,[s("scope of visible classes"),a(t)])]),w,_]),n("tr",null,[n("td",null,[n("a",j,[s("class"),a(t)])]),I,S]),B,C,R,n("tr",null,[n("td",null,[n("a",A,[s("3-address bytecode representation"),a(t)])]),E,L]),n("tr",null,[n("td",null,[n("a",q,[s("control flow graph"),a(t)])]),T,O]),n("tr",null,[n("td",null,[n("a",M,[s("class hierarchy"),a(t)])]),D,U]),n("tr",null,[n("td",null,[n("a",G,[s("call graph"),a(t)])]),F,P])])]),N,n("p",null,[n("a",V,[s("è´¡çŒ®æŒ‡å¼•è¯¦ç»†ä¿¡æ¯"),a(t)])]),K,n("table",null,[z,n("tbody",null,[n("tr",null,[n("td",null,[n("a",H,[s("runtime"),a(t)])]),W,Q]),n("tr",null,[n("td",null,[n("a",X,[s("runtime + guava"),a(t)])]),$,Y]),n("tr",null,[n("td",null,[n("a",Z,[s("runtime + project dependencies"),a(t)])]),nn,sn]),n("tr",null,[n("td",null,[n("a",an,[s("runtime + IDEA community dependecies"),a(t)])]),tn,en]),n("tr",null,[n("td",null,[n("a",pn,[s("runtime + Usages"),a(t)])]),cn,on]),n("tr",null,[n("td",null,[n("a",ln,[s("runtime + guava + Usages"),a(t)])]),un,rn]),n("tr",null,[n("td",null,[n("a",dn,[s("runtime + project dependencies + Usages"),a(t)])]),kn,vn]),n("tr",null,[n("td",null,[n("a",mn,[s("runtime + IDEA community + Usages"),a(t)])]),hn,bn])])]),gn,n("table",null,[fn,n("tbody",null,[n("tr",null,[n("td",null,[n("a",yn,[s("runtime"),a(t)])]),xn,Jn]),n("tr",null,[n("td",null,[n("a",wn,[s("runtime + guava"),a(t)])]),_n,jn]),n("tr",null,[n("td",null,[n("a",In,[s("runtime + project dependencies"),a(t)])]),Sn,Bn]),n("tr",null,[n("td",null,[n("a",Cn,[s("runtime + IDEA community dependecies"),a(t)])]),Rn,An])])]),En,n("table",null,[Ln,n("tbody",null,[n("tr",null,[n("td",null,[n("a",qn,[s("runtime"),a(t)])]),Tn,On]),n("tr",null,[n("td",null,[n("a",Mn,[s("runtime + guava"),a(t)])]),Dn,Un]),n("tr",null,[n("td",null,[n("a",Gn,[s("runtime + project dependencies"),a(t)])]),Fn,Pn]),n("tr",null,[n("td",null,[n("a",Nn,[s("runtime + IDEA community dependecies"),a(t)])]),Vn,Kn])])]),zn,Hn,n("table",null,[Wn,n("tbody",null,[n("tr",null,[n("td",null,[n("a",Qn,[s("runtime"),a(t)])]),Xn,$n]),n("tr",null,[n("td",null,[n("a",Yn,[s("runtime + guava"),a(t)])]),Zn,ns]),n("tr",null,[n("td",null,[n("a",ss,[s("runtime + project dependencies"),a(t)])]),as,ts]),n("tr",null,[n("td",null,[n("a",es,[s("runtime + IDEA community dependecies"),a(t)])]),ps,cs])])]),os,n("table",null,[is,n("tbody",null,[n("tr",null,[n("td",null,[n("a",ls,[s("runtime: wait for background jobs"),a(t)])]),us,rs]),n("tr",null,[n("td",null,[n("a",ds,[s("runtime + project dependencies: wait for background jobs"),a(t)])]),ks,vs]),n("tr",null,[n("td",null,[n("a",ms,[s("runtime + IDEA community dependencies: wait for background jobs"),a(t)])]),hs,bs])])]),gs,fs,ys])}const js=o(m,[["render",xs],["__file","å®˜æ–¹ä½¿ç”¨æŒ‡å—.html.vue"]]);export{js as default};
