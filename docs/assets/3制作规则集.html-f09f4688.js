import{_ as p,r as l,o,c,a as n,d as a,e as t,b as e}from"./app-b63b8632.js";const u={},i=e(`<h1 id="制作规则集" tabindex="-1"><a class="header-anchor" href="#制作规则集" aria-hidden="true">#</a> 制作规则集</h1><p>​ 摘要：规则集使用xml文件进行配置，其中定义了一组PMD检测时使用的规则。PMD可以使用内置规则集和默认配置进行快速分析。推荐用户使用自定义规则集进行检测，可以有更多的灵活性。本章引导规则集的创建和配置。</p><h2 id="创建规则集" tabindex="-1"><a class="header-anchor" href="#创建规则集" aria-hidden="true">#</a> 创建规则集</h2><p>使用下面的模版创建一个空的规则集文件。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ruleset</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Custom Rules<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>
        My custom rules
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>


    <span class="token comment">&lt;!-- Your rules will come here --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ruleset</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="引用内置规则" tabindex="-1"><a class="header-anchor" href="#引用内置规则" aria-hidden="true">#</a> 引用内置规则</h3><p>使用下面方式可以直接引用一个内置规则。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category/java/errorprone.xml/EmptyCatchBlock<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ruleset</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Custom Rules<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>
        My custom rules
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category/java/errorprone.xml/EmptyCatchBlock<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ruleset</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的配置文件增加了一条检测java空catch块的规则，在PMD检测所有的java文件都会使用这一规则。</p><h4 id="ref参数值解析" tabindex="-1"><a class="header-anchor" href="#ref参数值解析" aria-hidden="true">#</a> ref参数值解析</h4><p>​ category/java/errorprone.xml指的是java的errorprone类问题。PMD从6.0版本开始，问题分为8类(所有语言都是)。</p><p>​ Best Practices(最佳实践)：这些规则执行公认的最佳实践。</p><p>​ Code Style(代码风格): 这些规则确保统一的代码规则。</p><p>​ Design(设计问题)：设计问题检测规则。</p><p>​ Documentation(注释类): 代码注释相关的规则。</p><p>​ Error Prone(易出错结构): 用于检测损坏、极易混淆或容易出现运行时错误的构造的规则。</p><p>​ Multithreading(多线程问题): 多线程问题检查规则。</p><p>​ Performance(代码优化):代码优化检测规则。</p><p>​ Security(安全问题)：安全缺陷检测规则。</p>`,20),r={href:"https://docs.pmd-code.org/latest/tag_rule_references.html",target:"_blank",rel:"noopener noreferrer"},d=n("strong",null,"所有规则",-1),k=n("p",null,"​ EmptyCatchBlock看名字就能知道规则意义，空的catch块。",-1),m=n("h3",{id:"配置个人规则",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#配置个人规则","aria-hidden":"true"},"#"),a(" 配置个人规则")],-1),v={href:"https://docs.pmd-code.org/latest/pmd_userdocs_configuring_rules.html",target:"_blank",rel:"noopener noreferrer"},g=e(`<h3 id="引入多条规则" tabindex="-1"><a class="header-anchor" href="#引入多条规则" aria-hidden="true">#</a> 引入多条规则</h3><p>​ 可以一次性引入大量的规则，比如某个类型下的所有规则，或者指定某个规则类型下的多条规则。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category/java/codestyle.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>WhileLoopsMustUseBraces<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IfElseStmtsMustUseBraces<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​ 这里的ref属性指向的是某个类型的问题。这个路径可以是系统的文件路径或者是classpath的相对路径。只要根据这个路径能找到相应的文件即可。</p><p>🎗️路径分隔符统一使用“/”,对于不同的系统pmd会对其进行转换。</p><p>🎗️按类型引入容易出现规则集不受控的问题，比如新版本规则有增加，或者废除将对已有的配置造成影响。因为按类型引入时新增了规则时会自动将该规则引入，而新的规则可能是你不想要的规则，所以<strong>规则引入推荐使用单条引入的方式</strong>。</p><h3 id="文件过滤" tabindex="-1"><a class="header-anchor" href="#文件过滤" aria-hidden="true">#</a> 文件过滤</h3><p>​ 在规则集中可以配置该规则集对哪些文件进行检测，对哪些文件不检测。exclude-pattern指定不执行该规则集的文件，include-pattern指定执行该规则集的文件。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ruleset</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myruleset<span class="token punctuation">&quot;</span></span>
		<span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0<span class="token punctuation">&quot;</span></span>
		<span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
		<span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://pmd.sourceforge.net/ruleset/2.0.0 https://pmd.sourceforge.io/ruleset_2_0_0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>My ruleset<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude-pattern</span><span class="token punctuation">&gt;</span></span>.*/some/package/.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude-pattern</span><span class="token punctuation">&gt;</span></span>.*/some/other/package/FunkyClassNamePrefix.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include-pattern</span><span class="token punctuation">&gt;</span></span>.*/some/package/ButNotThisClass.*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include-pattern</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- Rules here ... --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ruleset</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="规则集分享" tabindex="-1"><a class="header-anchor" href="#规则集分享" aria-hidden="true">#</a> 规则集分享</h2>`,10),h={href:"https://docs.pmd-code.org/latest/pmd_userdocs_3rdpartyrulesets.html",target:"_blank",rel:"noopener noreferrer"};function b(x,q){const s=l("ExternalLinkIcon");return o(),c("div",null,[i,n("p",null,[a("​ "),n("a",r,[d,t(s)])]),k,m,n("p",null,[a("​ "),n("a",v,[a("规则配置参考"),t(s)])]),g,n("p",null,[a("​ 如果你想分享自己的规则集，可以将它加入到"),n("a",h,[a("3rd party rulesets"),t(s)]),a(".")])])}const f=p(u,[["render",b],["__file","3制作规则集.html.vue"]]);export{f as default};
