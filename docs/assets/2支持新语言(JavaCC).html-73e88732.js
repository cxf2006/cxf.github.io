import{_ as r,r as n,o as i,c as d,a as e,d as t,e as s,b as o}from"./app-26a5a8f2.js";const l={},c=o(`<h1 id="ä¸ºåŸºäº-javacc-è¯­æ³•çš„æ–°è¯­è¨€æ·»åŠ -pmd-æ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#ä¸ºåŸºäº-javacc-è¯­æ³•çš„æ–°è¯­è¨€æ·»åŠ -pmd-æ”¯æŒ" aria-hidden="true">#</a> ä¸ºåŸºäº JavaCC è¯­æ³•çš„æ–°è¯­è¨€æ·»åŠ  PMD æ”¯æŒ</h1><p>Summary:å¦‚ä½•ä½¿ç”¨ JavaCC è¯­æ³•å°†æ–°è¯­è¨€æ·»åŠ åˆ° PMDã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>å¼€å§‹ä¹‹å‰è¯·é˜…è¯»:
è¿™ç¡®å®æ˜¯ä¸€ä¸ªé‡å¤§çš„è´¡çŒ®ï¼Œä¸èƒ½ä»…ä»…å‡­ä¸€æ—¶çš„å…´è‡´æ¥å®Œæˆã€‚å®ƒéœ€è¦ä¸“æ³¨çš„çƒ­æƒ…å’Œé•¿æœŸçš„æ‰¿è¯ºï¼Œä»¥å®ç°å¯¹æ–°è¯­è¨€çš„æ”¯æŒã€‚

è¿™ä¸ªé€æ­¥æŒ‡å—åªæ˜¯ä¸€ä¸ªå…¥é—¨ï¼Œç”¨æ¥å¼€å§‹äº†è§£åŸºç¡€ï¼Œè€Œä¸”ä¹Ÿä¸ä¸€å®šæ˜¯æœ€æ–°æˆ–å®Œæ•´çš„ã€‚ä½ å¿…é¡»æœ‰èƒ½åŠ›å¡«è¡¥ç¼ºæ¼ã€‚

åœ¨ä¸ºä¸€ç§è¯­è¨€æä¾›åŸºæœ¬æ”¯æŒåï¼Œä»ç„¶æœ‰è®¸å¤šç¼ºå¤±çš„åŠŸèƒ½ã€‚å¯ä»¥æå¤§æ”¹è¿›è§„åˆ™ç¼–å†™çš„å…¸å‹åŠŸèƒ½åŒ…æ‹¬ï¼šç¬¦å·è¡¨ã€ç±»å‹è§£æã€è°ƒç”¨/æ•°æ®æµåˆ†æã€‚

ç¬¦å·è¡¨è·Ÿè¸ªå˜é‡åŠå…¶ä½¿ç”¨æƒ…å†µã€‚ç±»å‹è§£æè¯•å›¾æ‰¾åˆ°æ¯ä¸ªä½¿ç”¨çš„ç±»å‹çš„å®é™…ç±»ç±»å‹ï¼Œè·Ÿéšæ–¹æ³•è°ƒç”¨ï¼ˆåŒ…æ‹¬é‡è½½å’Œè¦†ç›–çš„æ–¹æ³•ï¼‰ï¼Œå…è®¸æŸ¥è¯¢å­ç±»å‹å’Œç±»å‹å±‚æ¬¡ç»“æ„ã€‚è¿™éœ€è¦å¯¹è¾…åŠ©ç±»è·¯å¾„è¿›è¡Œé¢å¤–é…ç½®ã€‚è°ƒç”¨å’Œæ•°æ®æµåˆ†æè·Ÿè¸ªæ•°æ®åœ¨ç¨‹åºçš„ä¸åŒæ‰§è¡Œè·¯å¾„ä¸­çš„æµåŠ¨ã€‚

è¿™äº›åŠŸèƒ½è¶…å‡ºäº†æœ¬æŒ‡å—çš„èŒƒå›´ã€‚ç±»å‹è§£æå’Œæ•°æ®æµæ˜¯ç»å¯¹ä¸æ˜¯å…è´¹çš„åŠŸèƒ½ã€‚å®ƒéœ€è¦å¾ˆå¤§çš„åŠªåŠ›å’Œæ¯…åŠ›æ¥å®ç°ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤" aria-hidden="true">#</a> æ­¥éª¤</h2><h3 id="_1-ä»ä¸€ä¸ªæ–°çš„å­æ¨¡å—å¼€å§‹" tabindex="-1"><a class="header-anchor" href="#_1-ä»ä¸€ä¸ªæ–°çš„å­æ¨¡å—å¼€å§‹" aria-hidden="true">#</a> 1.ä»ä¸€ä¸ªæ–°çš„å­æ¨¡å—å¼€å§‹</h3><p>â€‹ ğŸ¸å‚è€ƒ pmd-java æˆ– pmd-vm ä»¥è·å–ç¤ºä¾‹ã€‚</p><p>â€‹ ğŸ¸ç¡®ä¿å°†æ–°æ¨¡å—æ·»åŠ åˆ° PMD çš„çˆ¶ POM ä¸­ä½œä¸º <code>&lt;module&gt;</code> æ¡ç›®ï¼Œä»¥ä¾¿å®ƒä¸å…¶ä»–è¯­è¨€ä¸€èµ·æ„å»ºã€‚</p><p>â€‹ ğŸ¸è¿˜éœ€è¦å°†æ–°æ¨¡å—æ·»åŠ åˆ°â€œpmd-languages-deps/pom.xmlâ€çš„ä¾èµ–åˆ—è¡¨ä¸­ï¼Œä»¥ä¾¿æ–°è¯­è¨€è‡ªåŠ¨åŒ…å«åœ¨äºŒè¿›åˆ¶åˆ†å‘ï¼ˆpmd-distï¼‰ä¸­ã€‚</p><h3 id="_2-ä¸ºä½ çš„è¯­è¨€å®ç°ä¸€ä¸ªastè§£æå™¨" tabindex="-1"><a class="header-anchor" href="#_2-ä¸ºä½ çš„è¯­è¨€å®ç°ä¸€ä¸ªastè§£æå™¨" aria-hidden="true">#</a> 2.ä¸ºä½ çš„è¯­è¨€å®ç°ä¸€ä¸ªASTè§£æå™¨</h3><p>â€‹ ğŸ¸ç†æƒ³æƒ…å†µä¸‹ï¼ŒASTè§£æå™¨åº”è¯¥ä½œä¸ºä¸€ä¸ªJJTæ–‡ä»¶å®ç°ï¼ˆå‚è€ƒVmParser.jjtæˆ–Java.jjtä½œä¸ºç¤ºä¾‹ï¼‰ã€‚</p><p>â€‹ ğŸ¸å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–è§£æå™¨å®ç°ï¼Œåªè¦ä½ æœ‰ä¸€ç§å°†è¾“å…¥æµè½¬æ¢ä¸ºASTæ ‘çš„æ–¹æ³•ã€‚ä½¿ç”¨JJTæ–¹å¼ç®€åŒ–äº†ä»¥åçš„ç»´æŠ¤å·¥ä½œã€‚</p><p>â€‹ ğŸ¸å‚è€ƒæ­¤é“¾æ¥ä»¥è·å–æ›´å¤šä¿¡æ¯ï¼šhttps://javacc.java.net/doc/JJTree.html</p><h3 id="_3-åˆ›å»ºastèŠ‚ç‚¹ç±»" tabindex="-1"><a class="header-anchor" href="#_3-åˆ›å»ºastèŠ‚ç‚¹ç±»" aria-hidden="true">#</a> 3.åˆ›å»ºASTèŠ‚ç‚¹ç±»</h3><p>â€‹ ğŸ¸å¯¹äºè§£æå™¨ç”Ÿæˆçš„æ¯ä¸ªASTèŠ‚ç‚¹ï¼Œéƒ½åº”è¯¥æœ‰ä¸€ä¸ªç±»ã€‚</p><p>â€‹ ğŸ¸ASTç±»çš„åç§°åº”è¯¥æ˜¯â€œASTâ€ + JJTæ–‡ä»¶ä¸­èŠ‚ç‚¹çš„åç§°ã€‚</p><p>â€‹ ğŸ«“ä¾‹å¦‚ï¼Œå¦‚æœJJTåŒ…å«ä¸€ä¸ªåä¸ºâ€œIfStatementâ€çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåº”è¯¥æœ‰ä¸€ä¸ªåä¸ºâ€œASTIfStatementâ€çš„ç±»ã€‚</p><p>â€‹ ğŸ¸æ¯ä¸ªASTç±»åº”è¯¥æœ‰ä¸€ä¸ªåŒ…ç§æœ‰çš„æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªæ•´æ•°idä½œä¸ºå‚æ•°ã€‚</p><p>â€‹ ğŸ¸åˆ›å»ºä¸€ä¸ªé’ˆå¯¹è¯­è¨€çš„æ‰€æœ‰ASTç±»çš„çˆ¶ç±»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–åç»­çš„è§„åˆ™åˆ›å»ºï¼ˆä¾‹å¦‚ï¼Œå‚è€ƒVelocityçš„SimpleNodeå’ŒJavaçš„AbstractJavaNodeï¼‰ã€‚</p><p>â€‹ ğŸ¸ æ³¨æ„ï¼šè¿™äº›ASTèŠ‚ç‚¹ç±»é€šå¸¸æ˜¯ç”±javacc/jjtreeç”Ÿæˆçš„ï¼Œç„¶åæ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p><h3 id="_4-ç”Ÿæˆä½ çš„è§£æå™¨-ä½¿ç”¨jjt" tabindex="-1"><a class="header-anchor" href="#_4-ç”Ÿæˆä½ çš„è§£æå™¨-ä½¿ç”¨jjt" aria-hidden="true">#</a> 4.ç”Ÿæˆä½ çš„è§£æå™¨ï¼ˆä½¿ç”¨JJTï¼‰</h3><p>â€‹ ğŸ¸ ä½¿ç”¨Antè„šæœ¬å°†jjtæ–‡ä»¶ç¼–è¯‘æˆç±»ã€‚è¿™ä¸ªè„šæœ¬ä½äºPMDé¡¶çº§æºä»£ç ä¸­çš„javacc-wrapper.xmlæ–‡ä»¶ä¸­ã€‚</p><p>â€‹ ğŸ¸ é€šè¿‡maven-antrun-pluginæ‰§è¡Œè¿™ä¸ªAntè„šæœ¬ã€‚å°†è¿™ä¸ªæ’ä»¶æ·»åŠ åˆ°ä½ çš„pom.xmlæ–‡ä»¶ä¸­ï¼Œå¹¶é…ç½®å®ƒçš„è¯­è¨€åç§°ã€‚ä½ å¯ä»¥ä½¿ç”¨pmd-java/pom.xmlä½œä¸ºç¤ºä¾‹ã€‚</p><p>â€‹ ğŸ¸ è¿™ä¸ªAntè„šæœ¬åœ¨æ•´ä¸ªé¡¹ç›®æ„å»ºæ—¶çš„generate-sourcesé˜¶æ®µè¢«è°ƒç”¨ã€‚ä½†å¦‚æœä½ å¸Œæœ›ç”Ÿæˆä½ çš„è§£æå™¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ä½ çš„æ¨¡å—ä¸­ä½¿ç”¨<code>./mvnw generate-sources</code>æ¥è°ƒç”¨å®ƒã€‚</p><h3 id="_5-åˆ›å»ºä¸€ä¸ªpmdè§£æå™¨-é€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#_5-åˆ›å»ºä¸€ä¸ªpmdè§£æå™¨-é€‚é…å™¨" aria-hidden="true">#</a> 5.åˆ›å»ºä¸€ä¸ªPMDè§£æå™¨ &quot;é€‚é…å™¨&quot;</h3><p>â€‹ ğŸ¸åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œå®ƒæ‰©å±•äº†JjtreeParserAdapterã€‚</p><p>â€‹ ğŸ¸è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„ç±»ï¼Œä½ éœ€è¦å£°æ˜æ ¹ASTèŠ‚ç‚¹ã€‚</p><p>â€‹ ğŸ¸æœ‰ä¸¤ä¸ªé‡è¦çš„æ–¹æ³•éœ€è¦å®ç°ã€‚</p><p>â€‹ ğŸ«“<code>tokenBehavior</code> æ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªä½¿ç”¨ä½ çš„è¯­è¨€ä¸­çš„ä»¤ç‰Œåˆ—è¡¨æ„å»ºçš„TokenDocumentBehaviorçš„æ–°å®ä¾‹ã€‚åœ¨ç¼–è¯‘æ­¥éª¤ #4 ä¸­ï¼Œå°†ç”Ÿæˆä¸€ä¸ªåä¸º <code>$langTokenKinds</code> çš„ç±»ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å¯ç”¨çš„ä»¤ç‰Œåœ¨å­—æ®µ <code>TOKEN_NAMES</code> ä¸­ã€‚</p><p>â€‹ ğŸ«“<code>parseImpl</code> æ–¹æ³•åº”è¯¥è¿”å›é€šè¿‡è§£æCharStreamæºè·å–çš„ASTæ ‘çš„æ ¹èŠ‚ç‚¹ã€‚</p><p>â€‹ ğŸ«“å¯ä»¥å‚è€ƒVmParserç±»ä½œä¸ºç¤ºä¾‹ã€‚</p>`,30),u={id:"_6-create-a-language-version-handler-âœï¸ï¸",tabindex:"-1"},h=e("a",{class:"header-anchor",href:"#_6-create-a-language-version-handler-âœï¸ï¸","aria-hidden":"true"},"#",-1),p={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},m=o("<ul><li>Extend <code>AbstractPmdLanguageVersionHandler</code> <em>(see VmHandler for example)</em></li><li>This class is sort of a gateway between PMD and all parsing logic specific to your language.</li><li>For a minimal implementation, it just needs to return a parser <em>(see step #5)</em>.</li><li>It can be used to provide other features for your language like <ul><li>violation suppression logic</li><li>violation decorators, to add additional language specific information to the created violations</li><li>metrics (see below â€œOptional featuresâ€)</li><li>custom XPath functions</li></ul></li><li>See <code>VmHandler</code> class as an example</li></ul>",1),g={id:"_7-create-a-base-visitor-âœï¸ï¸",tabindex:"-1"},_=e("a",{class:"header-anchor",href:"#_7-create-a-base-visitor-âœï¸ï¸","aria-hidden":"true"},"#",-1),f={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},b=e("li",null,"A parser visitor adapter is not needed anymore with PMD 7. The visitor interface now provides a default implementation.",-1),v={href:"https://github.com/pmd/pmd/blob/pmd/7.0.x/pmd-core/src/main/java/net/sourceforge/pmd/lang/ast/AstVisitor.java",target:"_blank",rel:"noopener noreferrer"},x=e("code",null,"AstVisitor",-1),T=e("li",null,[t("The generated visitor class for VM is called "),e("code",null,"VmVisitor"),t(".")],-1),y=e("li",null,[t("In order to help use this visitor later on, a base visitor class should be created. See "),e("code",null,"VmVisitorBase"),t(" as an example.")],-1),j={id:"_8-make-pmd-recognize-your-language-âœï¸ï¸",tabindex:"-1"},A=e("a",{class:"header-anchor",href:"#_8-make-pmd-recognize-your-language-âœï¸ï¸","aria-hidden":"true"},"#",-1),w={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},S=o("<ul><li>Create your own subclass of <code>net.sourceforge.pmd.lang.impl.SimpleLanguageModuleBase</code>. <em>(see VmLanguageModule or JavaLanguageModule as an example)</em></li><li>Add for each version of your language a call to <code>addVersion</code> in your language moduleâ€™s constructor. Use <code>addDefaultVersion</code> for defining the default version.</li><li>Youâ€™ll need to refer the language version handler created in step #6.</li><li>Create the service registration via the text file <code>src/main/resources/META-INF/services/net.sourceforge.pmd.lang.Language</code>. Add your fully qualified class name as a single line into it.</li></ul>",1),k={id:"_9-add-ast-regression-tests-âœï¸ï¸",tabindex:"-1"},P=e("a",{class:"header-anchor",href:"#_9-add-ast-regression-tests-âœï¸ï¸","aria-hidden":"true"},"#",-1),J={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},M=o(`<p>For languages, that use an external library for parsing, the AST can easily change when upgrading the library. Also for languages, where we have the grammar under our control, it is useful to have such tests.</p><p>The tests parse one or more source files and generate a textual representation of the AST. This text is compared against a previously recorded version. If there are differences, the test fails.</p><p>This helps to detect anything in the AST structure that changed, maybe unexpectedly.</p><ul><li><p>Create a test class in the package <code>net.sourceforge.pmd.lang.$lang.ast</code> with the name <code>$langTreeDumpTest</code>.</p></li><li><p>This test class must extend <code>net.sourceforge.pmd.lang.ast.test.BaseTreeDumpTest</code>. Note: This class is written in kotlin and is available in the module â€œlang-testâ€.</p></li><li><p>Add a default constructor, that calls the super constructor like so:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>    public $langTreeDumpTest() {
        super(NodePrintersKt.getSimpleNodePrinter(), &quot;.$extension&quot;);
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Replace â€œ$langâ€ and â€œ$extensionâ€ accordingly.</p></li><li><p>Implement the method <code>getParser()</code>. It must return a subclass of <code>net.sourceforge.pmd.lang.ast.test.BaseParsingHelper</code>. See <code>net.sourceforge.pmd.lang.ecmascript.ast.JsParsingHelper</code> for an example. With this parser helper you can also specify, where the test files are searched, by using the method <code>withResourceContext(Class&lt;?&gt;, String)</code>.</p></li><li><p>Add one or more test methods. Each test method parses one file and compares the result. The base class has a helper method <code>doTest(String)</code> that does all the work. This method just needs to be called:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>    @Test
    public void myFirstAstTest() {
        doTest(&quot;filename-without-extension&quot;);
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>On the first test run the test fails. A text file (with the extension <code>.txt</code>) is created, that records the current AST. On the next run, the text file is used as comparison and the test should pass. Donâ€™t forget to commit the generated text file.</p></li></ul><p>A complete example can be seen in the JavaScript module: <code>net.sourceforge.pmd.lang.ecmascript.ast.JsTreeDumpTest</code>. The test resources are in the subpackage â€œtestdataâ€: <code>pmd-javascript/src/test/resources/net/sourceforge/pmd/lang/ecmascript/ast/testdata/</code>.</p><p>The Scala module also has a test, written in Kotlin instead of Java: <code>net.sourceforge.pmd.lang.scala.ast.ScalaParserTests</code>.</p>`,6),C={id:"_10-create-an-abstract-rule-class-for-the-language-âœï¸ï¸",tabindex:"-1"},D=e("a",{class:"header-anchor",href:"#_10-create-an-abstract-rule-class-for-the-language-âœï¸ï¸","aria-hidden":"true"},"#",-1),V={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},N=e("ul",null,[e("li",null,[t("Extend "),e("code",null,"AbstractRule"),t(" and implement the parser visitor interface for your language "),e("em",null,"(see AbstractVmRule for example)")]),e("li",null,"All other rules for your language should extend this class. The purpose of this class is to implement visit methods for all AST types to simply delegate to default behavior. This is useful because most rules care only about specific AST nodes, but PMD needs to know what to do with each node - so this just lets you use default behavior for nodes you donâ€™t care about.")],-1),R={id:"_11-create-rules-âœï¸ï¸",tabindex:"-1"},I=e("a",{class:"header-anchor",href:"#_11-create-rules-âœï¸ï¸","aria-hidden":"true"},"#",-1),L={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},E=e("ul",null,[e("li",null,[t("Rules are created by extending the abstract rule class created in step 9 "),e("em",null,[t("(see "),e("code",null,"EmptyForeachStmtRule"),t(" for example)")])]),e("li",null,"Creating rules is already pretty well documented in PMD - and itâ€™s no different for a new language, except you may have different AST nodes.")],-1),B={id:"_12-test-the-rules-âœï¸ï¸",tabindex:"-1"},q=e("a",{class:"header-anchor",href:"#_12-test-the-rules-âœï¸ï¸","aria-hidden":"true"},"#",-1),O={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},F=o("<ul><li><p>Testing rules is described in depth in</p><p>Testing your rules</p><p>.</p><ul><li>Each rule has its own test class: Create a test class for your rule extending <code>PmdRuleTst</code> <em>(see AvoidReassigningParametersTest in pmd-vm for example)</em></li><li>Create a category rule set for your language <em>(see category/vm/bestpractices.xml for example)</em></li><li>Place the test XML file with the test cases in the correct location</li><li>When executing the test class <ul><li>this triggers the unit test to read the corresponding XML file with the rule test data <em>(see <code>AvoidReassigningParameters.xml</code> for example)</em></li><li>This test XML file contains sample pieces of code which should trigger a specified number of violations of this rule. The unit test will execute the rule on this piece of code, and verify that the number of violations matches.</li></ul></li></ul></li><li><p>To verify the validity of the created ruleset, create a subclass of <code>AbstractRuleSetFactoryTest</code> (<em>see <code>RuleSetFactoryTest</code> in pmd-vm for example)</em>. This will load all rulesets and verify, that all required attributes are provided.</p><p><em>Note:</em> Youâ€™ll need to add your category ruleset to <code>categories.properties</code>, so that it can be found.</p></li></ul>",1),H={id:"debugging-with-rule-designer-âœï¸ï¸",tabindex:"-1"},$=e("a",{class:"header-anchor",href:"#debugging-with-rule-designer-âœï¸ï¸","aria-hidden":"true"},"#",-1),X={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},K=e("p",null,"When implementing your grammar it may be very useful to see how PMD parses your example files. This can be achieved with Rule Designer:",-1),z=e("li",null,[e("p",null,[t("Override the "),e("code",null,"getXPathNodeName"),t(" in your AST nodes for Designer to show node names.")])],-1),W=e("li",null,[e("p",null,[t("Make sure to override both "),e("code",null,"jjtOpen"),t(" and "),e("code",null,"jjtClose"),t(" in your AST node base class so that they set both start and end line and column for proper node bound highlighting.")])],-1),Y=e("p",null,"Not strictly required but trivial and useful:",-1),U=e("p",null,"implement syntax highlighting for Rule Designer:",-1),G={href:"https://github.com/pmd/pmd-designer",target:"_blank",rel:"noopener noreferrer"},Q=o("<li>Add a syntax highlighter implementation to <code>net.sourceforge.pmd.util.fxdesigner.util.codearea.syntaxhighlighting</code> (you could use Java as an example).</li><li>Register it in the <code>AvailableSyntaxHighlighters</code> enumeration.</li><li>Now build your implementation and place the <code>target/pmd-ui-&lt;version&gt;-SNAPSHOT.jar</code> to the <code>lib</code> directory inside your <code>pmd-bin-...</code> distribution (you have to delete old <code>pmd-ui-*.jar</code> from there).</li>",3),Z={id:"optional-features-âœï¸ï¸",tabindex:"-1"},ee=e("a",{class:"header-anchor",href:"#optional-features-âœï¸ï¸","aria-hidden":"true"},"#",-1),te={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},ae={id:"metrics-âœï¸ï¸",tabindex:"-1"},se=e("a",{class:"header-anchor",href:"#metrics-âœï¸ï¸","aria-hidden":"true"},"#",-1),oe={href:"https://github.com/pmd/pmd/blob/master/docs/pages/pmd/devdocs/major_contributions/adding_a_new_javacc_based_language.md",target:"_blank",rel:"noopener noreferrer"},re=e("p",null,"If you want to add support for computing metrics:",-1),ne=e("li",null,[t("Create a package "),e("code",null,"lang.<langname>.metrics")],-1),ie=e("li",null,[t("Create a utility class "),e("code",null,"<langname>Metrics")],-1),de=e("li",null,"Implement new metrics and add them as static constants. Be sure to document them.",-1),le={href:"https://docs.pmd-code.org/apidocs/pmd-core/7.0.0-rc4/net/sourceforge/pmd/lang/LanguageVersionHandler.html#getLanguageMetricsProvider()",target:"_blank",rel:"noopener noreferrer"},ce=e("code",null,"getLanguageMetricsProvider",-1),ue={href:"https://docs.pmd-code.org/apidocs/pmd-java/7.0.0-rc4/net/sourceforge/pmd/lang/java/metrics/JavaMetrics.html#",target:"_blank",rel:"noopener noreferrer"},he=e("code",null,"JavaMetrics",-1);function pe(me,ge){const a=n("ExternalLinkIcon");return i(),d("div",null,[c,e("h3",u,[h,t(" 6. Create a language version handler "),e("a",p,[t("âœï¸ï¸"),s(a)])]),m,e("h3",g,[_,t(" 7. Create a base visitor "),e("a",f,[t("âœï¸ï¸"),s(a)])]),e("ul",null,[b,e("li",null,[t("The visitor for JavaCC based AST is generated along the parser from the grammar file. The base interface for a visitor is "),e("a",v,[x,s(a)]),t(".")]),T,y]),e("h3",j,[A,t(" 8. Make PMD recognize your language "),e("a",w,[t("âœï¸ï¸"),s(a)])]),S,e("h3",k,[P,t(" 9. Add AST regression tests "),e("a",J,[t("âœï¸ï¸"),s(a)])]),M,e("h3",C,[D,t(" 10. Create an abstract rule class for the language "),e("a",V,[t("âœï¸ï¸"),s(a)])]),N,e("h3",R,[I,t(" 11. Create rules "),e("a",L,[t("âœï¸ï¸"),s(a)])]),E,e("h3",B,[q,t(" 12. Test the rules "),e("a",O,[t("âœï¸ï¸"),s(a)])]),F,e("h2",H,[$,t(" Debugging with Rule Designer "),e("a",X,[t("âœï¸ï¸"),s(a)])]),K,e("ul",null,[z,W,e("li",null,[Y,U,e("ul",null,[e("li",null,[t("Fork and clone the "),e("a",G,[t("pmd/pmd-designer"),s(a)]),t(" repository.")]),Q])])]),e("h2",Z,[ee,t(" Optional features "),e("a",te,[t("âœï¸ï¸"),s(a)])]),e("h3",ae,[se,t(" Metrics "),e("a",oe,[t("âœï¸ï¸"),s(a)])]),re,e("ul",null,[ne,ie,de,e("li",null,[t("Implement "),e("a",le,[ce,s(a)]),t(", to make the metrics available in the designer.")])]),e("p",null,[t("See "),e("a",ue,[he,s(a)]),t(" for an example.")])])}const fe=r(l,[["render",pe],["__file","2æ”¯æŒæ–°è¯­è¨€(JavaCC).html.vue"]]);export{fe as default};
