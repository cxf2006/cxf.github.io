import{_ as l,r,o as d,c as o,a as e,b as a,d as t,e as n}from"./app-d417e0ec.js";const i={},p=e("h1",{id:"pmd-cli参考",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#pmd-cli参考","aria-hidden":"true"},"#"),a(" PMD CLI参考")],-1),c=e("p",null,"概要：命令行的参数选项、输出格式以及支持的语言方面的详细介绍。",-1),u=e("h2",{id:"pmd命令选项参数",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#pmd命令选项参数","aria-hidden":"true"},"#"),a(" PMD命令选项参数")],-1),h=e("p",null,"可以使用 --help选项查看所有选项参数。",-1),m=e("thead",null,[e("tr",null,[e("th",null,"选项"),e("th",null,"描述"),e("th",null,"默认值"),e("th",null,"应用于")])],-1),_=e("tr",null,[e("td",null,[a("--rulesets <refs> "),e("br"),a("-R <refs>")]),e("td",null,"必选。规则集xml文件路径。可以是应用classpath下的文件，可以是操作系统的本地路径，或者一个URL。多个值使用逗号分隔。"),e("td"),e("td")],-1),b=e("tr",null,[e("td",null,[a("--dir <path>"),e("br"),a("-d <path>")]),e("td",null,"源文件路径，或者包含源文件压缩包(.zip)、jar包的目录。--dir/--file-list/--uri三个参数必须使用其中一个。目前测试只分析源文件，不能分析class文件。"),e("td"),e("td")],-1),g=e("td",null,[a("--format <format>"),e("br"),a("-f <format>")],-1),v={href:"https://docs.pmd-code.org/latest/pmd_userdocs_cli_reference.html#available-report-formats",target:"_blank",rel:"noopener noreferrer"},f=e("td",null,"text",-1),k=e("td",null,null,-1),x=e("tr",null,[e("td",null,"--aux-classpath <cp>"),e("td",null,"指定源码依赖库的路径。这用于解析源文件中的类型。平台特定的路径分隔符（在Linux上为“:”，在Windows上为“;”）用于分隔条目。或者，您可以指定一个指向包含连续行上的路径元素的文本文件的单个文件URL。"),e("td"),e("td",null,"Java")],-1),j=e("tr",null,[e("td",null,[a("--benchmark"),e("br"),a("-b")]),e("td",null,"开启基准模式。输出基准报告。"),e("td"),e("td")],-1),P=e("tr",null,[e("td",null,"--cache <filepath>"),e("td",null,[a("定义增量分析时缓存存放目录。完整的文件路径，而不是文件存放目录。如果文件不存在会自动创建。运行时触发更新规则时，会覆盖该文件。"),e("strong",null,"推荐配置")]),e("td"),e("td")],-1),M=e("td",null,[a("--debug"),e("br"),a("--verbose"),e("br"),a("-D"),e("br"),a("-v")],-1),D={href:"https://docs.pmd-code.org/latest/pmd_userdocs_cli_reference.html#logging",target:"_blank",rel:"noopener noreferrer"},L=e("td",null,null,-1),R=e("td",null,null,-1),w=e("tr",null,[e("td",null,[a("--encoding <charset>"),e("br"),a("-e <charset>")]),e("td",null,"定义PMD读取源文件的字符集类型。支持的字符集同“java.nio.charset.Charset”。"),e("td",null,"UTF-8"),e("td")],-1),C=e("tr",null,[e("td",null,"--[no-]fail-on-violation"),e("td",null,"定义发现问题是是否以非 零状态退出分析程序。默认是以状态4退出。如果配置--no-fail-on-violation将以状态0退出，并且输出检测报告。"),e("td"),e("td")],-1),S=e("tr",null,[e("td",null,"--file-list <filepath>"),e("td",null,"配置文件列表文件的路径。文件中一行一个文件。参数--dir ,--file-list,--uri参数三选一。"),e("td"),e("td")],-1),q=e("td",null,"--force-language <lang>",-1),A={href:"https://docs.pmd-code.org/latest/pmd_userdocs_cli_reference.html#analyze-other-xml-formats",target:"_blank",rel:"noopener noreferrer"},V=e("td",null,null,-1),y=e("td",null,null,-1),$=e("tr",null,[e("td",null,"--ignore-list <filepath>"),e("td",null,"配置一个文件。文件里面配置需要忽略的文件，一行一个。这个选项配置将忽略--dir，--file-list，--uri引入的分析文件。"),e("td"),e("td")],-1),J=e("tr",null,[e("td",null,[a("--help"),e("br"),a("-h")]),e("td",null,"显示指令选项信息"),e("td"),e("td")],-1),T=e("td",null,"--use-version <lang-version>",-1),H=e("em",null,"language-version",-1),N={href:"https://docs.pmd-code.org/latest/pmd_userdocs_cli_reference.html#supported-languages",target:"_blank",rel:"noopener noreferrer"},O=e("td",null,null,-1),z=e("td",null,null,-1),I=e("tr",null,[e("td",null,[a("-language <lang> "),e("br"),a("-l <lang>")]),e("td",null,"已废弃。使用--use-version替代。"),e("td"),e("td")],-1),U=e("td",null,"--minimum-priority <priority>",-1),B={href:"https://docs.pmd-code.org/latest/pmd_userdocs_configuring_rules.html",target:"_blank",rel:"noopener noreferrer"},E=e("td",null,"Low",-1),F=e("td",null,null,-1),Q=e("tr",null,[e("td",null,"--no-cache"),e("td",null,"显示关闭增量分析功能。改配置将使--cache配置失效。"),e("td"),e("td")],-1),W=e("tr",null,[e("td",null,"--[no-]progress"),e("td",null,"开启或者禁用分析过程中的进度条显示。ie上默认开启"),e("td"),e("td")],-1),G=e("tr",null,[e("td",null,[a("--property <name>=<value>"),e("br"),a("-P <name>=<value>")]),e("td",null,"定义报告生成器参数。该参数可以多次定义。使用--help查看所有可定义的参数。"),e("td"),e("td")],-1),K=e("tr",null,[e("td",null,[a("--relativize-paths-with <path>"),e("br"),a("-z <path>")]),e("td",null,"只生成指定目录下文件的检测报告。该参数可以重复配置以配置多个目录。"),e("td"),e("td")],-1),X=e("tr",null,[e("td",null,[a("--report-file <path>"),e("br"),a("-r <path>")]),e("td",null,"定义报告输出文件，如果文件没有将被创建。如果该参数未定义，报告将输出到标准路径。"),e("td"),e("td")],-1),Y=e("tr",null,[e("td",null,"--show-suppressed"),e("td",null,"报告中显示被忽略的检测问题。"),e("td"),e("td")],-1),Z=e("tr",null,[e("td",null,"--suppress-marker <marker>"),e("td",null,"定义需要PMD忽略该行的注释标志。"),e("td",null,"NOPMD"),e("td")],-1),ee=e("tr",null,[e("td",null,[a("--threads <num>"),e("br"),a("-t <num>")]),e("td",null,"PMD分析时开启的进程数。设置为0代表禁止多线程分析。"),e("td",null,"1"),e("td")],-1),ae=e("tr",null,[e("td",null,[a("-uri <uri>"),e("br"),a("-u <uri>")]),e("td",null,"源文件数据库URI。--dir,--file-list,--uri三个参数必须配置一个。"),e("td"),e("td",null,"PLSQL")],-1),se=n(`<h2 id="java-运行时选项" tabindex="-1"><a class="header-anchor" href="#java-运行时选项" aria-hidden="true">#</a> Java 运行时选项</h2><p>PMD是在java虚拟机上运行的。有时需要设置一些java运行时参数。</p><h3 id="pmd-java-opts" tabindex="-1"><a class="header-anchor" href="#pmd-java-opts" aria-hidden="true">#</a> PMD_JAVA_OPTS</h3><p>linux</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>~ $ <span class="token builtin class-name">export</span> <span class="token assign-left variable">PMD_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;--enable-preview&quot;</span>
~ $ pmd check <span class="token parameter variable">-d</span> src/main/java/ <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> rulesets/java/quickstart.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>windows</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token string">&quot;PMD_JAVA_OPTS=--enable-preview&quot;</span>
C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> pmd.bat check <span class="token parameter variable">-d</span> src<span class="token punctuation">\\</span>main<span class="token punctuation">\\</span>java<span class="token punctuation">\\</span> <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> rulesets/java/quickstart.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="classpath" tabindex="-1"><a class="header-anchor" href="#classpath" aria-hidden="true">#</a> classpath</h2><p>​ 在定制规则打成jar包时，可以通过防止到PMD指定的lib目录下或者放在任意位置，然后配置该位置目录到classpath。</p><p>​ 配置classpath指定规则扩展包。</p><p>linux</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>~ $ <span class="token builtin class-name">export</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span>custom-rule-example.jar
~ $ pmd check <span class="token parameter variable">-d</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/src/main/java/ <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> myrule.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>windows</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> <span class="token assign-left variable">CLASSPATH</span><span class="token operator">=</span>custom-rule-example.jar
C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> pmd.bat check <span class="token parameter variable">-d</span> <span class="token punctuation">..</span><span class="token punctuation">\\</span><span class="token punctuation">..</span><span class="token punctuation">\\</span><span class="token punctuation">..</span><span class="token punctuation">\\</span>src<span class="token punctuation">\\</span>main<span class="token punctuation">\\</span>java<span class="token punctuation">\\</span> <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> myrule.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="pmd退出状态" tabindex="-1"><a class="header-anchor" href="#pmd退出状态" aria-hidden="true">#</a> PMD退出状态</h2><p>​ 默认退出状态为4.</p><table><thead><tr><th>0</th><th>没有发现问题，正常退出。</th></tr></thead><tbody><tr><td>1</td><td>PMD运行异常。</td></tr><tr><td>2</td><td>使用错误。指令参数无效或缺失。</td></tr><tr><td>4</td><td>至少发现一个问题出发设置了--no-fail-on-violation。</td></tr></tbody></table><h2 id="日志" tabindex="-1"><a class="header-anchor" href="#日志" aria-hidden="true">#</a> 日志</h2><p>​ pmd日志使用slf4j,slf4j的实现为slf4j-simple。日志信息通过System.err输出。所以报告信息一般都要配置输出到文件，否则就会输出到控制台。</p><p>​ slf4j-simple的配置文件为conf/simplelogger.properties。--debug参数将日志级别设置为debug。</p><h2 id="支持的语言" tabindex="-1"><a class="header-anchor" href="#支持的语言" aria-hidden="true">#</a> 支持的语言</h2><p>​ PMD会根据文件的扩展名自动识别文件的语言，比如java。PMD可以支持语言的不同版本。未配置语言版本时，将使用默认的版本。默认版本一般都是最新的非预览版。如果需要使用更旧的版本使用--use-version选项配置。</p><p>​ 语言的不同版本会影响到规则集，因为有些规则只适用于特定版本的语言。这种规则使用参数minimumLanguageVersion和maximumLanguageVersion来确定应用的版本。但是大部分规则是不和语言版本关联的。</p><p>​ PMD 命令--help可以查询出PMD支持的语言版本。</p><p>​ 指定语言版本的例子</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>~ $ pmd check <span class="token parameter variable">-d</span> src/main/java <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> rulesets/java/quickstart.xml --use-version java-1.8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> pmd.bat check <span class="token parameter variable">-d</span> src<span class="token punctuation">\\</span>main<span class="token punctuation">\\</span>java <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> rulesets/java/quickstart.xml --use-version java-1.8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,27),te={href:"https://docs.pmd-code.org/latest/pmd_rules_apex.html",target:"_blank",rel:"noopener noreferrer"},ne={href:"https://docs.pmd-code.org/latest/pmd_rules_ecmascript.html",target:"_blank",rel:"noopener noreferrer"},le={href:"https://docs.pmd-code.org/latest/pmd_rules_html.html",target:"_blank",rel:"noopener noreferrer"},re={href:"https://docs.pmd-code.org/latest/pmd_languages_java.html",target:"_blank",rel:"noopener noreferrer"},de={href:"https://docs.pmd-code.org/latest/pmd_rules_ecmascript.html",target:"_blank",rel:"noopener noreferrer"},oe={href:"https://docs.pmd-code.org/latest/pmd_rules_jsp.html",target:"_blank",rel:"noopener noreferrer"},ie={href:"https://docs.pmd-code.org/latest/pmd_rules_kotlin.html",target:"_blank",rel:"noopener noreferrer"},pe={href:"https://docs.pmd-code.org/latest/pmd_rules_modelica.html",target:"_blank",rel:"noopener noreferrer"},ce={href:"https://docs.pmd-code.org/latest/pmd_rules_plsql.html",target:"_blank",rel:"noopener noreferrer"},ue={href:"https://docs.pmd-code.org/latest/pmd_rules_pom.html",target:"_blank",rel:"noopener noreferrer"},he={href:"https://docs.pmd-code.org/latest/pmd_rules_scala.html",target:"_blank",rel:"noopener noreferrer"},me={href:"https://docs.pmd-code.org/latest/pmd_rules_swift.html",target:"_blank",rel:"noopener noreferrer"},_e={href:"https://docs.pmd-code.org/latest/pmd_rules_vf.html",target:"_blank",rel:"noopener noreferrer"},be={href:"https://docs.pmd-code.org/latest/pmd_rules_vm.html",target:"_blank",rel:"noopener noreferrer"},ge={href:"https://docs.pmd-code.org/latest/pmd_rules_xml.html",target:"_blank",rel:"noopener noreferrer"},ve={href:"https://docs.pmd-code.org/latest/pmd_rules_xsl.html",target:"_blank",rel:"noopener noreferrer"},fe=e("h2",{id:"支持的报告格式",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#支持的报告格式","aria-hidden":"true"},"#"),a(" 支持的报告格式")],-1),ke={href:"https://docs.pmd-code.org/latest/pmd_userdocs_report_formats.html",target:"_blank",rel:"noopener noreferrer"},xe=n(`<h2 id="一些例子" tabindex="-1"><a class="header-anchor" href="#一些例子" aria-hidden="true">#</a> 一些例子</h2><h3 id="分析其他格式xml" tabindex="-1"><a class="header-anchor" href="#分析其他格式xml" aria-hidden="true">#</a> 分析其他格式xml</h3><p>​ 如果xml的源文件扩展名没有使用xml，可以使用--force-languge参数来指定源文件语言为xml。</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>~ $ pmd check -d src/xml-file.ext -f text -R ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span><span class="token operator">&gt;</span> pmd.bat check <span class="token parameter variable">-d</span> src<span class="token punctuation">\\</span>xml-file.ext <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>​ -d 参数值也可以配置成一个目录。分析目录下所有文件时，单个文件无法处理时，将不影响PMD的正常运行。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>~ $ pmd check <span class="token parameter variable">-d</span> src/ <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bat line-numbers-mode" data-ext="bat"><pre class="language-bat"><code>C:\\&gt; pmd.bat check -d src\\ -f text -R ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>​ 限定源文件的扩展名</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>~ $ <span class="token function">find</span> src/ <span class="token parameter variable">-name</span> <span class="token string">&quot;*.ext&quot;</span> <span class="token operator">&gt;</span> filelist.txt
~ $ pmd check --file-list filelist.txt <span class="token parameter variable">-f</span> text <span class="token parameter variable">-R</span> ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bat line-numbers-mode" data-ext="bat"><pre class="language-bat"><code>C:\\&gt; for /r src/ %i in (*.ext) do echo %i &gt;&gt; filelist.txt
C:\\&gt; pmd.bat check --file-list filelist.txt -f text -R ruleset.xml --force-language xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,11);function je(Pe,Me){const s=r("ExternalLinkIcon");return d(),o("div",null,[p,c,u,h,e("table",null,[m,e("tbody",null,[_,b,e("tr",null,[g,e("td",null,[a("指定输出报告的格式。"),e("a",v,[a("所有格式"),t(s)])]),f,k]),x,j,P,e("tr",null,[M,e("td",null,[a("Debug参数。输出更多调试日志。参考"),e("a",D,[a("Logging"),t(s)]),a("。")]),L,R]),w,C,S,e("tr",null,[q,e("td",null,[a("强制统一所有输入文件语言类型，忽略文件名。配置此选项后，不在根据文件扩展名判断文件语言。pmd将所有文件使用配置的语言进行处理。处理错误或者无法处理的文件将被忽略。假如不适用语言的默认版本，使用--use-verison可以指定。一个分析xml文件扩展名不是.xml的"),e("a",A,[a("例子"),t(s)]),a("。")]),V,y]),$,J,e("tr",null,[T,e("td",null,[a("定义处理当指定语言类型时，使用的语言版本。配置值需要符合"),H,a("格式。可以指定多个语言的版本。此配置不会影响文件语言类型的判断，只有在判断出语言类型之后，才会按照配置语言版本进一步分析。语言检测只受文件扩展名和--force-language选项影响。 "),e("a",N,[a("支持的语言"),t(s)])]),O,z]),I,e("tr",null,[U,e("td",null,[a("规则优先级阈值。低于此处配置的优先级问题将不被检测。有效值(不区分大小写)High、Medium_High、Medium、Medium_Low、Low，或者数字1(High)到5(Low)。参数覆盖说明"),e("a",B,[a("Configuring rules"),t(s)])]),E,F]),Q,W,G,K,X,Y,Z,ee,ae])]),se,e("ul",null,[e("li",null,[e("a",te,[a("apex"),t(s)]),a(" (Salesforce Apex)")]),e("li",null,[e("a",ne,[a("ecmascript"),t(s)]),a(" (JavaScript)")]),e("li",null,[e("a",le,[a("html"),t(s)])]),e("li",null,[a("java "),e("ul",null,[e("li",null,[e("a",re,[a("Supported Versions"),t(s)])])])]),e("li",null,[e("a",de,[a("ecmascript"),t(s)]),a(" (JavaScript)")]),e("li",null,[e("a",oe,[a("jsp"),t(s)])]),e("li",null,[e("a",ie,[a("kotlin"),t(s)])]),e("li",null,[e("a",pe,[a("modelica"),t(s)])]),e("li",null,[e("a",ce,[a("plsql"),t(s)])]),e("li",null,[e("a",ue,[a("pom"),t(s)]),a(" (Maven POM)")]),e("li",null,[e("a",he,[a("scala"),t(s)])]),e("li",null,[e("a",me,[a("swift"),t(s)])]),e("li",null,[e("a",_e,[a("vf"),t(s)]),a(" (Salesforce VisualForce)")]),e("li",null,[e("a",be,[a("vm"),t(s)]),a(" (Apache Velocity)")]),e("li",null,[e("a",ge,[a("xml"),t(s)])]),e("li",null,[e("a",ve,[a("xsl"),t(s)])])]),fe,e("p",null,[a("​ PMD支持多种报告格式，详细参考"),e("a",ke,[a("PMD Report formats"),t(s)])]),xe])}const Le=l(i,[["render",je],["__file","8PMD命令参考.html.vue"]]);export{Le as default};
